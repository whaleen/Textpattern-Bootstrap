# arc_twitter v3.3.1
# <a href="http://www.twitter.com">Twitter</a> for Textpattern
# Andy Carter
# http://redhotchilliproject.com/

# ......................................................................
# This is a plugin for Textpattern - http://textpattern.com/
# To install: textpattern > admin > plugins
# Paste the following text into the 'Install plugin' box:
# ......................................................................

YToxMTp7czo0OiJuYW1lIjtzOjExOiJhcmNfdHdpdHRlciI7czo3OiJ2ZXJzaW9uIjtzOjU6
IjMuMy4xIjtzOjY6ImF1dGhvciI7czoxMToiQW5keSBDYXJ0ZXIiO3M6MTA6ImF1dGhvcl91
cmkiO3M6MzE6Imh0dHA6Ly9yZWRob3RjaGlsbGlwcm9qZWN0LmNvbS8iO3M6MTE6ImRlc2Ny
aXB0aW9uIjtzOjYwOiI8YSBocmVmPSJodHRwOi8vd3d3LnR3aXR0ZXIuY29tIj5Ud2l0dGVy
PC9hPiBmb3IgVGV4dHBhdHRlcm4iO3M6NToib3JkZXIiO3M6MToiNSI7czo0OiJ0eXBlIjtz
OjE6IjUiO3M6NToiZmxhZ3MiO3M6MToiMyI7czo0OiJoZWxwIjtzOjE3OTc2OiIJPGgxIGNs
YXNzPSJ0aXRsZSI+PHNwYW4gY2xhc3M9ImNhcHMiPlRYUDwvc3Bhbj4gVHdlZXQgKGFyY190
d2l0dGVyIGZvciBUZXh0cGF0dGVybik8L2gxPgoKCTxvbD4KCQk8bGk+PGEgaHJlZj0iI2Fy
Y190d2l0dGVyX2F1dGhvciI+QXV0aG9yPC9hPjwvbGk+CgkJPGxpPjxhIGhyZWY9IiNhcmNf
dHdpdHRlcl9pbnN0YWxsYXRpb24iPkluc3RhbGxhdGlvbiAvIFVuaW5zdGFsbGF0aW9uPC9h
PjwvbGk+CgkJPGxpPjxhIGhyZWY9IiNhcmNfdHdpdHRlcl90YWciPlRoZSBhcmNfdHdpdHRl
ciB0YWc8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX3NlYXJjaF90YWci
PlRoZSBhcmNfdHdpdHRlcl9zZWFyY2ggdGFnPC9hPjwvbGk+CgkJPGxpPjxhIGhyZWY9IiNh
cmNfdHdpdHRlcl90d2VldF9idXR0b25fdGFnIj5UaGUgYXJjX3R3aXR0ZXJfdHdlZXRfYnV0
dG9uIHRhZzwvYT48L2xpPgoJCTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfZm9sbG93X2J1
dHRvbl90YWciPlRoZSBhcmNfdHdpdHRlcl9mb2xsb3dfYnV0dG9uIHRhZzwvYT48L2xpPgoJ
CTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfdHdlZXRfdXJsIj5UaGUgYXJjX3R3aXR0ZXJf
dHdlZXRfdXJsIHRhZzwvYT48L2xpPgoJCTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfdGlu
eXVybCI+VGhlIGFyY190d2l0dGVyX3Rpbnl1cmwgdGFnPC9hPjwvbGk+CgkJPGxpPjxhIGhy
ZWY9IiNhcmNfdHdpdHRlcl9jYWNoaW5nIj5DYWNoaW5nPC9hPjwvbGk+CgkJPGxpPjxhIGhy
ZWY9IiNhcmNfdHdpdHRlcl9wcmVmcyI+UHJlZmVyZW5jZXM8L2E+PC9saT4KCQk8bGk+PGEg
aHJlZj0iI2FyY190d2l0dGVyX2FydGljbGUiPlR3ZWV0aW5nIGFydGljbGVzPC9hPjwvbGk+
CgkJPGxpPjxhIGhyZWY9IiNhcmNfdHdpdHRlcl9hZG1pbiI+VGhlIFR3aXR0ZXIgdGFiPC9h
PjwvbGk+Cgk8L29sPgoKCTxwPjxzcGFuIGNsYXNzPSJjYXBzIj5UWFA8L3NwYW4+IFR3ZWV0
IHByb3ZpZGVzIGFjY2VzcyB0byB5b3VyIFR3aXR0ZXIgYWNjb3VudCB0aHJvdWdoIGJvdGgg
dGhlIGFkbWluIGludGVyZmFjZSBhbmQgdGhlIHB1YmxpYyBzaWRlIG9mIHlvdXIgc2l0ZS4g
VXBkYXRlIFR3aXR0ZXIgd2hlbiB5b3UgcG9zdCBhIG5ldyBhcnRpY2xlICh3aXRoIGFydGlj
bGUtYnktYXJ0aWNsZSBvcHQgb3V0IG9wdGlvbiksIHVwZGF0ZSBhbmQgdmlldyB5b3VyIFR3
aXR0ZXIgZmVlZCB0aHJvdWdoIHRoZSBhZG1pbiBUd2l0dGVyIHRhYiwgYW5kIGRpc3BsYXkg
VHdpdHRlciBmZWVkcyBvbiB5b3VyIHNpdGUuPC9wPgoKCTxwPlJlcXVpcmVtZW50czotPC9w
PgoKCTx1bD4KCQk8bGk+VGV4dHBhdHRlcm4gNC41KzwvbGk+CgkJPGxpPjxzcGFuIGNsYXNz
PSJjYXBzIj5QSFA8L3NwYW4+IDUgYW5kIGNVUkw8L2xpPgoJPC91bD4KCgk8aDIgY2xhc3M9
InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl9hdXRob3IiPkF1dGhvcjwvaDI+CgoJPHA+PGEg
aHJlZj0iaHR0cDovL3JlZGhvdGNoaWxsaXByb2plY3QuY29tIj5BbmR5IENhcnRlcjwvYT4u
IEZvciBvdGhlciBUZXh0cGF0dGVybiBwbHVnaW5zIGJ5IG1lIHZpc2l0IG15IDxhIGhyZWY9
Imh0dHA6Ly9yZWRob3RjaGlsbGlwcm9qZWN0LmNvbS90eHAiPlBsdWdpbnMgcGFnZTwvYT4u
PC9wPgoKCTxwPkNvbnRyaWJ1dG9yczogQW5keSBDYXJ0ZXIsIFBoaWwgV2FyZWhhbSBhbmQg
VG9tbXkgU2NobXVja2VyLjwvcD4KCgk8cD5UaGFua3MgdG8gPGEgaHJlZj0iaHR0cDovL21h
bmZyZS5uZXQvIj5NaWNoYWVsIE1hbmZyZTwvYT4gZm9yIGluc3BpcmF0aW9uIGZvciB0aGUg
YXJ0aWNsZSB0d2VldCBwYXJ0IG9mIHRoaXMgcGx1Z2luIGJhc2VkIG9uIGhpcyA8c3BhbiBj
bGFzcz0idGFnIj5tZW1fdHdpdHRlcjwvc3Bhbj4gcGx1Z2luLiAgQWRkaXRpb25hbCB0aGFu
a3MgdG8gdGhlIGdyZWF0IFRleHRwYXR0ZXJuIGNvbW11bml0eSBmb3IgaGVscGluZyB0byB0
ZXN0IHRoaXMgcGx1Z2luIGFuZCBmb3Igc3VnZ2VzdGluZyBuZXcgZmVhdHVyZXMuIFRoZSBP
QXV0aCBwYXJ0IG9mIHRoZSBwbHVnaW4gaXMgdGhhbmtzIHRvIDxhIGhyZWY9Imh0dHA6Ly90
d2l0dGVyLmNvbS9hYnJhaGFtIj5BYnJhaGFtIFdpbGxpYW1zPC9hPi48L3A+CgoJPGgyIGNs
YXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfaW5zdGFsbGF0aW9uIj5JbnN0YWxsYXRp
b24gLyBVbmluc3RhbGxhdGlvbjwvaDI+CgoJPHA+VG8gaW5zdGFsbCBnbyB0byB0aGUgJiM4
MjE2O3BsdWdpbnMmIzgyMTc7IHRhYiB1bmRlciAmIzgyMTY7YWRtaW4mIzgyMTc7IGFuZCBw
YXN0ZSB0aGUgcGx1Z2luIGNvZGUgaW50byB0aGUgJiM4MjE2O0luc3RhbGwgcGx1Z2luJiM4
MjE3OyBib3gsICYjODIxNjt1cGxvYWQmIzgyMTc7IGFuZCB0aGVuICYjODIxNjtpbnN0YWxs
JiM4MjE3Oy4gVGhlIHBsdWdpbiB3aWxsIGJlIGF1dG9tYXRpY2FsbHkgYWN0aXZhdGVkLjwv
cD4KCgk8cD5CZWZvcmUgeW91IHN0YXJ0IHVzaW5nIDxzcGFuIGNsYXNzPSJ0YWciPmFyY190
d2l0dGVyPC9zcGFuPiB5b3Ugd2lsbCBuZWVkIHRvIG1ha2Ugc3VyZSB0aGF0IHRoZSBjYWNo
ZSBkaXJlY3RvcnkgaXMgd3JpdGFibGUuIFNlZSB0aGUgJiM4MjE2O0NhY2hpbmcmIzgyMTc7
IHN1YnNlY3Rpb24gYmVsb3cgZm9yIGZ1cnRoZXIgaW5mb3JtYXRpb24uPC9wPgoKCTxwPjxz
cGFuIGNsYXNzPSJ0YWciPmFyY190d2l0dGVyPC9zcGFuPiBzaG91bGQgbm93IGJlIHJlYWR5
IGZvciB1c2Ugb24gdGhlIHB1YmxpYy1zaWRlIG9mIHlvdXIgc2l0ZS48L3A+CgoJPHA+VG8g
dW5sb2NrIHRoZSBhZG1pbiBmZWF0dXJlcyBvZiB0aGlzIHBsdWdpbiB5b3Ugd2lsbCBuZWVk
IHRvIGFzc29jaWF0ZSB5b3VyIHNpdGUgd2l0aCBhIFR3aXR0ZXIgYWNjb3VudCBieSBjb25u
ZWN0aW5nIHRvIFR3aXR0ZXIgZnJvbSB0aGUgcGx1Z2luJiM4MjE3O3Mgb3B0aW9ucyBzY3Jl
ZW4uIENsaWNrIG9uIHRoZSBsaW5rIHRvIGNvbm5lY3QgdG8gVHdpdHRlciwgeW91IHdpbGwg
YmUgYXNrZWQgdG8gbG9naW4gdG8gVHdpdHRlciwgY2xpY2tpbmcgdGhpcyBsaW5rIHdpbGwg
dGVtcG9yYXJpbHkgdGFrZSB5b3UgdG8gdGhlIFR3aXR0ZXIgc2l0ZSB3aGVyZSB5b3Ugd2ls
bCBiZSBhc2tlZCB0byBsb2dpbiBhbmQgYXBwcm92ZSBhY2Nlc3MgZm9yIDxzcGFuIGNsYXNz
PSJjYXBzIj5UWFA8L3NwYW4+IFR3ZWV0IHRvIHJlYWQgYW5kIHdyaXRlIHRvIHlvdXIgVHdp
dHRlciBhY2NvdW50LiBJZiBhbGwgaXMgc3VjY2Vzc2Z1bCB5b3Ugd2lsbCBiZSByZXR1cm5l
ZCB0byB0aGUgb3B0aW9ucyBzY3JlZW4gYW5kIHlvdXIgdXNlciBuYW1lIHdpbGwgYXBwZWFy
LjwvcD4KCgk8cD5BdCBhbnkgdGltZSB5b3UgY2FuIGRpc2Fzc29jaWF0ZSB5b3VyIFR3aXR0
ZXIgYWNjb3VudCB3aXRoIDxzcGFuIGNsYXNzPSJjYXBzIj5UWFA8L3NwYW4+IFR3ZWV0IHZp
YSB5b3VyIFR3aXR0ZXIgYWNjb3VudCBwcmVmZXJlbmNlcyBvbiB0aGUgPGEgaHJlZj0iaHR0
cDovL3d3dy50d2l0dGVyLmNvbSI+VHdpdHRlciB3ZWJzaXRlPC9hPi48L3A+CgoJPHA+VG8g
dW5pbnN0YWxsIDxzcGFuIGNsYXNzPSJ0YWciPmFyY190d2l0dGVyPC9zcGFuPiBzaW1wbHkg
ZGVsZXRlIHRoZSBwbHVnaW4gZnJvbSB0aGUgJiM4MjE2O1BsdWdpbnMmIzgyMTc7IHRhYi4g
IFRoaXMgd2lsbCByZW1vdmUgdGhlIHBsdWdpbiBjb2RlLCBkZWxldGUgcmVsYXRlZCBwcmVm
ZXJlbmNlcyBhbmQgZHJvcCB0aGUgPHNwYW4gY2xhc3M9InRhZyI+YXJjX3R3aXR0ZXI8L3Nw
YW4+IHRhYmxlIGZyb20geW91ciBUZXh0cGF0dGVybiBkYXRhYmFzZS48L3A+CgoJPGgyIGNs
YXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfdGFnIj5UaGUgYXJjX3R3aXR0ZXIgdGFn
PC9oMj4KCgk8aDM+U3ludGF4PC9oMz4KCgk8cD4mbHQ7dHhwOmFyY190d2l0dGVyIHVzZXI9
JnF1b3Q7ZHJtb25rZXluaW5qYSZxdW90OyAvJmd0OzwvcD4KCgk8aDM+VXNhZ2U8L2gzPgoK
CTx0YWJsZT4KCQk8dHI+CgkJCTx0aD5BdHRyaWJ1dGU8L3RoPgoJCQk8dGg+RGVzY3JpcHRp
b248L3RoPgoJCQk8dGg+RGVmYXVsdDwvdGg+CgkJCTx0aD5FeGFtcGxlPC90aD4KCQk8L3Ry
PgoJCTx0cj4KCQkJPHRkPnVzZXI8L3RkPgoJCQk8dGQ+VHdpdHRlciB1c2VyIG5hbWU8L3Rk
PgoJCQk8dGQ+IDxlbT5hcmNfdHdpdHRlciB1c2VybmFtZTwvZW0+PC90ZD4KCQkJPHRkPnVz
ZXI9JnF1b3Q7ZHJtb25rZXluaW5qYSZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0
ZD5yZXR3ZWV0czwvdGQ+CgkJCTx0ZD4xIHRvIGluY2x1ZGUgcmV0d2VldHMsIDAgdG8gZXhj
bHVkZSB0aGVtIGZyb20gdGhlIGZlZWQ8L3RkPgoJCQk8dGQ+MDwvdGQ+CgkJPC90cj4KCQk8
dHI+CgkJCTx0ZD5yZXBsaWVzPC90ZD4KCQkJPHRkPjEgdG8gaW5jbHVkZSByZXBsaWVzLCAw
IHRvIGV4Y2x1ZGUgdGhlbSBmcm9tIHRoZSBmZWVkPC90ZD4KCQkJPHRkPjE8L3RkPgoJCTwv
dHI+CgkJPHRyPgoJCQk8dGQ+bGltaXQ8L3RkPgoJCQk8dGQ+TWF4aW11bSBudW1iZXIgb2Yg
dHdlZXRzIHRvIGRpc3BsYXkgKG1heC4gMjAwKTwvdGQ+CgkJCTx0ZD4xMDwvdGQ+CgkJCTx0
ZD5saW1pdD0mcXVvdDsyNSZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5mZXRj
aDwvdGQ+CgkJCTx0ZD5NYXhpbXVtIG51bWJlciBvZiB0d2VldHMgdG8gcmV0cmlldmUgZnJv
bSBUd2l0dGVyIChtYXguIDIwMCk8c3VwIGNsYXNzPSJmb290bm90ZSI+PGEgaHJlZj0iI2Zu
Njc0ODg4NTg0NTA4NTg3NmE0ZDUwZSI+MTwvYT48L3N1cD48L3RkPgoJCQk8dGQ+MDwvdGQ+
CgkJCTx0ZD5mZXRjaD0mcXVvdDs1MCZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0
ZD5kYXRlZm9ybWF0PC90ZD4KCQkJPHRkPkZvcm1hdCB0aGF0IHVwZGF0ZSBkYXRlcyB3aWxs
IGFwcGVhciBhczwvdGQ+CgkJCTx0ZD4gPGVtPkFyY2hpdmUgZGF0ZSBmb3JtYXQ8L2VtPjwv
dGQ+CgkJCTx0ZD5kYXRlZm9ybWF0PSZxdW90OyViICVPZSwgJUk6JU0gJXAmcXVvdDs8L3Rk
PgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+bGFiZWw8L3RkPgoJCQk8dGQ+TGFiZWwgZm9yIHRo
ZSB0b3Agb2YgdGhlIGxpc3Q8L3RkPgoJCQk8dGQ+IDxlbT5ubyBsYWJlbDwvZW0+PC90ZD4K
CQkJPHRkPmxhYmVsPSZxdW90O015IFR3aXR0ZXIgdGltZWxpbmUmcXVvdDs8L3RkPgoJCTwv
dHI+CgkJPHRyPgoJCQk8dGQ+bGFiZWx0YWc8L3RkPgoJCQk8dGQ+SW5kZXBlbmRlbnQgd3Jh
cHRhZyBmb3IgbGFiZWw8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQkJPHRk
PmxhYmVsdGFnPSZxdW90O2gzJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmJy
ZWFrPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+
SFRNTDwvc3Bhbj48L3NwYW4+IHRhZyAod2l0aG91dCBicmFja2V0cyksIG9yIHN0cmluZywg
dXNlZCB0byBzZXBhcmF0ZSB0aGUgdXBkYXRlczwvdGQ+CgkJCTx0ZD5saTwvdGQ+CgkJCTx0
ZD5icmVhaz0mcXVvdDticiZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD53cmFw
dGFnPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+
SFRNTDwvc3Bhbj48L3NwYW4+IHRhZyB0byBiZSB1c2VkIGFzIHRoZSB3cmFwdGFnLCB3aXRo
b3V0IGJyYWNrZXRzPC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJCTx0ZD53
cmFwdGFnPSZxdW90O3VsJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNsYXNz
PC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+Q1NT
PC9zcGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmlidXRlIGZvciB3cmFwdGFnPC90ZD4KCQkJPHRk
PmFyY190d2l0dGVyPC90ZD4KCQkJPHRkPmNsYXNzPSZxdW90O3R3aXR0ZXImcXVvdDs8L3Rk
PgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2xhc3NfcG9zdGVkPC90ZD4KCQkJPHRkPjxzcGFu
IGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bhbj4gY2xh
c3MgYXR0cmlidXRlIGFwcGxpZWQgdG8gc3BhbiB0YWcgYXJvdW5kIHBvc3RlZCBkYXRlPC90
ZD4KCQkJPHRkPmFyY190d2l0dGVyLXBvc3RlZDwvdGQ+CgkJPC90cj4KCTwvdGFibGU+CgoJ
PHAgaWQ9ImZuNjc0ODg4NTg0NTA4NTg3NmE0ZDUwZSIgY2xhc3M9ImZvb3Rub3RlIj48c3Vw
PjE8L3N1cD4gVHdpdHRlciYjODIxNztzIDxzcGFuIGNsYXNzPSJjYXBzIj5BUEk8L3NwYW4+
IGNvdW50cyB0aGUgbnVtYmVyIG9mIHR3ZWV0cyB0byByZXR1cm4gYmVmb3JlIGFwcGx5aW5n
IHNvbWUgb2YgdGhlIGZpbHRlcnMsIHNvIHRoZSByZXNwb25zZSBjYW4gYmUgZmV3ZXIgdHdl
ZXRzIHRoYW4gZXhwZWN0ZWQuIFRvIGhlbHAgYXZvaWQgdGhpcyB5b3UgY2FuIHNldCBhIDxl
bT5mZXRjaDwvZW0+IGxpbWl0IHRoYXQgaXMgaGlnaGVyIHRoYW4gdGhlIGRpc3BsYXkgPGVt
PmxpbWl0PC9lbT4gdGhhdCB5b3Ugd2FudCB0byBvdXRwdXQuIElmIDxlbT5mZXRjaDwvZW0+
IGlzIGxlc3MgdGhhbiA8ZW0+bGltaXQ8L2VtPiB0aGUgbGF0dGVyIHdpbGwgYmUgdXNlZCBp
bnN0ZWFkLjwvcD4KCgk8aDM+RXhhbXBsZSB1c2FnZTwvaDM+CgoJPHA+Jmx0O3R4cDphcmNf
dHdpdHRlciB1c2VyPSZxdW90O2RybW9ua2V5bmluamEmcXVvdDsgbGltaXQ9JnF1b3Q7NSZx
dW90OyB3cmFwdGFnPSZxdW90O3VsJnF1b3Q7IGJyZWFrPSZxdW90O2xpJnF1b3Q7IGRhdGVm
b3JtYXQ9JnF1b3Q7JWIgJU9lLCAlSTolTSAlcCZxdW90OyAvJmd0OzwvcD4KCgk8cD5Qcm9k
dWNlcyBhIGJ1bGxldCBwb2ludCBsaXN0IG9mIHRoZSBsYXN0IDUgVHdpdHRlciB1cGRhdGVz
IGZyb20gZHJtb25rZXluaW5qYSYjODIxNztzIFR3aXR0ZXIgZmVlZCB3aXRoIGEgZGVmaW5l
ZCBkYXRlIGZvcm1hdCB0byBvdmVycmlkZSB0aGUgZGVmYXVsdCBhcmNoaXZlIGRhdGUgZm9y
bWF0LjwvcD4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl9zZWFyY2hf
dGFnIj5UaGUgYXJjX3R3aXR0ZXJfc2VhcmNoIHRhZzwvaDI+CgoJPGgzPlN5bnRheDwvaDM+
CgoJPHA+Jmx0O3R4cDphcmNfdHdpdHRlcl9zZWFyY2ggaGFzaHRhZ3M9JnF1b3Q7dHhwJnF1
b3Q7IC8mZ3Q7PC9wPgoKCTxoMz5Vc2FnZTwvaDM+CgoJPHRhYmxlPgoJCTx0cj4KCQkJPHRo
PkF0dHJpYnV0ZTwvdGg+CgkJCTx0aD5EZXNjcmlwdGlvbjwvdGg+CgkJCTx0aD5EZWZhdWx0
PC90aD4KCQkJPHRoPkV4YW1wbGU8L3RoPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+c2VhcmNo
PC90ZD4KCQkJPHRkPkNvbW1hIHNlcGFyYXRlZCBsaXN0IG9mIHNlYXJjaCB3b3JkczwvdGQ+
CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCQk8dGQ+c2VhcmNoPSZxdW90O3R4cCx0
ZXh0cGF0dGVybiZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5oYXNodGFnczwv
dGQ+CgkJCTx0ZD5Db21tYSBzZXBhcmF0ZWQgbGlzdCBvZiBoYXNodGFncyB0byBzZWFyY2gg
Zm9yIChub3QgaW5jbHVkaW5nIHRoZSBoYXNoKTwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9l
bT48L3RkPgoJCQk8dGQ+aGFzaHRhZ3M9JnF1b3Q7dHhwLHRleHRwYXR0ZXJuJnF1b3Q7PC90
ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnJlcGx5PC90ZD4KCQkJPHRkPlVzZXJuYW1lIG9m
IHR3ZWV0cyBpbiByZXBseSB0bzwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJ
CQk8dGQ+cmVwbHk9JnF1b3Q7dHdpdHRlciZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJ
CTx0ZD5tZW50aW9uPC90ZD4KCQkJPHRkPlVzZXJuYW1lIG9mIHVzZXIgbWVudGlvbmVkIGlu
IHR3ZWV0cyAoPGk+aS5lLjwvaT4gdHdlZXRzIGNvbnRhaW5pbmcgQHVzZXJuYW1lKTwvdGQ+
CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCQk8dGQ+bWVudGlvbj0mcXVvdDt0d2l0
dGVyJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxpbWl0PC90ZD4KCQkJPHRk
Pk1heGltdW0gbnVtYmVyIG9mIHR3ZWV0cyB0byBkaXNwbGF5IChtYXguIDIwMCk8L3RkPgoJ
CQk8dGQ+MTA8L3RkPgoJCQk8dGQ+bGltaXQ9JnF1b3Q7MjUmcXVvdDs8L3RkPgoJCTwvdHI+
CgkJPHRyPgoJCQk8dGQ+ZGF0ZWZvcm1hdDwvdGQ+CgkJCTx0ZD5Gb3JtYXQgdGhhdCB1cGRh
dGUgZGF0ZXMgd2lsbCBhcHBlYXIgYXM8L3RkPgoJCQk8dGQ+IDxlbT5BcmNoaXZlIGRhdGUg
Zm9ybWF0PC9lbT48L3RkPgoJCQk8dGQ+ZGF0ZWZvcm1hdD0mcXVvdDslYiAlT2UsICVJOiVN
ICVwJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxhYmVsPC90ZD4KCQkJPHRk
PkxhYmVsIGZvciB0aGUgdG9wIG9mIHRoZSBsaXN0PC90ZD4KCQkJPHRkPiA8ZW0+bm8gbGFi
ZWw8L2VtPjwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5sYWJlbHRhZzwvdGQ+CgkJCTx0
ZD5JbmRlcGVuZGVudCB3cmFwdGFnIGZvciBsYWJlbDwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0
PC9lbT48L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+YnJlYWs8L3RkPgoJCQk8dGQ+PHNw
YW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5IVE1MPC9zcGFuPjwvc3Bhbj4g
dGFnICh3aXRob3V0IGJyYWNrZXRzKSwgb3Igc3RyaW5nLCB1c2VkIHRvIHNlcGFyYXRlIHRo
ZSB1cGRhdGVzPC90ZD4KCQkJPHRkPmxpPC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPndy
YXB0YWc8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBz
Ij5IVE1MPC9zcGFuPjwvc3Bhbj4gdGFnIHRvIGJlIHVzZWQgYXMgdGhlIHdyYXB0YWcsIHdp
dGhvdXQgYnJhY2tldHM8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQk8L3Ry
PgoJCTx0cj4KCQkJPHRkPmNsYXNzPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48
c3BhbiBjbGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmlidXRlIGZv
ciB3cmFwdGFnPC90ZD4KCQkJPHRkPmFyY190d2l0dGVyX3NlYXJjaDwvdGQ+CgkJPC90cj4K
CQk8dHI+CgkJCTx0ZD5jbGFzc191c2VyPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBz
Ij48c3BhbiBjbGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmlidXRl
IGFwcGxpZWQgdG8gc3BhbiB0YWcgYXJvdW5kIHVzZXIgbmFtZTwvdGQ+CgkJCTx0ZD5hcmNf
dHdpdHRlci11c2VyPC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNsYXNzX3Bvc3RlZDwv
dGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkNTUzwv
c3Bhbj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBhcHBsaWVkIHRvIHNwYW4gdGFnIGFyb3Vu
ZCBwb3N0ZWQgZGF0ZTwvdGQ+CgkJCTx0ZD5hcmNfdHdpdHRlci1wb3N0ZWQ8L3RkPgoJCTwv
dHI+Cgk8L3RhYmxlPgoKCTxoMz5FeGFtcGxlIHVzYWdlPC9oMz4KCgk8cD4mbHQ7dHhwOmFy
Y190d2l0dGVyX3NlYXJjaCBzZWFyY2g9JnF1b3Q7cGx1Z2luJnF1b3Q7IGhhc2h0YWdzPSZx
dW90O3R4cCx0ZXh0cGF0dGVybiZxdW90OyBsaW1pdD0mcXVvdDsyNSZxdW90OyAvJmd0Ozwv
cD4KCgk8cD5Qcm9kdWNlcyBhIGxpc3Qgb2YgdHdlZXRzIGNvbnRhaW5pbmcgdGhlIHdvcmQg
JiM4MjE2O3BsdWdpbiYjODIxNzsgYW5kIHRoZSBoYXNodGFncyAmIzgyMTY7I3R4cCYjODIx
NzsgYW5kICYjODIxNjsjdGV4dHBhdHRlcm4mIzgyMTc7LiBUaGUgdGFnIHdpbGwgcmV0dXJu
IGEgbWF4aW11bSBvZiAyNSB0d2VldHMuPC9wPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9
ImFyY190d2l0dGVyX3JldHdlZXRfdGFnIj5UaGUgYXJjX3R3aXR0ZXJfdHdlZXRfYnV0dG9u
IHRhZzwvaDI+CgoJPHA+T3V0cHV0cyB0aGUgVHdpdHRlciB0d2VldCBidXR0b24gKGZvcm1l
cmx5ICZsdDt0eHA6YXJjX3R3aXR0ZXJfcmV0d2VldCAvJmd0OykuPC9wPgoKCTxoMz5TeW50
YXg8L2gzPgoKCTxwPiZsdDt0eHA6YXJjX3R3aXR0ZXJfdHdlZXRfYnV0dG9uIC8mZ3Q7PC9w
PgoKCTxoMz5Vc2FnZTwvaDM+CgoJPHRhYmxlPgoJCTx0cj4KCQkJPHRoPkF0dHJpYnV0ZTwv
dGg+CgkJCTx0aD5EZXNjcmlwdGlvbjwvdGg+CgkJCTx0aD5EZWZhdWx0PC90aD4KCQkJPHRo
PkV4YW1wbGU8L3RoPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+dXNlcjwvdGQ+CgkJCTx0ZD5U
d2l0dGVyIHVzZXIgbmFtZSB0byBxdW90ZTwvdGQ+CgkJCTx0ZD4gPGVtPmFyY190d2l0dGVy
IHVzZXJuYW1lPC9lbT48L3RkPgoJCQk8dGQ+dXNlcj0mcXVvdDtkcm1vbmtleW5pbmphJnF1
b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnVybDwvdGQ+CgkJCTx0ZD48c3BhbiBj
bGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPlVSTDwvc3Bhbj48L3NwYW4+IHRvIHR3
ZWV0PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnRleHQ8L3RkPgoJCQk8dGQ+VHdlZXQg
dGV4dDwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5mb2xsb3cxPC90ZD4KCQkJPHRkPlN1
Z2dlc3RlZCBUd2l0dGVyIGFjY291bnQgdG8gZm9sbG93LCBmb3IgZXhhbXBsZSB5b3VyIG93
bjwvdGQ+CgkJCTx0ZD5BIFR3aXR0ZXIgdXNlciB0byByZWNvbW1lbmQ8L3RkPgoJCQk8dGQ+
Zm9sbG93MT0mcXVvdDtUZXh0cGF0dGVybiZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJ
CTx0ZD5mb2xsb3cyPC90ZD4KCQkJPHRkPkFzIGZvbGxvdzE8L3RkPgoJCQk8dGQ+IDxlbT51
bnNldDwvZW0+PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxhbmc8L3RkPgoJCQk8dGQ+
TGFuZ3VhZ2U8L3RkPgoJCQk8dGQ+ZW48L3RkPgoJCQk8dGQ+bGFuZz0mcXVvdDtlcyZxdW90
OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jb3VudDwvdGQ+CgkJCTx0ZD5Db3VudCBi
b3ggcG9zaXRpb24sIG9wdGlvbnM6IG5vbmUsIGhvcml6b250YWwgb3IgdmVydGljYWw8L3Rk
PgoJCQk8dGQ+aG9yaXpvbnRhbDwvdGQ+CgkJCTx0ZD5jb3VudD0mcXVvdDtub25lJnF1b3Q7
PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmluY2x1ZGVfanM8L3RkPgoJCQk8dGQ+V2hl
dGhlciBvciBub3QgdG8gaW5jbHVkZSB0aGUgd2lkZ2V0IEphdmFTY3JpcHQ8L3RkPgoJCQk8
dGQ+MTwvdGQ+CgkJCTx0ZD5pbmNsdWRlX2pzPSZxdW90OzAmcXVvdDs8L3RkPgoJCTwvdHI+
CgkJPHRyPgoJCQk8dGQ+b3B0aW1pc2VfanM8L3RkPgoJCQk8dGQ+T3B0aW1pc2UgdGhlIEph
dmFTY3JpcHQgYnkgdXNpbmcgYSBsb2NhbCBzY3JpcHQgcmF0aGVyIHRoYW4gdGhhdCBob3N0
ZWQgb24gdGhlIFR3aXR0ZXIgc2l0ZTwvdGQ+CgkJCTx0ZD4wPC90ZD4KCQkJPHRkPm9wdGlt
aXNlX2pzPSZxdW90OzEmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2xhc3M8
L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5DU1M8
L3NwYW4+PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUgYXBwbGllZCB0byB0aGUgdHdlZXQgYnV0
dG9uPC90ZD4KCQkJPHRkPnR3aXR0ZXItc2hhcmUtYnV0dG9uPC90ZD4KCQk8L3RyPgoJPC90
YWJsZT4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl9mb2xsb3dfYnV0
dG9uX3RhZyI+VGhlIGFyY190d2l0dGVyX2ZvbGxvd19idXR0b24gdGFnPC9oMj4KCgk8cD5P
dXRwdXRzIHRoZSBUd2l0dGVyIGZvbGxvdyBidXR0b24gKGFuIGFsdGVybmF0aXZlIHZlcnNp
b24gaXMgaW5jbHVkZWQgaW4gYXJjX3R3aXR0ZXJfaW50ZW50cykuPC9wPgoKCTxoMz5TeW50
YXg8L2gzPgoKCTxwPiZsdDt0eHA6YXJjX3R3aXR0ZXJfZm9sbG93X2J1dHRvbiAvJmd0Ozwv
cD4KCgk8aDM+VXNhZ2U8L2gzPgoKCTx0YWJsZT4KCQk8dHI+CgkJCTx0aD5BdHRyaWJ1dGU8
L3RoPgoJCQk8dGg+RGVzY3JpcHRpb248L3RoPgoJCQk8dGg+RGVmYXVsdDwvdGg+CgkJCTx0
aD5FeGFtcGxlPC90aD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnVzZXI8L3RkPgoJCQk8dGQ+
VHdpdHRlciB1c2VyIG5hbWUgdG8gZm9sbG93PC90ZD4KCQkJPHRkPiA8ZW0+YXJjX3R3aXR0
ZXIgdXNlcm5hbWU8L2VtPjwvdGQ+CgkJCTx0ZD51c2VyPSZxdW90O2RybW9ua2V5bmluamEm
cXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+bGFuZzwvdGQ+CgkJCTx0ZD5MYW5n
dWFnZTwvdGQ+CgkJCTx0ZD5lbjwvdGQ+CgkJCTx0ZD5sYW5nPSZxdW90O2VzJnF1b3Q7PC90
ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNvdW50PC90ZD4KCQkJPHRkPldoZXRoZXIgb3Ig
bm90IHRoZSBmb2xsb3dlciBjb3VudCBpcyBzaG93bjwvdGQ+CgkJCTx0ZD4xPC90ZD4KCQkJ
PHRkPmNvdW50PSZxdW90OzAmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+aW5j
bHVkZV9qczwvdGQ+CgkJCTx0ZD5XaGV0aGVyIG9yIG5vdCB0byBpbmNsdWRlIHRoZSB3aWRn
ZXQgSmF2YVNjcmlwdDwvdGQ+CgkJCTx0ZD4xPC90ZD4KCQkJPHRkPmluY2x1ZGVfanM9JnF1
b3Q7MCZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5vcHRpbWlzZV9qczwvdGQ+
CgkJCTx0ZD5PcHRpbWlzZSB0aGUgSmF2YVNjcmlwdCBieSB1c2luZyBhIGxvY2FsIHNjcmlw
dCByYXRoZXIgdGhhbiB0aGF0IGhvc3RlZCBvbiB0aGUgVHdpdHRlciBzaXRlPC90ZD4KCQkJ
PHRkPjA8L3RkPgoJCQk8dGQ+b3B0aW1pc2VfanM9JnF1b3Q7MSZxdW90OzwvdGQ+CgkJPC90
cj4KCQk8dHI+CgkJCTx0ZD5jbGFzczwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+
PHNwYW4gY2xhc3M9ImNhcHMiPkNTUzwvc3Bhbj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBh
cHBsaWVkIHRvIHRoZSBmb2xsb3cgYnV0dG9uPC90ZD4KCQkJPHRkPnR3aXR0ZXItZm9sbG93
LWJ1dHRvbjwvdGQ+CgkJPC90cj4KCTwvdGFibGU+CgoJPGgyIGNsYXNzPSJzZWN0aW9uIiBp
ZD0iYXJjX3R3aXR0ZXJfdHdlZXRfdXJsIj5hcmNfdHdpdHRlcl90d2VldF91cmw8L2gyPgoK
CTxwPlJldHVybnMgdGhlIDxzcGFuIGNsYXNzPSJjYXBzIj5VUkw8L3NwYW4+IG9mIHRoZSBU
d2l0dGVyIHN0YXR1cyBmb3IgYW4gYXJ0aWNsZS48L3A+CgoJPGgzPlN5bnRheDwvaDM+CgoJ
PHA+Jmx0O3R4cDphcmNfdHdpdHRlcl90d2VldF91cmwgLyZndDs8L3A+CgoJPHA+Jmx0O3R4
cDphcmNfdHdpdHRlcl90d2VldF91cmwmZ3Q7TGluayB0ZXh0Jmx0Oy90eHA6YXJjX3R3aXR0
ZXJfdHdlZXRfdXJsJmd0OzwvcD4KCgk8aDM+VXNhZ2U8L2gzPgoKCTx0YWJsZT4KCQk8dHI+
CgkJCTx0aD5BdHRyaWJ1dGU8L3RoPgoJCQk8dGg+RGVzY3JpcHRpb248L3RoPgoJCQk8dGg+
RGVmYXVsdDwvdGg+CgkJCTx0aD5FeGFtcGxlPC90aD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRk
PmlkPC90ZD4KCQkJPHRkPlRleHRwYXR0ZXJuIGFydGljbGUgSUQ8L3RkPgoJCQk8dGQ+IDxl
bT5jdXJyZW50IGFydGljbGU8L2VtPjwvdGQ+CgkJCTx0ZD5pZD0mcXVvdDsxJnF1b3Q7PC90
ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnRpdGxlPC90ZD4KCQkJPHRkPlRpdGxlIGF0dHJp
YnV0ZSBvZiB0aGUgbGluazwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCTwv
dHI+CgkJPHRyPgoJCQk8dGQ+Y2xhc3M8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMi
PjxzcGFuIGNsYXNzPSJjYXBzIj5DU1M8L3NwYW4+PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUg
YXBwbGllZCB0byB0aGUgbGluazwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJ
CTwvdHI+Cgk8L3RhYmxlPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0dGVy
X3Rpbnl1cmwiPmFyY190d2l0dGVyX3Rpbnl1cmw8L2gyPgoKCTxwPlJldHVybnMgdGhlIHNo
b3J0ZW5lZCA8c3BhbiBjbGFzcz0iY2FwcyI+VVJMPC9zcGFuPiBvZiB0aGUgYXJ0aWNsZSB1
c2VkIGZvciB0aGUgVHdpdHRlciB1cGRhdGUuPC9wPgoKCTxoMz5TeW50YXg8L2gzPgoKCTxw
PiZsdDt0eHA6YXJjX3R3aXR0ZXJfdGlueXVybCAvJmd0OzwvcD4KCgk8cD4mbHQ7dHhwOmFy
Y190d2l0dGVyX3Rpbnl1cmwmZ3Q7TGluayB0ZXh0Jmx0Oy90eHA6YXJjX3R3aXR0ZXJfdGlu
eXVybCZndDs8L3A+CgoJPGgzPlVzYWdlPC9oMz4KCgk8dGFibGU+CgkJPHRyPgoJCQk8dGg+
QXR0cmlidXRlPC90aD4KCQkJPHRoPkRlc2NyaXB0aW9uPC90aD4KCQkJPHRoPkRlZmF1bHQ8
L3RoPgoJCQk8dGg+RXhhbXBsZTwvdGg+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5pZDwvdGQ+
CgkJCTx0ZD5UZXh0cGF0dGVybiBhcnRpY2xlIElEPC90ZD4KCQkJPHRkPiA8ZW0+Y3VycmVu
dCBhcnRpY2xlPC9lbT48L3RkPgoJCQk8dGQ+aWQ9JnF1b3Q7MSZxdW90OzwvdGQ+CgkJPC90
cj4KCQk8dHI+CgkJCTx0ZD50aXRsZTwvdGQ+CgkJCTx0ZD5UaXRsZSBhdHRyaWJ1dGUgb2Yg
dGhlIGxpbms8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQk8L3RyPgoJCTx0
cj4KCQkJPHRkPmNsYXNzPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBj
bGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmlidXRlIGFwcGxpZWQg
dG8gdGhlIGxpbms8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQk8L3RyPgoJ
PC90YWJsZT4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl9jYWNoaW5n
Ij5DYWNoaW5nPC9oMj4KCgk8cD5JbiBvcmRlciB0byBwcmV2ZW50IGV4Y2Vzc2l2ZSByZXBl
YXRpdGl2ZSBjYWxscyB0byB0aGUgVHdpdHRlciB3ZWJzaXRlIGl0IGlzIHJlY29tbWVuZGVk
IHRvIGNhY2hlIHJlc3VsdHMuIFR3aXR0ZXIgbGltaXRzIHRoZSBudW1iZXIgb2YgY2FsbHMg
dGhyb3VnaCB0aGUgPHNwYW4gY2xhc3M9ImNhcHMiPkFQSTwvc3Bhbj4sIGFuZCBjb250aW51
b3VzIGNhbGxzIHdpbGwgcmVzdWx0IGluIFR3aXR0ZXIgY2xvc2luZyB0byBmdXJ0aGVyIHJl
cXVlc3RzLiBCeSBkZWZhdWx0LCBhcmNfdHdpdHRlciBjYWNoZXMgZm9yIDMwIG1pbnV0ZSBp
bnRlcnZhbHMuPC9wPgoKCTx0YWJsZT4KCQk8dHI+CgkJCTx0aD5BdHRyaWJ1dGU8L3RoPgoJ
CQk8dGg+RGVzY3JpcHRpb248L3RoPgoJCQk8dGg+RGVmYXVsdDwvdGg+CgkJCTx0aD5FeGFt
cGxlPC90aD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNhY2hpbmc8L3RkPgoJCQk8dGQ+JiM4
MjE2OzEmIzgyMTc7IHRvIGNhY2hlIGZlZWQsICYjODIxNjswJiM4MjE3OyB0byB0dXJuIGNh
Y2hpbmcgb2ZmIChub3QgcmVjb21tZW5kZWQpPC90ZD4KCQkJPHRkPjE8L3RkPgoJCQk8dGQ+
Y2FjaGluZz0mcXVvdDsxJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNhY2hl
X2RpcjwvdGQ+CgkJCTx0ZD5BYnNvbHV0ZSBwYXRoIHRvIHRoZSBjYWNoZSBkaXJlY3Rvcnkg
KG11c3QgYmUgd3JpdGFibGUpPC90ZD4KCQkJPHRkPiA8ZW0+YXJjX3R3aXR0ZXIgcHJlZmVy
ZW5jZXM8L2VtPjwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jYWNoZV90aW1lPC90ZD4K
CQkJPHRkPlRpbWUgaW4gbWludXRlcyB0aGF0IHRoZSBjYWNoZSBmaWxlcyBhcmUgc3RvcmVk
IGJlZm9yZSBiZWluZyByZWZyZXNoZWQ8L3RkPgoJCQk8dGQ+NTwvdGQ+CgkJCTx0ZD5jYWNo
ZV90aW1lPSZxdW90OzMwJnF1b3Q7PC90ZD4KCQk8L3RyPgoJPC90YWJsZT4KCgk8cD5UaGUg
YWRtaW4gc2lkZSBvZiB0aGlzIHBsdWdpbiBlbmZvcmNlcyBjYWNoaW5nLCBhcGFydCBmcm9t
IHdoZW4gaXQgaXMgcG9zdGluZyB0byBUd2l0dGVyICg8aT5lLmcuPC9pPiB3aGVuIHBvc3Rp
bmcgb3IgZGVsZXRpbmcgYW4gdXBkYXRlKS48L3A+CgoJPGgyIGNsYXNzPSJzZWN0aW9uIiBp
ZD0iYXJjX3R3aXR0ZXJfcHJlZnMiPlByZWZlcmVuY2VzPC9oMj4KCgk8cD5Zb3UgY2FuIGFj
Y2VzcyB0aGUgcGx1Z2lucyBjb3JlIHByZWZlcmVuY2VzIGZyb20gZWl0aGVyIHRoZSBQcmVm
ZXJlbmNlcyBvciBQbHVnaW5zIHRhYnMgaW4gYWRtaW4uIFNldHVwIHlvdXIgVHdpdHRlciBh
Y2NvdW50ICh5b3Ugd2lsbCBiZSBhc2tlZCB0byBjb25uZWN0IHZpYSBUd2l0dGVyIGFuZCB0
aGlzIG5lZWRzIGRvaW5nIGJlZm9yZSB5b3UgY2FuIHVzZSB0aGUgcGx1Z2luKSBhbmQgY2hh
bmdlIHRoZSBjYWNoZSBkaXJlY3RvcnkgdXNpbmcgYXJjX3R3aXR0ZXImIzgyMTc7cyBwcmVm
ZXJlbmNlcy4gV2l0aG91dCBwcm92aWRpbmcgeW91ciBhY2NvdW50IGxvZ2luIGRldGFpbHMg
dGhlIGFkbWluIGFyZWEgZmVhdHVyZXMgb2YgdGhpcyBwbHVnaW4gd2lsbCBiZSBpbmFjdGl2
ZS48L3A+CgoJPHA+WW91IGNhbiBzZWxlY3QgdGhlIDxzcGFuIGNsYXNzPSJjYXBzIj5VUkw8
L3NwYW4+IHNob3J0ZW5lciBtZXRob2QgeW91IHdhbnQgdG8gdXNlIHRvIGxpbmsgYmFjayB0
byB5b3VyIGFydGljbGUgb24gVHdpdHRlci4gUGxlYXNlIG5vdGUgdGhhdCBpZiB5b3Ugc2Vs
ZWN0IHNtZF9zaG9ydF91cmwgeW91IHdpbGwgbmVlZCB0byBoYXZlIGluc3RhbGxlZCBhbmQg
YWN0aXZhdGVkIHRoZSA8YSBocmVmPSJodHRwOi8vdGV4dHBhdHRlcm4ub3JnL3BsdWdpbnMv
MTA5OS9zbWRfc2hvcnRfdXJsIj48c3BhbiBjbGFzcz0idGFnIj5zbWRfc2hvcnRfdXJsPC9z
cGFuPiBwbHVnaW48L2E+IGRldmVsb3BlZCBieSBTdGVmIERhd3Nvbi48L3A+CgoJPGgyIGNs
YXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfYXJ0aWNsZSI+VHdlZXRpbmcgYXJ0aWNs
ZXM8L2gyPgoKCTxwPkJ5IGRlZmF1bHQgYXJjX3R3aXR0ZXIgd2lsbCBwb3N0IGFuIHVwZGF0
ZSB0byBUd2l0dGVyIGluY2x1ZGluZyBhIHNob3J0ZW5lZCA8c3BhbiBjbGFzcz0iY2FwcyI+
VVJMPC9zcGFuPiB0byB5b3VyIGFydGljbGUuIE9ubHkgbGl2ZSBhbmQgYWN0aXZlIGFydGlj
bGVzIHdpbGwgYmUgc2VudCB0byBUd2l0dGVyLCA8aT5pLmUuPC9pPiBhcnRpY2xlcyBwb3N0
ZWQgaW4gdGhlIGZ1dHVyZSBvciBhcyBzdGlja3kgYXJ0aWNsZXMgd2lsbCBub3QgYmUgc2Vu
dC4gSWYgeW91ciBhcnRpY2xlIGlzIHN1Y2Nlc3NmdWxseSBzdWJtaXR0ZWQgdG8gVHdpdHRl
ciB0aGUgdXBkYXRlIHdpbGwgYXBwZWFyIGluIHBsYWNlIG9mIHRoZSBUd2l0dGVyIG9wdGlv
biBvbiB0aGUgcmlnaHQtaGFuZC1zaWRlIG9mIHRoZSBhcnRpY2xlIGVkaXQgc2NyZWVuLjwv
cD4KCgk8cD5Ud2VldHMgYXJlIHNlbnQgaW4gdGhlIGZvbGxvd2luZyBmb3JtYXQ6IDxlbT5U
d2VldCBwcmVmaXg8L2VtPiA8ZW0+QXJ0aWNsZSB0aXRsZTwvZW0+IDxlbT5TaG9ydGVuZWQg
PHNwYW4gY2xhc3M9ImNhcHMiPlVSTDwvc3Bhbj48L2VtPiA8ZW0+VHdlZXQgc3VmZml4PC9l
bT4uIFlvdSBjYW4gY2hhbmdlIHRoZSBwcmVmaXggYW5kIHN1ZmZpeCBvbiBhbiBhcnRpY2xl
LWJ5LWFydGljbGUgYmFzaXMgYnkgY2hhbmdpbmcgdGhlIHR3ZWV0IG9wdGlvbnMgdW5kZXIg
JiM4MjE2O1VwZGF0ZSBUd2l0dGVyJiM4MjE3OyBvbiB0aGUgYXJ0aWNsZSBlZGl0b3Igc2Ny
ZWVuLiBUaGUgZGVmYXVsdCA8ZW0+VHdlZXQgcHJlZml4PC9lbT4gY2FuIGJlIHNldCB1bmRl
ciB0aGUgPHNwYW4gY2xhc3M9InRhZyI+YXJjX3R3aXR0ZXI8L3NwYW4+IHByZWZlcmVuY2Vz
IHNjcmVlbiAodGhlIGRlZmF1bHQgb24gaW5zdGFsbGF0aW9uIGlzICYjODIyMDtKdXN0IHBv
c3RlZDomIzgyMjE7KS48L3A+CgoJPHA+UGxlYXNlIG5vdGUgdGhhdCBvbmNlIGFuIGFydGlj
bGUgaGFzIGJlZW4gdHdlZXRlZCB0aGUgdHdlZXQgY2Fubm90IGJlIGVkaXRlZC48L3A+CgoJ
PGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfYWRtaW4iPlRoZSBUd2l0dGVy
IHRhYjwvaDI+CgoJPHA+VW5kZXIgdGhlIEV4dGVuc2lvbnMgdGFiICh0aGlzIGNhbiBiZSBj
aGFuZ2VkIGZyb20gdGhlIHBsdWdpbiYjODIxNztzIHByZWZlcmVuY2UgcGFnZSkgYSBuZXcg
VHdpdHRlciB0YWIgc2hvdWxkIGFwcGVhciBvbmNlIHlvdSBoYXZlIGNvbm5lY3RlZCB5b3Vy
IHNpdGUgdG8geW91ciBUd2l0dGVyIGFjY291bnQuIEZyb20gaGVyZSB5b3Ugd2lsbCBiZSBh
YmxlIHRvIHN1Ym1pdCBuZXcgVHdpdHRlciB1cGRhdGVzLCB2aWV3IGJhc2ljIGFjY291bnQg
c3RhdGlzdGljcywgYW5kIGNoZWNrIG91dCB5b3VyIHJlY2VudCB1cGRhdGVzIChpbmNsdWRp
bmcgdGhlIG9wdGlvbiB0byBkZWxldGUgeW91ciB0d2VldHMpLjwvcD4iO3M6NDoiY29kZSI7
czo3NjUwMDoiZ2xvYmFsICRwcmVmcywkdHhwY2ZnLCRhcmNfdHdpdHRlcl9jb25zdW1lcktl
eSwkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQ7CgokYXJjX3R3aXR0ZXIgPSBhcnJheSgp
OwoKJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5ID0gJ25LY1hzbHd6WmhCZDBrZktNZXRuUEEn
OwokYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQgPSAnQzZuU1BDTDNlZUhHVEJoS0Nnd2Q5
b2NsY3VEMHNyQjhXVmtmWFFZQzU0JzsKCmFkZF9wcml2cygncGx1Z2luX3ByZWZzLmFyY190
d2l0dGVyJywnMSwyJyk7CnJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfdHdpdHRlcl9pbnN0YWxs
JywncGx1Z2luX2xpZmVjeWNsZS5hcmNfdHdpdHRlcicsICdpbnN0YWxsZWQnKTsKcmVnaXN0
ZXJfY2FsbGJhY2soJ2FyY190d2l0dGVyX3VuaW5zdGFsbCcsJ3BsdWdpbl9saWZlY3ljbGUu
YXJjX3R3aXR0ZXInLCAnZGVsZXRlZCcpOwpyZWdpc3Rlcl9jYWxsYmFjaygnYXJjX3R3aXR0
ZXJfcHJlZnMnLCdwbHVnaW5fcHJlZnMuYXJjX3R3aXR0ZXInKTsKCi8qCiAqIFNldHVwIGlu
aXRpYWwgcHJlZmVyZW5jZXMgaWYgbm90IGluIHRoZSB0eHBfcHJlZnMgdGFibGUuCiAqLwpp
ZiAoIWlzc2V0KCRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddKSkKICAgIHNldF9wcmVmKCdh
cmNfdHdpdHRlcl91c2VyJywgJycsICdhcmNfdHdpdHRlcicsIDEsICd0ZXh0X2lucHV0Jyk7
CmlmICghaXNzZXQoJHByZWZzWydhcmNfdHdpdHRlcl9wcmVmaXgnXSkpCiAgc2V0X3ByZWYo
J2FyY190d2l0dGVyX3ByZWZpeCcsJ0p1c3QgcG9zdGVkOicsICdhcmNfdHdpdHRlcicsIDIs
ICd0ZXh0X2lucHV0Jyk7CmlmICghaXNzZXQoJHByZWZzWydhcmNfdHdpdHRlcl9zdWZmaXgn
XSkpCiAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3N1ZmZpeCcsJycsICdhcmNfdHdpdHRlcics
IDIsICd0ZXh0X2lucHV0Jyk7CmlmICghaXNzZXQoJHByZWZzWydhcmNfdHdpdHRlcl9jYWNo
ZV9kaXInXSkpCiAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX2NhY2hlX2RpcicsJHR4cGNmZ1sn
dHhwYXRoJ10uJHByZWZzWyd0ZW1wZGlyJ10sICdhcmNfdHdpdHRlcicsIDEsICd0ZXh0X2lu
cHV0Jyk7CmlmICghaXNzZXQoJHByZWZzWydhcmNfdHdpdHRlcl90d2VldF9kZWZhdWx0J10p
KQogIHNldF9wcmVmKCdhcmNfdHdpdHRlcl90d2VldF9kZWZhdWx0JywgMSwgJ2FyY190d2l0
dGVyJywgMiwgJ3llc25vUmFkaW8nKTsKaWYgKCFpc3NldCgkcHJlZnNbJ2FyY190d2l0dGVy
X3VybF9tZXRob2QnXSkpCiAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3VybF9tZXRob2QnLCAn
dGlueXVybCcsICdhcmNfdHdpdHRlcicsIDIsCiAgICAnYXJjX3R3aXR0ZXJfdXJsX21ldGhv
ZF9zZWxlY3QnKTsKaWYgKCFpc3NldCgkcHJlZnNbJ2FyY19zaG9ydF91cmwnXSkpCiAgc2V0
X3ByZWYoJ2FyY19zaG9ydF91cmwnLCAwLCAnYXJjX3R3aXR0ZXInLCAyLCAneWVzbm9SYWRp
bycpOwppZiAoIWlzc2V0KCRwcmVmc1snYXJjX3Nob3J0X3NpdGVfdXJsJ10pKQogIHNldF9w
cmVmKCdhcmNfc2hvcnRfc2l0ZV91cmwnLCAkcHJlZnNbJ3NpdGV1cmwnXSwgJ2FyY190d2l0
dGVyJywgMiwgJ3RleHRfaW5wdXQnKTsKLy8gTWFrZSBzdXJlIHRoYXQgdGhlIFR3aXR0ZXIg
dGFiIGhhcyBiZWVuIGRlZmluZWQKaWYgKCFpc3NldCgkcHJlZnNbJ2FyY190d2l0dGVyX3Rh
YiddKSkgewogIHNldF9wcmVmKCdhcmNfdHdpdHRlcl90YWInLCAnZXh0ZW5zaW9ucycsICdh
cmNfdHdpdHRlcicsIDIsCiAgICAnYXJjX3R3aXR0ZXJfdGFiX3NlbGVjdCcpOwogICAgJHBy
ZWZzWydhcmNfdHdpdHRlcl90YWInXSA9ICdleHRlbnNpb25zJzsKfQoKLy8gQ2hlY2sgaWYg
YXJjX3Nob3J0X3VybCBpcyBlbmFibGVkCmlmICgoaXNzZXQoJHByZWZzWydhcmNfc2hvcnRf
dXJsJ10pJiYkcHJlZnNbJ2FyY19zaG9ydF91cmwnXSkKfHwgKGlzc2V0KCRwcmVmc1snYXJj
X3Nob3J0X3VybF9tZXRob2QnXSkmJiRwcmVmc1snYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCdd
PT0nYXJjX3R3aXR0ZXInKSkgewogIHJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfc2hvcnRfdXJs
X3JlZGlyZWN0JywgJ3R4cF9kaWUnLCA0MDQpOwp9CgppZiAoQHR4cGludGVyZmFjZSA9PSAn
YWRtaW4nKSB7CiAgICByZWdpc3Rlcl9jYWxsYmFjaygnX2FyY190d2l0dGVyX2F1dG9fZW5h
YmxlJywgJ3BsdWdpbl9saWZlY3ljbGUuYXJjX3R3aXR0ZXInLCAnaW5zdGFsbGVkJyk7CiAg
ICBpZiAoIWVtcHR5KCRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddKQogICAgICAgICYmICFl
bXB0eSgkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuJ10pCiAgICAgICAgJiYgIWVt
cHR5KCRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW5TZWNyZXQnXSkgKSB7CgogICAg
ICAgIGlmICgkcHJlZnNbJ2FyY190d2l0dGVyX3RhYiddKSB7CiAgICAgICAgICAgIGFkZF9w
cml2cygnYXJjX2FkbWluX3R3aXR0ZXInLCAnMSwyLDMsNCcpOwogICAgICAgICAgICByZWdp
c3Rlcl90YWIoJHByZWZzWydhcmNfdHdpdHRlcl90YWInXSwgJ2FyY19hZG1pbl90d2l0dGVy
JywgJ1R3aXR0ZXInKTsKICAgICAgICAgICAgcmVnaXN0ZXJfY2FsbGJhY2soJ2FyY19hZG1p
bl90d2l0dGVyJywgJ2FyY19hZG1pbl90d2l0dGVyJyk7CiAgICAgICAgfQoKICAgICAgICBy
ZWdpc3Rlcl9jYWxsYmFjaygnYXJjX2FydGljbGVfdHdlZXQnLCAncGluZycpOwogICAgICAg
IHJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfYXJ0aWNsZV90d2VldCcsICdhcnRpY2xlX3NhdmVk
Jyk7CiAgICAgICAgcmVnaXN0ZXJfY2FsbGJhY2soJ2FyY19hcnRpY2xlX3R3ZWV0JywgJ2Fy
dGljbGVfcG9zdGVkJyk7CiAgICAgICAgcmVnaXN0ZXJfY2FsbGJhY2soJ2FyY19hcHBlbmRf
dHdpdHRlcicsICdhcnRpY2xlX3VpJywgJ3N0YXR1cycpOwogICAgfQp9CgovKgogICAgUHVi
bGljLXNpZGUgZnVuY3Rpb25zCiAgICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiovCgpmdW5jdGlvbiBhcmNfdHdp
dHRlcigkYXR0cykKewogIGdsb2JhbCAkcHJlZnMsJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5
LCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQ7CgogIGV4dHJhY3QobEF0dHMoYXJyYXko
CiAgICAndXNlcicgICAgICA9PiAkcHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXSwKICAgICdw
YXNzd29yZCcgID0+ICcnLAogICAgJ3RpbWVsaW5lJyAgPT4gJ3VzZXInLAogICAgJ2xpbWl0
JyAgICAgPT4gJzEwJywKICAgICdmZXRjaCcgICAgID0+IDAsCiAgICAncmV0d2VldHMnICA9
PiBmYWxzZSwKICAgICdyZXBsaWVzJyAgID0+IHRydWUsCiAgICAnZGF0ZWZvcm1hdCc9PiAk
cHJlZnNbJ2FyY2hpdmVfZGF0ZWZvcm1hdCddLAogICAgJ2NhY2hpbmcnICAgPT4gJzEnLAog
ICAgJ2NhY2hlX2RpcicgPT4gJHByZWZzWydhcmNfdHdpdHRlcl9jYWNoZV9kaXInXSwKICAg
ICdjYWNoZV90aW1lJz0+ICc1JywKICAgICdsYWJlbCcgICAgID0+ICcnLAogICAgJ2xhYmVs
dGFnJyAgPT4gJycsCiAgICAnYnJlYWsnICAgICA9PiAnbGknLAogICAgJ3dyYXB0YWcnICAg
PT4gJycsCiAgICAnY2xhc3MnICAgICA9PiBfX0ZVTkNUSU9OX18sCiAgICAnY2xhc3NfcG9z
dGVkJyA9PiBfX0ZVTkNUSU9OX18uJy1wb3N0ZWQnCiAgICApLCRhdHRzKSk7CgogICR0d2l0
ID0gbmV3IGFyY190d2l0dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktleQogICAgICAgICAg
ICAsICRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldCwgJHByZWZzWydhcmNfdHdpdHRlcl9h
Y2Nlc3NUb2tlbiddCiAgICAgICAgICAgICwgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NU
b2tlblNlY3JldCddKTsKCiAgaWYgKCRjYWNoaW5nKSB7ICAvLyB0dXJuIG9uIGNhY2hpbmcs
IHJlY29tbWVuZGVkIChkZWZhdWx0KQogICAgJHR3aXQtPnNldENhY2hpbmcodHJ1ZSk7CiAg
ICAkdHdpdC0+Y2FjaGVEaXIoJGNhY2hlX2Rpcik7CiAgICAkdHdpdC0+Y2FjaGVUaW1lKCRj
YWNoZV90aW1lKTsKICB9IGVsc2UgeyAgLy8gdHVybiBvZmYgY2FjaGluZywgbm90IHJlY29t
bWVuZGVkIG90aGVyIHRoYW4gZm9yIHRlc3RpbmcKICAgICR0d2l0LT5zZXRDYWNoaW5nKGZh
bHNlKTsKICB9CgogIHN3aXRjaCAoJHRpbWVsaW5lKSB7CiAgICBjYXNlICdob21lJzogY2Fz
ZSAnZnJpZW5kcyc6CiAgICAgICR0aW1lbGluZSA9ICdzdGF0dXNlcy9mcmllbmRzX3RpbWVs
aW5lJzsgYnJlYWs7CiAgICBjYXNlICdtZW50aW9ucyc6CiAgICAgICR0aW1lbGluZSA9ICdz
dGF0dXNlcy9tZW50aW9ucyc7IGJyZWFrOwogICAgY2FzZSAndXNlcic6IGRlZmF1bHQ6ICR0
aW1lbGluZSA9ICdzdGF0dXNlcy91c2VyX3RpbWVsaW5lJzsKICB9CgogIC8vIENoZWNrIHRo
YXQgdGhlIGZldGNoIChUd2l0dGVyJ3MgY291bnQgYXR0cmlidXRlKSBpcyBzZXQgY29ycmVj
dGx5CiAgJGZldGNoID0gKCEkZmV0Y2ggfHwgJGZldGNoPCRsaW1pdCkgPyAkbGltaXQgOiAk
ZmV0Y2g7CgogICRvdXQgPSBhcnJheSgpOwogICR4bWwgPSAkdHdpdC0+Z2V0KCR0aW1lbGlu
ZSwgYXJyYXkoCiAgICAgICdzY3JlZW5fbmFtZSc9PiR1c2VyLAogICAgICAnY291bnQnPT4k
ZmV0Y2gsCiAgICAgICdpbmNsdWRlX3J0cyc9PiRyZXR3ZWV0cywKICAgICAgJ2V4Y2x1ZGVf
cmVwbGllcyc9PiEkcmVwbGllcwogICAgKSk7CiAgaWYgKCR4bWwpIHsKICAgICR0d2VldHMg
PSBAJHhtbC0+eHBhdGgoJy9zdGF0dXNlcy9zdGF0dXMnKTsKICAgIGlmICgkdHdlZXRzKSB7
CiAgICAgIC8vIEFwcGx5IHRoZSBkaXNwbGF5IGxpbWl0IHRvIHRoZSByZXR1cm5lZCB0d2Vl
dHMKICAgICAgJHR3ZWV0cyA9IGFycmF5X3NsaWNlKCR0d2VldHMsIDAsICRsaW1pdCk7CiAg
ICAgIGZvcmVhY2ggKCR0d2VldHMgYXMgJHR3ZWV0KSB7CiAgICAgICAgJHRpbWUgPSBzdHJ0
b3RpbWUoaHRtbGVudGl0aWVzKCR0d2VldC0+Y3JlYXRlZF9hdCkpOwogICAgICAgICRkYXRl
ID0gc2FmZV9zdHJmdGltZSgkZGF0ZWZvcm1hdCwkdGltZSk7CiAgICAgICAgJG91dFtdID0g
YXJjX1R3aXR0ZXI6Om1ha2VMaW5rcyhodG1sZW50aXRpZXMoJHR3ZWV0LT50ZXh0LCBFTlRf
UVVPVEVTLCdVVEYtOCcpKQogICAgICAgICAgLicgJy50YWcoaHRtbGVudGl0aWVzKCRkYXRl
KSwnc3BhbicsJyBjbGFzcz0iJy4kY2xhc3NfcG9zdGVkLiciJyk7CiAgICAgIH0KICAgIH0K
CiAgICByZXR1cm4gZG9MYWJlbCgkbGFiZWwsICRsYWJlbHRhZykuZG9XcmFwKCRvdXQsICR3
cmFwdGFnLCAkYnJlYWssICRjbGFzcyk7CiAgfQoKfQoKZnVuY3Rpb24gYXJjX3R3aXR0ZXJf
c2VhcmNoKCRhdHRzKQp7CiAgICBnbG9iYWwgJHByZWZzLCRhcmNfdHdpdHRlcl9jb25zdW1l
cktleSwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0OwoKICAgIGV4dHJhY3QobEF0dHMo
YXJyYXkoCiAgICAgICAgJ3VzZXInICAgICAgPT4gJHByZWZzWydhcmNfdHdpdHRlcl91c2Vy
J10sCiAgICAgICAgJ3NlYXJjaCcgICAgPT4gJycsCiAgICAgICAgJ2hhc2h0YWdzJyAgPT4g
JycsCiAgICAgICAgJ3VzZXInICAgICAgPT4gJycsCiAgICAgICAgJ3JlcGx5JyAgICAgPT4g
JycsCiAgICAgICAgJ21lbnRpb24nICAgPT4gJycsCiAgICAgICAgJ2xpbWl0JyAgICAgPT4g
JzEwJywKICAgICAgICAnbGFuZycgICAgICA9PiAnJywKICAgICAgICAnZGF0ZWZvcm1hdCc9
PiAkcHJlZnNbJ2FyY2hpdmVfZGF0ZWZvcm1hdCddLAogICAgICAgICdjYWNoaW5nJyAgID0+
ICcxJywKICAgICAgICAnY2FjaGVfZGlyJyA9PiAkcHJlZnNbJ2FyY190d2l0dGVyX2NhY2hl
X2RpciddLAogICAgICAgICdjYWNoZV90aW1lJz0+ICc1JywKICAgICAgICAnbGFiZWwnICAg
ICA9PiAnJywKICAgICAgICAnbGFiZWx0YWcnICA9PiAnJywKICAgICAgICAnYnJlYWsnICAg
ICA9PiAnbGknLAogICAgICAgICd3cmFwdGFnJyAgID0+ICcnLAogICAgICAgICdjbGFzcycg
ICAgID0+IF9fRlVOQ1RJT05fXywKICAgICAgICAnY2xhc3NfcG9zdGVkJyA9PiBfX0ZVTkNU
SU9OX18uJy1wb3N0ZWQnLAogICAgICAgICdjbGFzc191c2VyJyAgID0+IF9fRlVOQ1RJT05f
Xy4nLXVzZXInCiAgICApLCRhdHRzKSk7CgogICAgICAgICR0d2l0ID0gbmV3IGFyY19Ud2l0
dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktleQogICAgICAgICAgICAsICRhcmNfdHdpdHRl
cl9jb25zdW1lclNlY3JldCk7CgogICAgICAgIGlmICgkY2FjaGluZykgeyAgLy8gdHVybiBv
biBjYWNoaW5nLCByZWNvbW1lbmRlZCAoZGVmYXVsdCkKICAgICAgICAgICAgJHR3aXQtPnNl
dENhY2hpbmcodHJ1ZSk7CiAgICAgICAgICAgICR0d2l0LT5jYWNoZURpcigkY2FjaGVfZGly
KTsKICAgICAgICAgICAgJHR3aXQtPmNhY2hlVGltZSgkY2FjaGVfdGltZSk7CiAgICAgICAg
fSBlbHNlIHsgIC8vIHR1cm4gb2ZmIGNhY2hpbmcsIG5vdCByZWNvbW1lbmRlZCBvdGhlciB0
aGFuIGZvciB0ZXN0aW5nCiAgICAgICAgICAgICR0d2l0LT5zZXRDYWNoaW5nKGZhbHNlKTsK
ICAgICAgICB9CgogICAgICAgIC8vIGNvbnN0cnVjdCBzZWFyY2ggcXVlcnkKICAgICAgICBp
ZiAoIWVtcHR5KCRzZWFyY2gpKSB7CiAgICAgICAgICAgICR0ZXJtcyA9IGV4cGxvZGUoJywn
LCRzZWFyY2gpOyAkdGVybXMgPSBhcnJheV9tYXAoJ3RyaW0nLCR0ZXJtcyk7CiAgICAgICAg
ICAgICRzZWFyY2ggPSBpbXBsb2RlKCcgJywkdGVybXMpOwogICAgICAgIH0KICAgICAgICBp
ZiAoJGhhc2h0YWdzKSB7CiAgICAgICAgICAgICRoYXNoZXMgPSBleHBsb2RlKCcsJywkaGFz
aHRhZ3MpOyAkaGFzaGVzID0gYXJyYXlfbWFwKCd0cmltJywkaGFzaGVzKTsKICAgICAgICAg
ICAgJHNlYXJjaC49ICgoJHNlYXJjaCk/JyAnOicnKS4nIycuaW1wbG9kZSgnICMnLCRoYXNo
ZXMpOwogICAgICAgIH0KICAgICAgICBpZiAoJHJlcGx5KSB7CiAgICAgICAgICAgICRzZWFy
Y2guPSAoKCRzZWFyY2gpPycgJzonJykuJ3RvOicudHJpbSgkcmVwbHkpOwogICAgICAgIH0K
ICAgICAgICBpZiAoJHVzZXIpIHsKICAgICAgICAgICAgJHNlYXJjaC49ICgoJHNlYXJjaCk/
JyAnOicnKS4nZnJvbTonLnRyaW0oJHVzZXIpOwogICAgICAgIH0KICAgICAgICBpZiAoJG1l
bnRpb24pIHsKICAgICAgICAgICAgJHNlYXJjaC49ICgoJHNlYXJjaCk/JyAnOicnKS4nQCcu
dHJpbSgkbWVudGlvbik7CiAgICAgICAgfQoKICAgICAgICBpZiAoZW1wdHkoJHNlYXJjaCkp
IHsKICAgICAgICAgICAgcmV0dXJuICcnOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAg
ICRzZWFyY2ggPSB1cmxlbmNvZGUoJHNlYXJjaCk7CiAgICAgICAgfQoKICAgICAgICAkb3V0
ID0gYXJyYXkoKTsKICAgICAgICAkdHdlZXRzID0gJHR3aXQtPmdldCgnaHR0cDovL3NlYXJj
aC50d2l0dGVyLmNvbS9zZWFyY2guYXRvbT9xPScuJHNlYXJjaAogICAgICAgICAgICAsIGFy
cmF5KCdycHAnPT4kbGltaXQsJ2xhbmcnPT4kbGFuZykpOwoKICAgICAgICBpZiAoJHR3ZWV0
cykgeyBmb3JlYWNoICgkdHdlZXRzLT5lbnRyeSBhcyAkdHdlZXQpIHsKICAgICAgICAgICAg
cHJlZ19tYXRjaCgiLyguKikgXCgoLiopXCkvIiwkdHdlZXQtPmF1dGhvci0+bmFtZSwkbWF0
Y2hlcyk7CiAgICAgICAgICAgIGxpc3QoJGF1dGhvciwkdW5hbWUsJG5hbWUpID0gJG1hdGNo
ZXM7CiAgICAgICAgICAgICR0aW1lID0gc3RydG90aW1lKGh0bWxlbnRpdGllcygkdHdlZXQt
PnB1Ymxpc2hlZCkpOwogICAgICAgICAgICAkZGF0ZSA9IHNhZmVfc3RyZnRpbWUoJGRhdGVm
b3JtYXQsJHRpbWUpOwogICAgICAgICAgICAkdGV4dCA9ICR0d2VldC0+dGl0bGU7CiAgICAg
ICAgICAgICRvdXRbXSA9IHRhZyhocmVmKGh0bWxlbnRpdGllcygkdW5hbWUpLCR0d2VldC0+
YXV0aG9yLT51cmksCiAgICAgICAgICAgICAgICAnIHRpdGxlPSInLmh0bWxlbnRpdGllcygk
bmFtZSkuJyInKS4nOiAnLCdzcGFuJwogICAgICAgICAgICAgICAgICAgICwnIGNsYXNzPSIn
LiRjbGFzc191c2VyLiciJykKICAgICAgICAgICAgICAgIC5hcmNfVHdpdHRlcjo6bWFrZUxp
bmtzKGh0bWxlbnRpdGllcygkdGV4dCwgRU5UX1FVT1RFUywnVVRGLTgnKSkKICAgICAgICAg
ICAgICAgIC4nICcudGFnKGh0bWxlbnRpdGllcygkZGF0ZSksJ3NwYW4nCiAgICAgICAgICAg
ICAgICAgICAgLCcgY2xhc3M9IicuJGNsYXNzX3Bvc3RlZC4nIicpOwogICAgICAgIH0gcmV0
dXJuIGRvTGFiZWwoJGxhYmVsLCAkbGFiZWx0YWcpCiAgICAgICAgICAgIC5kb1dyYXAoJG91
dCwgJHdyYXB0YWcsICRicmVhaywgJGNsYXNzKTsgfQoKfQoKZnVuY3Rpb24gYXJjX3R3aXR0
ZXJfdHdlZXQoJGF0dHMpIHsKICAgIGdsb2JhbCAkdGhpc2FydGljbGU7CgogICAgZXh0cmFj
dChsQXR0cyhhcnJheSgKICAgICAgJ2lkJyAgICAgICAgPT4gJHRoaXNhcnRpY2xlWyd0aGlz
aWQnXSwKICAgICAgJ2luY2x1ZGVfdXJsJyAgID0+IHRydWUKICAgICksJGF0dHMpKTsKCiAg
ICBpZiAoJGlkKSB7CiAgICAgIC8vIEZldGNoIGFyY190d2l0dGVyIHN0dWZmIHRvIGJ1aWxk
IHR3ZWV0IGZyb20KICAgICAgJHR3ZWV0ID0gKCRpbmNsdWRlX3VybCkgPyBzYWZlX3Jvdygi
dHdlZXQiLCAnYXJjX3R3aXR0ZXInLCAiYXJ0aWNsZV9pZD17JGlkfSIpCiAgICAgICAgOiBz
YWZlX3JvdygiUkVQTEFDRSh0d2VldCxDT05DQVQoJyAnLHRpbnl1cmwpLCcnKSBBUyB0d2Vl
dCIKICAgICAgICAgICwgJ2FyY190d2l0dGVyJywgImFydGljbGVfaWQ9eyRpZH0iKTsKICAg
IH0KCiAgICBpZiAoJHR3ZWV0Wyd0d2VldCddKSB7CiAgICAgIHJldHVybiBhcmNfVHdpdHRl
cjo6bWFrZUxpbmtzKAogICAgICAgIGh0bWxlbnRpdGllcygkdHdlZXRbJ3R3ZWV0J10sIEVO
VF9RVU9URVMsJ1VURi04JykpOwogICAgfQp9CgpmdW5jdGlvbiBhcmNfdHdpdHRlcl90d2Vl
dF91cmwoJGF0dHMsICR0aGluZz1udWxsKSB7CiAgICBnbG9iYWwgJHRoaXNhcnRpY2xlLCRw
cmVmczsKCiAgICBleHRyYWN0KGxBdHRzKGFycmF5KAogICAgICAnaWQnICAgICAgPT4gJHRo
aXNhcnRpY2xlWyd0aGlzaWQnXSwKICAgICAgJ3RpdGxlJyAgID0+ICcnLAogICAgICAnY2xh
c3MnICAgPT4gJycKICAgICksJGF0dHMpKTsKCiAgICBpZiAoJGlkKSB7CiAgICAgIC8vIEZl
dGNoIGFyY190d2l0dGVyIHN0dWZmIHRvIGJ1aWxkIHR3ZWV0IGZyb20KICAgICAgJHR3ZWV0
ID0gc2FmZV9yb3coInR3ZWV0X2lkIgogICAgICAgICwgJ2FyY190d2l0dGVyJywgImFydGlj
bGVfaWQ9eyRpZH0iKTsKICAgIH0KCiAgICBpZiAoJHR3ZWV0Wyd0d2VldF9pZCddKSB7CiAg
ICAgICR1cmwgPSAiaHR0cDovL3R3aXR0ZXIuY29tLyIuJHByZWZzWydhcmNfdHdpdHRlcl91
c2VyJ10uIi9zdGF0dXMvIi4kdHdlZXRbJ3R3ZWV0X2lkJ107CiAgICAgIGlmICgkdGhpbmc9
PT1udWxsKSB7CiAgICAgICAgcmV0dXJuICR1cmw7CiAgICAgIH0KICAgICAgcmV0dXJuIGhy
ZWYocGFyc2UoJHRoaW5nKSwgJHVybCwKICAgICAgICAoJHRpdGxlID8gJyB0aXRsZT0iJy4k
dGl0bGUuJyInIDogJycpCiAgICAgICAgLigkY2xhc3MgPyAnIGNsYXNzPSInLiRjbGFzcy4n
IicgOiAnJykpOwogICAgfQp9CgpmdW5jdGlvbiBhcmNfdHdpdHRlcl90aW55dXJsKCRhdHRz
LCAkdGhpbmc9bnVsbCkgewogICAgZ2xvYmFsICR0aGlzYXJ0aWNsZTsKCiAgICBleHRyYWN0
KGxBdHRzKGFycmF5KAogICAgICAnaWQnICAgICAgPT4gJHRoaXNhcnRpY2xlWyd0aGlzaWQn
XSwKICAgICAgJ3RpdGxlJyAgID0+ICcnLAogICAgICAnY2xhc3MnICAgPT4gJycKICAgICks
JGF0dHMpKTsKCiAgICBpZiAoJGlkKSB7CiAgICAgIC8vIEZldGNoIGFyY190d2l0dGVyIHN0
dWZmIHRvIGJ1aWxkIHR3ZWV0IGZyb20KICAgICAgJHR3ZWV0ID0gc2FmZV9yb3coInRpbnl1
cmwiCiAgICAgICAgLCAnYXJjX3R3aXR0ZXInLCAiYXJ0aWNsZV9pZD17JGlkfSIpOwogICAg
fQoKICAgIGlmICgkdHdlZXRbJ3Rpbnl1cmwnXSkgewogICAgICBpZiAoJHRoaW5nPT09bnVs
bCkgewogICAgICAgIHJldHVybiAkdHdlZXRbJ3Rpbnl1cmwnXTsKICAgICAgfQoKICAgICAg
cmV0dXJuIGhyZWYocGFyc2UoJHRoaW5nKSwgJHR3ZWV0Wyd0aW55dXJsJ10sCiAgICAgICAg
KCR0aXRsZSA/ICcgdGl0bGU9IicuJHRpdGxlLiciJyA6ICcnKQogICAgICAgIC4oJGNsYXNz
ID8gJyBjbGFzcz0iJy4kY2xhc3MuJyInIDogJycpKTsKICAgIH0KfQoKLyoKICogUHVibGlj
IHRhZyBmb3Igb3V0cHV0dGluZyB3aWRnZXQgSlMKICovCmZ1bmN0aW9uIGFyY190d2l0dGVy
X3dpZGdldF9qcygkYXR0cykKewogIGV4dHJhY3QobEF0dHMoYXJyYXkoCiAgICAgICAgJ29w
dGltaXNlJyA9PiBmYWxzZQogICAgKSwkYXR0cykpOwoKICByZXR1cm4gX2FyY190d2l0dGVy
X3dpZGdldF9qcygkb3B0aW1pc2UpOwp9CgpmdW5jdGlvbiBfYXJjX3R3aXR0ZXJfd2lkZ2V0
X2pzKCRvcHRpbWlzZT10cnVlKQp7CiAgZ2xvYmFsICRhcmNfdHdpdHRlcjsKCiAgLy8gQ2hl
Y2sgaWYgd2lkZ2V0IEpTIGhhcyBhbHJlYWR5IGJlZW4gb3V0cHV0CiAgaWYgKCRhcmNfdHdp
dHRlclsnd2lkZ2V0X2pzJ10pIHJldHVybjsKCiAgaWYgKCRvcHRpbWlzZT09ZmFsc2UpIHsK
ICAgIHJldHVybiAnPHNjcmlwdCBzcmM9Imh0dHA6Ly9wbGF0Zm9ybS50d2l0dGVyLmNvbS93
aWRnZXRzLmpzIiB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiPjwvc2NyaXB0Pic7CiAgfQoKICAk
anMgPSA8PDxKUwo8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCI+CihmdW5jdGlvbigp
IHsKICBpZiAod2luZG93Ll9fdHdpdHRlckludGVudEhhbmRsZXIpIHJldHVybjsKICB2YXIg
aW50ZW50UmVnZXggPSAvdHdpdHRlclwuY29tKFw6XGR7Miw0fSk/XC9pbnRlbnRcLyhcdysp
LywKICAgICAgd2luZG93T3B0aW9ucyA9ICdzY3JvbGxiYXJzPXllcyxyZXNpemFibGU9eWVz
LHRvb2xiYXI9bm8sbG9jYXRpb249eWVzJywKICAgICAgd2lkdGggPSA1NTAsCiAgICAgIGhl
aWdodCA9IDQyMCwKICAgICAgd2luSGVpZ2h0ID0gc2NyZWVuLmhlaWdodCwKICAgICAgd2lu
V2lkdGggPSBzY3JlZW4ud2lkdGg7CgogIGZ1bmN0aW9uIGhhbmRsZUludGVudChlKSB7CiAg
ICBlID0gZSB8fCB3aW5kb3cuZXZlbnQ7CiAgICB2YXIgdGFyZ2V0ID0gZS50YXJnZXQgfHwg
ZS5zcmNFbGVtZW50LAogICAgICAgIG0sIGxlZnQsIHRvcDsKCiAgICB3aGlsZSAodGFyZ2V0
ICYmIHRhcmdldC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpICE9PSAnYScpIHsKICAgICAgdGFy
Z2V0ID0gdGFyZ2V0LnBhcmVudE5vZGU7CiAgICB9CgogICAgaWYgKHRhcmdldCAmJiB0YXJn
ZXQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ2EnICYmIHRhcmdldC5ocmVmKSB7CiAg
ICAgIG0gPSB0YXJnZXQuaHJlZi5tYXRjaChpbnRlbnRSZWdleCk7CiAgICAgIGlmIChtKSB7
CiAgICAgICAgbGVmdCA9IE1hdGgucm91bmQoKHdpbldpZHRoIC8gMikgLSAod2lkdGggLyAy
KSk7CiAgICAgICAgdG9wID0gMDsKCiAgICAgICAgaWYgKHdpbkhlaWdodCA+IGhlaWdodCkg
ewogICAgICAgICAgdG9wID0gTWF0aC5yb3VuZCgod2luSGVpZ2h0IC8gMikgLSAoaGVpZ2h0
IC8gMikpOwogICAgICAgIH0KCiAgICAgICAgd2luZG93Lm9wZW4odGFyZ2V0LmhyZWYsICdp
bnRlbnQnLCB3aW5kb3dPcHRpb25zICsgJyx3aWR0aD0nICsgd2lkdGggKwogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJyxoZWlnaHQ9JyArIGhlaWdodCAr
ICcsbGVmdD0nICsgbGVmdCArICcsdG9wPScgKyB0b3ApOwogICAgICAgIGUucmV0dXJuVmFs
dWUgPSBmYWxzZTsKICAgICAgICBlLnByZXZlbnREZWZhdWx0ICYmIGUucHJldmVudERlZmF1
bHQoKTsKICAgICAgfQogICAgfQogIH0KCiAgaWYgKGRvY3VtZW50LmFkZEV2ZW50TGlzdGVu
ZXIpIHsKICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlSW50
ZW50LCBmYWxzZSk7CiAgfSBlbHNlIGlmIChkb2N1bWVudC5hdHRhY2hFdmVudCkgewogICAg
ZG9jdW1lbnQuYXR0YWNoRXZlbnQoJ29uY2xpY2snLCBoYW5kbGVJbnRlbnQpOwogIH0KICB3
aW5kb3cuX190d2l0dGVySW50ZW50SGFuZGxlciA9IHRydWU7Cn0oKSk7Cjwvc2NyaXB0PgpK
UzsKICAkYXJjX3R3aXR0ZXJbJ3dpZGdldF9qcyddID0gdHJ1ZTsKICByZXR1cm4gJGpzOwp9
CgovLyBEZXByZWNhdGVkIGFyY190d2l0dGVyX3JldHdlZXQgdGFnLCB1c2UgYXJjX3R3aXR0
ZXJfdHdlZXRfYnV0dG9uIGluc3RlYWQKZnVuY3Rpb24gYXJjX3R3aXR0ZXJfcmV0d2VldCgk
YXR0cywgJHRoaW5nPW51bGwpCnsKICByZXR1cm4gYXJjX3R3aXR0ZXJfdHdlZXRfYnV0dG9u
KCRhdHRzLCAkdGhpbmc9bnVsbCk7Cn0KZnVuY3Rpb24gYXJjX3R3aXR0ZXJfdHdlZXRfYnV0
dG9uKCRhdHRzLCAkdGhpbmc9bnVsbCkKewogICAgZ2xvYmFsICRwcmVmcywkYXJjX3R3aXR0
ZXJfY29uc3VtZXJLZXksICRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldDsKICAgIGdsb2Jh
bCAkdGhpc2FydGljbGU7CgogICAgZXh0cmFjdChsQXR0cyhhcnJheSgKICAgICAgICAndXNl
cicgICAgICAgID0+ICRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddLCAvLyB2aWEgdXNlciBh
Y2NvdW50CiAgICAgICAgJ3VybCcgICAgICAgICA9PiAnJywKICAgICAgICAndGV4dCcgICAg
ICAgID0+ICcnLAogICAgICAgICdmb2xsb3cxJyAgICAgPT4gJycsCiAgICAgICAgJ2ZvbGxv
dzInICAgICA9PiAnJywKICAgICAgICAnbGFuZycgICAgICAgID0+ICcnLAogICAgICAgICdj
b3VudCcgICAgICAgPT4gJ2hvcml6b250YWwnLAogICAgICAgICdpbmNsdWRlX2pzJyAgPT4g
dHJ1ZSwKICAgICAgICAnb3B0aW1pc2VfanMnID0+IGZhbHNlLAogICAgICAgICd3cmFwdGFn
JyAgICAgPT4gJycsCiAgICAgICAgJ2NsYXNzJyAgICAgICA9PiAndHdpdHRlci1zaGFyZS1i
dXR0b24nCiAgICApLCRhdHRzKSk7CgogICAgJHEgPSAnJzsgLy8gcXVlcnkgc3RyaW5nCgog
ICAgaWYgKCRpZD0kdGhpc2FydGljbGVbJ3RoaXNpZCddKSB7CiAgICAgIC8vIEZldGNoIGFy
Y190d2l0dGVyIHN0dWZmIHRvIGJ1aWxkIHR3ZWV0IGZyb20KICAgICAgJHJvdyA9IHNhZmVf
cm93KCJSRVBMQUNFKHR3ZWV0LENPTkNBVCgnICcsdGlueXVybCksJycpIEFTIHR3ZWV0LHRp
bnl1cmwiCiAgICAgICAgLCAnYXJjX3R3aXR0ZXInLCAiYXJ0aWNsZV9pZD17JGlkfSIpOwoK
ICAgICAgaWYgKCR1cmw9PScnKSB7CiAgICAgICAgJHVybCA9ICgkdXJsKSA/ICR1cmwgOiBw
ZXJtbGlua3VybCgkdGhpc2FydGljbGUpOwogICAgICAgICRxID0gJ3VybD0nLnVybGVuY29k
ZSgkdXJsKTsKICAgICAgfQogICAgICBpZiAoJHRleHQ9PScnKSB7CiAgICAgICAgJHRleHQg
PSAoJHJvd1sndHdlZXQnXSkgPyAkcm93Wyd0d2VldCddIDogJHRoaXNhcnRpY2xlWyd0aXRs
ZSddOwogICAgICB9CiAgICAgICRxIC49ICgkcSA/ICcmYW1wOycgOiAnJykuJ3RleHQ9Jy51
cmxlbmNvZGUoJHRleHQpOwogICAgfQogICAgaWYgKCR1c2VyKSB7CiAgICAgICRxIC49ICgk
cSA/ICcmYW1wOycgOiAnJykuJ3ZpYT0nLnVybGVuY29kZSgkdXNlcik7CiAgICB9CiAgICBp
ZiAoJGZvbGxvdzEmJiRmb2xsb3cyKSB7CiAgICAgICRxIC49ICgkcSA/ICcmYW1wOycgOiAn
JykuJ3JlbGF0ZWQ9Jy51cmxlbmNvZGUoJGZvbGxvdzEuJzonLiRmb2xsb3cyKTsKICAgIH0g
ZWxzZWlmICgkZm9sbG93MXx8JGZvbGxvdzIpIHsKICAgICAgJHEgLj0gKCRxID8gJyZhbXA7
JyA6ICcnKS4ncmVsYXRlZD0nLnVybGVuY29kZSgkZm9sbG93MS4kZm9sbG93Mik7CiAgICB9
CgogICAgc3dpdGNoICgkbGFuZykgewogICAgICBjYXNlICdmcic6IGJyZWFrOyBjYXNlICdk
ZSc6IGJyZWFrOyBjYXNlICdlcyc6IGJyZWFrOyBjYXNlICdqcCc6IGJyZWFrOwogICAgICBk
ZWZhdWx0OgogICAgICAgICRsYW5nID0gJ2VuJzsKICAgIH0KICAgICRxIC49ICgkcSA/ICcm
YW1wOycgOiAnJykuJ2xhbmc9Jy51cmxlbmNvZGUoJGxhbmcpOwoKICAgIHN3aXRjaCAoJGNv
dW50KSB7CiAgICAgIGNhc2UgJ25vbmUnOiBicmVhazsgY2FzZSAndmVydGljYWwnOiBicmVh
azsKICAgICAgZGVmYXVsdDoKICAgICAgICAkY291bnQgPSAnaG9yaXpvbnRhbCc7CiAgICB9
CiAgICAkcSAuPSAoJHEgPyAnJmFtcDsnIDogJycpLidjb3VudD0nLnVybGVuY29kZSgkY291
bnQpOwoKICAgICR0aGluZyA9ICgkdGhpbmc9PT1udWxsKSA/ICdUd2VldCcgOiBwYXJzZSgk
dGhpbmcpOwoKICAgICRodG1sID0gaHJlZigkdGhpbmcsJ2h0dHA6Ly90d2l0dGVyLmNvbS9z
aGFyZT8nLiRxCiAgICAgICwgJyBjbGFzcz0iJy4kY2xhc3MuJyInKTsKCiAgICAkanMgPSAo
JGluY2x1ZGVfanMpID8gX2FyY190d2l0dGVyX3dpZGdldF9qcygkb3B0aW1pc2VfanM/dHJ1
ZTpmYWxzZSkgOiAnJzsKCiAgICByZXR1cm4gJGpzLiRodG1sOwp9CgovKgogKiBUd2l0dGVy
IEZvbGxvdyBidXR0b24KICovCmZ1bmN0aW9uIGFyY190d2l0dGVyX2ZvbGxvd19idXR0b24o
JGF0dHMsICR0aGluZz1udWxsKQp7CiAgICBnbG9iYWwgJHByZWZzLCRhcmNfdHdpdHRlcl9j
b25zdW1lcktleSwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0OwogICAgZ2xvYmFsICR0
aGlzYXJ0aWNsZTsKCiAgICBleHRyYWN0KGxBdHRzKGFycmF5KAogICAgICAgICd1c2VyJyAg
ICAgICAgPT4gJHByZWZzWydhcmNfdHdpdHRlcl91c2VyJ10sIC8vIHZpYSB1c2VyIGFjY291
bnQKICAgICAgICAnbGFuZycgICAgICAgID0+ICcnLAogICAgICAgICdjb3VudCcgICAgICAg
PT4gdHJ1ZSwKICAgICAgICAnaW5jbHVkZV9qcycgID0+IHRydWUsCiAgICAgICAgJ29wdGlt
aXNlX2pzJyA9PiBmYWxzZSwKICAgICAgICAnY2xhc3MnICAgICAgID0+ICd0d2l0dGVyLWZv
bGxvdy1idXR0b24nCiAgICApLCRhdHRzKSk7CgogICAgJGF0dHMgPSAnJzsgLy8gZGF0YSBh
dHRyaWJ1dGVzCgogICAgc3dpdGNoICgkbGFuZykgewogICAgICBjYXNlICdmcic6IGJyZWFr
OyBjYXNlICdkZSc6IGJyZWFrOyBjYXNlICdlcyc6IGJyZWFrOyBjYXNlICdqcCc6IGJyZWFr
OwogICAgICBkZWZhdWx0OgogICAgICAgICRsYW5nID0gJ2VuJzsKICAgIH0KICAgICRhdHRz
IC49ICcgZGF0YS1sYW5nPSInLnVybGVuY29kZSgkbGFuZykuJyInOwoKICAgICRhdHRzIC49
ICcgZGF0YS1zaG93LWNvdW50PSInLigkY291bnQ/J3RydWUnOidmYWxzZScpLiciJzsKCiAg
ICAkdGhpbmcgPSAoJHRoaW5nPT09bnVsbCkgPyAnRm9sbG93IEAnLiR1c2VyIDogcGFyc2Uo
JHRoaW5nKTsKCiAgICAkaHRtbCA9IGhyZWYoJHRoaW5nLCdodHRwOi8vdHdpdHRlci5jb20v
Jy51cmxlbmNvZGUoJHVzZXIpCiAgICAgICwgJyBjbGFzcz0iJy4kY2xhc3MuJyInLiRhdHRz
KTsKCiAgICAkanMgPSAoJGluY2x1ZGVfanMpID8gX2FyY190d2l0dGVyX3dpZGdldF9qcygk
b3B0aW1pc2VfanM/dHJ1ZTpmYWxzZSkgOiAnJzsKCiAgICByZXR1cm4gJGpzLiRodG1sOwp9
CgovKgogICAgQWRtaW4tc2lkZSBmdW5jdGlvbnMKICAgID09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KKi8KCi8vIElu
c3RhbGxhdGlvbiBmdW5jdGlvbiAtIGJ1aWxkcyBNeVNRTCB0YWJsZQpmdW5jdGlvbiBhcmNf
dHdpdHRlcl9pbnN0YWxsKCkKewoKICAgIC8vIEZvciBmaXJzdCBpbnN0YWxsLCBjcmVhdGUg
dGFibGUgZm9yIHR3ZWV0cwogICAgJHNxbCA9ICJDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNU
UyAiLlBGWC4iYXJjX3R3aXR0ZXIgIjsKICAgICRzcWwuPSAiKGFyY190d2l0dGVyaWQgSU5U
RUdFUiBBVVRPX0lOQ1JFTUVOVCBQUklNQVJZIEtFWSwKICAgICAgICBhcnRpY2xlX2lkIElO
VEVHRVIoMTEpLAogICAgICAgIHR3ZWV0X2lkIEJJR0lOVCgyMCksCiAgICAgICAgdHdlZXQg
VkFSQ0hBUigxNDApLAogICAgICAgIHRpbnl1cmwgVkFSQ0hBUigzMCkpOyI7CgogICAgaWYg
KCFzYWZlX3F1ZXJ5KCRzcWwpKSB7CiAgICAgICAgcmV0dXJuICdFcnJvciAtIHVuYWJsZSB0
byBjcmVhdGUgYXJjX3R3aXR0ZXIgdGFibGUnOwogICAgfQoKfQoKLy8gVW5pbnN0YWxsIGZ1
bmN0aW9uIC0gZGVsZXRlcyBNeVNRTCB0YWJsZSBhbmQgcmVsYXRlZCBwcmVmZXJlbmNlcwpm
dW5jdGlvbiBhcmNfdHdpdHRlcl91bmluc3RhbGwoKQp7CgogICAgJHNxbCA9ICJEUk9QIFRB
QkxFIElGIEVYSVNUUyAiLlBGWC4iYXJjX3R3aXR0ZXI7IjsKICAgIGlmICghc2FmZV9xdWVy
eSgkc3FsKSkgewogICAgICAgIHJldHVybiAnRXJyb3IgLSB1bmFibGUgdG8gZGVsZXRlIGFy
Y190d2l0dGVyIHRhYmxlJzsKICAgIH0KCiAgICAkc3FsID0gIkRFTEVURSBGUk9NICAiLlBG
WC4idHhwX3ByZWZzIFdIRVJFIGV2ZW50PSdhcmNfdHdpdHRlcic7IjsKICAgIGlmICghc2Fm
ZV9xdWVyeSgkc3FsKSkgewogICAgICAgIHJldHVybiAnRXJyb3IgLSB1bmFibGUgdG8gZGVs
ZXRlIGFyY190d2l0dGVyIHByZWZlcmVuY2VzJzsKICAgIH0KCn0KZnVuY3Rpb24gYXJjX3R3
aXR0ZXJfdXJsX21ldGhvZF9zZWxlY3QoJG5hbWUsICR2YWwpCnsKICAgICRtZXRob2RzID0g
YXJyYXkoJ3Rpbnl1cmwnID0+ICdUaW55dXJsJywKICAgICAgJ2lzZ2QnID0+ICdJcy5nZCcs
CiAgICAgICdhcmNfdHdpdHRlcicgPT4gJ1RYUCBUd2VldCcsCiAgICAgICdzbWQnID0+ICdz
bWRfc2hvcnRfdXJsJyk7CiAgICByZXR1cm4gc2VsZWN0SW5wdXQoJG5hbWUsICRtZXRob2Rz
LCAkdmFsLCAnJywgJycsICRuYW1lKTsKfQpmdW5jdGlvbiBhcmNfdHdpdHRlcl90YWJfc2Vs
ZWN0KCRuYW1lLCAkdmFsKQp7CiAgICAkdGFicyA9IGFycmF5KCdjb250ZW50JyA9PiAnQ29u
dGVudCcsCiAgICAgICAgJ2V4dGVuc2lvbnMnID0+ICdFeHRlbnNpb25zJywKICAgICAgICAn
JyA9PiAnSGlkZGVuJyk7CiAgICByZXR1cm4gc2VsZWN0SW5wdXQoJG5hbWUsICR0YWJzLCAk
dmFsLCAnJywgJycsICRuYW1lKTsKfQovLyBQcm92aWRlIGludGVyZmFjZSBmb3Igc2V0dGlu
ZyBwcmVmZXJlbmNlcwpmdW5jdGlvbiBhcmNfdHdpdHRlcl9wcmVmcygkZXZlbnQsJHN0ZXAp
CnsKCiAgICBnbG9iYWwgJHByZWZzLCRhcmNfdHdpdHRlcl9jb25zdW1lcktleSwkYXJjX3R3
aXR0ZXJfY29uc3VtZXJTZWNyZXQ7CgogICAgJHVzZXIgICAgICAgICAgPSAkcHJlZnNbJ2Fy
Y190d2l0dGVyX3VzZXInXTsKICAgICRwcmVmaXggICAgICAgID0gJHByZWZzWydhcmNfdHdp
dHRlcl9wcmVmaXgnXTsKICAgICRzdWZmaXggICAgICAgID0gJHByZWZzWydhcmNfdHdpdHRl
cl9zdWZmaXgnXTsKICAgICR0d2VldF9kZWZhdWx0ID0gJHByZWZzWydhcmNfdHdpdHRlcl90
d2VldF9kZWZhdWx0J107CiAgICAkdXJsX21ldGhvZCAgICA9ICRwcmVmc1snYXJjX3R3aXR0
ZXJfdXJsX21ldGhvZCddOwogICAgJHNob3J0X3VybCAgICAgPSAkcHJlZnNbJ2FyY19zaG9y
dF91cmwnXTsKICAgICRzaG9ydF9zaXRlX3VybD0gJHByZWZzWydhcmNfc2hvcnRfc2l0ZV91
cmwnXTsKICAgICRjYWNoZV9kaXIgICAgID0gJHByZWZzWydhcmNfdHdpdHRlcl9jYWNoZV9k
aXInXTsKICAgICR0YWIgICAgICAgICAgID0gJHByZWZzWydhcmNfdHdpdHRlcl90YWInXTsK
CiAgICBzd2l0Y2ggKCRzdGVwKSB7CiAgICAgICAgY2FzZSAncHJlZnNfc2F2ZSc6IHBhZ2V0
b3AoJ1RYUCBUd2VldCcsICdQcmVmZXJlbmNlcyBzYXZlZCcpOyBicmVhazsKICAgICAgICBj
YXNlICdyZWdpc3Rlcic6IHBhZ2V0b3AoJ1RYUCBUd2VldCcsJ0Nvbm5lY3QgdG8gVHdpdHRl
cicpOyBicmVhazsKICAgICAgICBjYXNlICd2YWxpZGF0ZSc6CiAgICAgICAgZGVmYXVsdDog
cGFnZXRvcCgnVFhQIFR3ZWV0Jyk7CiAgICB9CgogICAgJGh0bWwgPSAnJzsKCiAgICBpZiAo
JHN0ZXA9PSdyZWdpc3RlcicpIHsgLy8gT0F1dGggcmVnaXN0cmF0aW9uIHByb2Nlc3MKCiAg
ICAgICAgJHR3aXQgPSBuZXcgYXJjX3R3aXR0ZXIoJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5
LCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQpOwoKICAgICAgICAvLyBCdWlsZCBhIGNh
bGxiYWNrIFVSTCBmb3IgVHdpdHRlciB0byByZXR1cm4gdG8gdGhlIG5leHQgc3RhZ2UKICAg
ICAgICAkY2FsbGJhY2tVUkwgPSAkdHdpdC0+Y2FsbGJhY2tVUkwoJGV2ZW50LCd2YWxpZGF0
ZScpOwoKICAgICAgICAkcmVxdWVzdCA9ICR0d2l0LT5nZXRSZXF1ZXN0VG9rZW4oJGNhbGxi
YWNrVVJMKTsKICAgICAgICAkcmVxdWVzdF90b2tlbiA9ICRyZXF1ZXN0WyJvYXV0aF90b2tl
biJdOwogICAgICAgICRyZXF1ZXN0X3Rva2VuX3NlY3JldCA9ICRyZXF1ZXN0WyJvYXV0aF90
b2tlbl9zZWNyZXQiXTsKCiAgICAgICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3JlcXVlc3RU
b2tlbicsJHJlcXVlc3RfdG9rZW4sICdhcmNfdHdpdHRlcicsMik7CiAgICAgICAgc2V0X3By
ZWYoJ2FyY190d2l0dGVyX3JlcXVlc3RUb2tlblNlY3JldCcsJHJlcXVlc3RfdG9rZW5fc2Vj
cmV0LCAnYXJjX3R3aXR0ZXInLDIpOwoKCQkkaHRtbCA9ICI8ZGl2IGNsYXNzPSd0ZXh0LWNv
bHVtbic+IgoJCQkuIjxwPiIuaHJlZignU2lnbi1pbiB0byBUd2l0dGVyJywgJHR3aXQtPmdl
dEF1dGhvcml6ZVVSTCgkcmVxdWVzdCkpLiIgYW5kIGZvbGxvdyB0aGUgaW5zdHJ1Y3Rpb25z
IHRvIGFsbG93IFRYUCBUd2VldCB0byB1c2UgeW91ciBhY2NvdW50LiBJZiB5b3UgYXJlIGFs
cmVhZHkgc2lnbmVkIGluIHRvIFR3aXR0ZXIgdGhlbiB0aGF0IGFjY291bnQgd2lsbCBiZSBh
c3NvY2lhdGVkIHdpdGggVFhQIFR3ZWV0IHNvIHlvdSBtYXkgbmVlZCB0byBzaWduIG91dCBm
aXJzdCBpZiB5b3Ugd2FudCB0byB1c2UgYSBkaWZmZXJlbnQgYWNjb3VudC48L3A+IgoJCQku
IjwvZGl2PiI7CgogICAgfSBlbHNlaWYgKCRzdGVwPT0ndmFsaWRhdGUnKSB7CiAgICAgICAg
JHR3aXQgPSBuZXcgYXJjX3R3aXR0ZXIoJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5CiAgICAg
ICAgICAgICwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0LCAkcHJlZnNbJ2FyY190d2l0
dGVyX3JlcXVlc3RUb2tlbiddCiAgICAgICAgICAgICwgJHByZWZzWydhcmNfdHdpdHRlcl9y
ZXF1ZXN0VG9rZW5TZWNyZXQnXSk7CiAgICAgICAgLy8gQXNrIFR3aXR0ZXIgZm9yIGFuIGFj
Y2VzcyB0b2tlbiAoYW5kIGFuIGFjY2VzcyB0b2tlbiBzZWNyZXQpCiAgICAgICAgJHJlcXVl
c3QgPSAkdHdpdC0+Z2V0QWNjZXNzVG9rZW4oIGdwcygnb2F1dGhfdmVyaWZpZXInKSApOwog
ICAgICAgICRhY2Nlc3NfdG9rZW4gPSAkcmVxdWVzdFsnb2F1dGhfdG9rZW4nXTsKICAgICAg
ICAkYWNjZXNzX3Rva2VuX3NlY3JldCA9ICRyZXF1ZXN0WydvYXV0aF90b2tlbl9zZWNyZXQn
XTsKICAgICAgICAkdXNlciA9ICRyZXF1ZXN0WydzY3JlZW5fbmFtZSddOwogICAgICAgIC8v
IFN0b3JlIHRoZSBhY2Nlc3MgdG9rZW4gYW5kIHNlY3JldAogICAgICAgIHNldF9wcmVmKCdh
cmNfdHdpdHRlcl9hY2Nlc3NUb2tlbicsJGFjY2Vzc190b2tlbiwgJ2FyY190d2l0dGVyJywy
KTsKICAgICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW5TZWNyZXQnLCRh
Y2Nlc3NfdG9rZW5fc2VjcmV0CiAgICAgICAgICAgICwgJ2FyY190d2l0dGVyJywyKTsKICAg
ICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfdXNlcicsJHVzZXIpOwogICAgICAgICRwcmVm
c1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW4nXSA9ICRhY2Nlc3NfdG9rZW47CiAgICAgICAg
JHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlblNlY3JldCddID0gJGFjY2Vzc190b2tl
bl9zZWNyZXQ7CiAgICAgICAgdW5zZXQoJHR3aXQpOwogICAgfQoKICAgIGlmICgkc3RlcD09
InByZWZzX3NhdmUiKSB7CiAgICAgICAgJHByZWZpeCA9IHRyaW0oZ3BzKCdhcmNfdHdpdHRl
cl9wcmVmaXgnKSk7CiAgICAgICAgJHN1ZmZpeCA9IHRyaW0oZ3BzKCdhcmNfdHdpdHRlcl9z
dWZmaXgnKSk7CiAgICAgICAgJHR3ZWV0X2RlZmF1bHQgPSBncHMoJ2FyY190d2l0dGVyX3R3
ZWV0X2RlZmF1bHQnKTsKICAgICAgICAkdXJsX21ldGhvZCA9IGdwcygnYXJjX3R3aXR0ZXJf
dXJsX21ldGhvZCcpOwogICAgICAgICRzaG9ydF91cmwgPSBncHMoJ2FyY19zaG9ydF91cmwn
KTsKICAgICAgICAkc2hvcnRfc2l0ZV91cmwgPSBncHMoJ2FyY19zaG9ydF9zaXRlX3VybCcp
OwogICAgICAgICRjYWNoZV9kaXIgPSBncHMoJ2FyY190d2l0dGVyX2NhY2hlX2RpcicpOwog
ICAgICAgICR0YWIgPSBncHMoJ2FyY190d2l0dGVyX3RhYicpOwogICAgICAgIGlmIChzdHJs
ZW4oJHByZWZpeCk8PTIwKSB7CiAgICAgICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl9w
cmVmaXgnLCRwcmVmaXgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICRwcmVmaXgg
PSAkcHJlZnNbJ2FyY190d2l0dGVyX3ByZWZpeCddOwogICAgICAgIH0KICAgICAgICBpZiAo
c3RybGVuKCRzdWZmaXgpPD0yMCkgewogICAgICAgICAgICBzZXRfcHJlZignYXJjX3R3aXR0
ZXJfc3VmZml4Jywkc3VmZml4KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAkc3Vm
Zml4ID0gJHByZWZzWydhcmNfdHdpdHRlcl9zdWZmaXgnXTsKICAgICAgICB9CiAgICAgICAg
JHR3ZWV0X2RlZmF1bHQgPSAoJHR3ZWV0X2RlZmF1bHQpID8gMSA6IDA7CiAgICAgICAgJHNo
b3J0X3VybCA9ICgkc2hvcnRfdXJsKSA/IDEgOiAwOwogICAgICAgIGlmICghJHNob3J0X3Np
dGVfdXJsKSAkc2hvcnRfc2l0ZV91cmwgPSAkcHJlZnNbJ3NpdGV1cmwnXTsKICAgICAgICBz
ZXRfcHJlZignYXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCcsJHR3ZWV0X2RlZmF1bHQpOwog
ICAgICAgIHNldF9wcmVmKCdhcmNfc2hvcnRfdXJsJywkc2hvcnRfdXJsKTsKICAgICAgICBz
ZXRfcHJlZignYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCcsJHVybF9tZXRob2QpOwogICAgICAg
IHNldF9wcmVmKCdhcmNfc2hvcnRfc2l0ZV91cmwnLCRzaG9ydF9zaXRlX3VybCk7CiAgICAg
ICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX2NhY2hlX2RpcicsJGNhY2hlX2Rpcik7CiAgICAg
ICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3RhYicsJHRhYik7CiAgICB9CgogICAgaWYgKCAk
c3RlcCE9J3JlZ2lzdGVyJyApIHsKICAgICAgICBpZiAoIGlzc2V0KCRwcmVmc1snYXJjX3R3
aXR0ZXJfYWNjZXNzVG9rZW4nXSkKICAgICAgICAmJiBpc3NldCgkcHJlZnNbJ2FyY190d2l0
dGVyX2FjY2Vzc1Rva2VuU2VjcmV0J10pICkgewogICAgICAgICAgICAkdHdpdCA9IG5ldyBh
cmNfdHdpdHRlcigkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXkKICAgICAgICAgICAgICAgICwg
JGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0LCAkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vz
c1Rva2VuJ10KICAgICAgICAgICAgICAgICwgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NU
b2tlblNlY3JldCddKTsKICAgICAgICAgICAgJHJlZ2lzdGVyVVJMID0gJHR3aXQtPmNhbGxi
YWNrVVJMKCRldmVudCwncmVnaXN0ZXInKTsKCiAgICAgICAgICAgIC8vIERlZmluZSB0aGUg
ZmllbGRzIHJlYWR5IHRvIGJ1aWxkIHRoZSBmb3JtCiAgICAgICAgICAgICRmaWVsZHMgPSBh
cnJheSgKCQkJCSdUd2VldCBTZXR0aW5ncycgPT4gYXJyYXkoCgkJCQkJJ2FyY190d2l0dGVy
X3ByZWZpeCcgPT4gYXJyYXkoCgkJCQkJCSdsYWJlbCcgPT4gJ1R3ZWV0IHByZWZpeCcsCgkJ
CQkJCSd2YWx1ZScgPT4gJHByZWZpeAoJCQkJCSksCgkJCQkJJ2FyY190d2l0dGVyX3N1ZmZp
eCcgPT4gYXJyYXkoCgkJCQkJCSdsYWJlbCcgPT4gJ1R3ZWV0IHN1ZmZpeCcsCgkJCQkJCSd2
YWx1ZScgPT4gJHByZWZpeAoJCQkJCSksCgkJCQkJJ2FyY190d2l0dGVyX3R3ZWV0X2RlZmF1
bHQnID0+IGFycmF5KAoJCQkJCQknbGFiZWwnID0+ICdUd2VldCBhcnRpY2xlcyBieSBkZWZh
dWx0JywKCQkJCQkJJ3R5cGUnID0+ICd5ZXNub1JhZGlvJywKCQkJCQkJJ3ZhbHVlJyA9PiAk
dHdlZXRfZGVmYXVsdAoJCQkJCSksCgkJCQkJJ2FyY190d2l0dGVyX3VybF9tZXRob2QnID0+
IGFycmF5KAoJCQkJCQknbGFiZWwnID0+ICdVUkwgc2hvcnRuZXInLAoJCQkJCQkndHlwZScg
PT4gJ2FyY190d2l0dGVyX3VybF9tZXRob2Rfc2VsZWN0JywKCQkJCQkJJ3ZhbHVlJyA9PiAk
dXJsX21ldGhvZAoJCQkJCSkKCQkJCSksCgkJCQknVFhQIFR3ZWV0IHNob3J0IFVSTCcgPT4g
YXJyYXkoCgkJCQkJJ2FyY19zaG9ydF91cmwnID0+IGFycmF5KAoJCQkJCQknbGFiZWwnID0+
ICdFbmFibGUgVFhQIFR3ZWV0IHNob3J0IFVSTCByZWRpcmVjdCcsCgkJCQkJCSd0eXBlJyA9
PiAneWVzbm9SYWRpbycsCgkJCQkJCSd2YWx1ZScgPT4gJHNob3J0X3VybAoJCQkJCSksCgkJ
CQkJJ2FyY19zaG9ydF9zaXRlX3VybCcgPT4gYXJyYXkoCgkJCQkJCSdsYWJlbCcgPT4gJ1RY
UCBUd2VldCBzaG9ydCBzaXRlIFVSTCcsCgkJCQkJCSd2YWx1ZScgPT4gJHNob3J0X3NpdGVf
dXJsCgkJCQkJKQoJCQkJKSwKCQkJCSdUd2l0dGVyIFRhYicgPT4gYXJyYXkoCgkJCQkJJ2Fy
Y190d2l0dGVyX3RhYicgPT4gYXJyYXkoCgkJCQkJCSdsYWJlbCcgPT4gJ0xvY2F0aW9uIG9m
IHRhYicsCgkJCQkJCSd0eXBlJyA9PiAnYXJjX3R3aXR0ZXJfdGFiX3NlbGVjdCcsCgkJCQkJ
CSd2YWx1ZScgPT4gJHRhYgoJCQkJCSkKCQkJCSksCgkJCQknQ2FjaGUnID0+IGFycmF5KAoJ
CQkJCSdhcmNfdHdpdHRlcl9jYWNoZV9kaXInID0+IGFycmF5KAoJCQkJCQknbGFiZWwnID0+
ICdDYWNoZSBkaXJlY3RvcnknLAoJCQkJCQkndmFsdWUnID0+ICRjYWNoZV9kaXIKCQkJCQkp
CgkJCQkpCiAgICAgICAgICAgICk7CgogICAgICAgICAgICAkZm9ybSA9ICI8aDI+VHdpdHRl
ciBhY2NvdW50IGRldGFpbHM8L2gyPiIKCQkJCS4iPHA+PHNwYW4gY2xhc3M9J2VkaXQtbGFi
ZWwnPlR3aXR0ZXIgdXNlcm5hbWU8L3NwYW4+IgoJCQkJLiI8c3BhbiBjbGFzcz0nZWRpdC12
YWx1ZSc+IgoJCQkJLigkcHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXSA/ICR1c2VyLicgKCcu
aHJlZignUmUtY29ubmVjdCcsJHJlZ2lzdGVyVVJMKS4nKScgOiAnPGVtPnVua25vd248L2Vt
PicuaHJlZignQ29ubmVjdCB0byBUd2l0dGVyJywkcmVnaXN0ZXJVUkwpKQogICAgICAgICAg
ICAgICAgLiI8L3NwYW4+PC9wPiI7CgogICAgICAgICAgICAkZm9ybSAuPSBfYXJjX3R3aXR0
ZXJfZm9ybV9idWlsZGVyKCRmaWVsZHMpOwoKICAgICAgICAgICAgJGZvcm0gLj0gc0lucHV0
KCdwcmVmc19zYXZlJykubi5lSW5wdXQoJ3BsdWdpbl9wcmVmcy5hcmNfdHdpdHRlcicpOwoK
CQkJJGZvcm0gLj0gJzxwPicuZklucHV0KCdzdWJtaXQnLCAnU3VibWl0JywgZ1R4dCgnc2F2
ZV9idXR0b24nKSwgJ3B1Ymxpc2gnKS4nPC9wPic7CgoJCQkkaHRtbCA9ICI8aDEgY2xhc3M9
J3R4cC1oZWFkaW5nJz5UWFAgVHdlZXQ8L2gxPiIKCQkJCS4iPHAgY2xhc3M9J25hdi10ZXJ0
aWFyeSc+IgoJCQkJLiI8YSBocmVmPScuLz9ldmVudD1hcmNfYWRtaW5fdHdpdHRlcicgY2xh
c3M9J25hdmxpbmsnPlR3aXR0ZXI8L2E+PGEgaHJlZj0nLi8/ZXZlbnQ9cGx1Z2luX3ByZWZz
LmFyY190d2l0dGVyJyBjbGFzcz0nbmF2bGluay1hY3RpdmUnPk9wdGlvbnM8L2E+IgoJCQkJ
LiI8L3A+IjsKCgkJCSRodG1sIC49IGZvcm0oIjxkaXYgY2xhc3M9J3BsdWdpbi1jb2x1bW4n
PiIuJGZvcm0uIjwvZGl2PiIsICIgY2xhc3M9J2VkaXQtZm9ybSciKTsKCiAgICAgICAgfSBl
bHNlaWYgKCAkc3RlcCE9J3JlZ2lzdGVyJyApIHsKCiAgICAgICAgICAgICRyZWdpc3RlclVS
TCA9IGFyY190d2l0dGVyOjpjYWxsYmFja1VSTCgkZXZlbnQsJ3JlZ2lzdGVyJyk7CgogICAg
ICAgICAgICAkZm9ybSA9ICI8aDI+VHdpdHRlciBhY2NvdW50IGRldGFpbHM8L2gyPiIKCQkJ
CS4iPHNwYW4gY2xhc3M9J2VkaXQtbGFiZWwnPlR3aXR0ZXIgdXNlcm5hbWU8L3NwYW4+IgoJ
CQkJLiI8c3BhbiBjbGFzcz0nZWRpdC12YWx1ZSc+PGVtPnVua25vd248L2VtPiAmbWRhc2g7
ICIKCQkJCS5ocmVmKCdDb25uZWN0IHRvIFR3aXR0ZXInLCRyZWdpc3RlclVSTCkKICAgICAg
ICAgICAgICAgIC4iPC9zcGFuPiI7CgoJCQkkaHRtbCA9IGZvcm0oIjxkaXYgY2xhc3M9J3Bs
dWdpbi1jb2x1bW4nPiIuJGZvcm0uIjwvZGl2PiIsICIgY2xhc3M9J2VkaXQtZm9ybSciKTsK
CiAgICAgICAgfQogICAgfQoKICAgIC8vIFNldCBqUXVlcnkgZm9yIHN3aXRjaGluZyBvbi9v
ZmYgcmVsZXZhbnQgYXJjX3Nob3J0X3VybCBmaWVsZHMKICAgICRqcyA9IDw8PEpTCjxzY3Jp
cHQgbGFuZ3VhZ2U9ImphdmFzY3JpcHQiIHR5cGU9InRleHQvamF2YXNjcmlwdCI+CiQoZG9j
dW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCl7CiAgdmFyIG9ub2ZmID0gJCgnLmFyY19zaG9ydF91
cmwnKTsKICB2YXIgYXJjX3Nob3J0X3VybF9vZmYgPSAkKCcjYXJjX3Nob3J0X3VybC1hcmNf
c2hvcnRfdXJsLTAnKTsKICB2YXIgdXJsID0gJCgnLmFyY19zaG9ydF9zaXRlX3VybCcpOwog
IHZhciB1cmxfbWV0aG9kID0gJCgnc2VsZWN0W25hbWU9ImFyY190d2l0dGVyX3VybF9tZXRo
b2QiXScpOwoKICBpZiAoYXJjX3Nob3J0X3VybF9vZmYuYXR0cignY2hlY2tlZCcpPT0nY2hl
Y2tlZCcgJiYgJCgnb3B0aW9uOnNlbGVjdGVkJywgdXJsX21ldGhvZCkudmFsKCkhPSdhcmNf
dHdpdHRlcicpIHsKICAgIHVybC5oaWRlKCk7CiAgfQogICQoJ2lucHV0Jywgb25vZmYpLmNo
YW5nZShmdW5jdGlvbigpewogICAgaWYgKCQoJ29wdGlvbjpzZWxlY3RlZCcsIHVybF9tZXRo
b2QpLnZhbCgpIT0nYXJjX3R3aXR0ZXInKSB7CiAgICAgIGFyY19zaG9ydF91cmxfb2ZmLmF0
dHIoJ2NoZWNrZWQnKT09J2NoZWNrZWQnID8gdXJsLmhpZGUoKSA6IHVybC5zaG93KCk7CiAg
ICB9CiAgfSk7CgogIGlmICgkKCdvcHRpb246c2VsZWN0ZWQnLCB1cmxfbWV0aG9kKS52YWwo
KT09J2FyY190d2l0dGVyJykgewogICAgb25vZmYuaGlkZSgpOyB1cmwuc2hvdygpOwogIH0K
ICB1cmxfbWV0aG9kLmNoYW5nZShmdW5jdGlvbigpewogICAgaWYgKCQoJ29wdGlvbjpzZWxl
Y3RlZCcsIHVybF9tZXRob2QpLnZhbCgpPT0nYXJjX3R3aXR0ZXInKSB7CiAgICAgIG9ub2Zm
LnRvZ2dsZSgpOyB1cmwuc2hvdygpOwogICAgfSBlbHNlIHsKICAgICAgb25vZmYudG9nZ2xl
KCk7CiAgICAgIGFyY19zaG9ydF91cmxfb2ZmLmF0dHIoJ2NoZWNrZWQnKT09J2NoZWNrZWQn
ID8gdXJsLmhpZGUoKSA6IHVybC5zaG93KCk7CiAgICB9CiAgfSkKfSk7Cjwvc2NyaXB0PgpK
UzsKCiAgICBlY2hvICRqcy4kaHRtbDsKfQoKZnVuY3Rpb24gX2FyY190d2l0dGVyX2Zvcm1f
YnVpbGRlcigkZmllbGRzKSB7CgoJJGZvcm0gPSAnJzsKCglmb3JlYWNoICgkZmllbGRzIGFz
ICRmayA9PiAkZnYpIHsKCgkJJGZvcm0gLj0gKCRmaykgPyAiPGgyPiRmazwvaDI+IiA6ICcn
OwoKCQlmb3JlYWNoICgkZnYgYXMgJGsgPT4gJHYpIHsKCgkJCSR0eXBlID0gaXNzZXQoJHZb
J3R5cGUnXSkgPyAkdlsndHlwZSddIDogJ3RleHQnOwoKCQkJJGZvcm0gLj0gIjxwIGNsYXNz
PSckayc+IgoJCQkJLiI8c3BhbiBjbGFzcz0nZWRpdC1sYWJlbCc+PGxhYmVsIGZvcj0nJGsn
PiIuJHZbJ2xhYmVsJ10uIjwvbGFiZWw+PC9zcGFuPiI7CgoJCQlzd2l0Y2ggKCR0eXBlKSAg
ewoKCQkJCWNhc2UgJ3RleHRhcmVhJzoKCgkJCQkJJGZvcm0gLj0gdGV4dF9hcmVhKCRrLCAn
NTAnLCAnNTUwJywgJHZbJ3ZhbHVlJ10sICRrKTsKCQkJCQlicmVhazsKCgkJCQljYXNlICd5
ZXNub1JhZGlvJzoKCgkJCQkJJGZvcm0gLj0gIjxzcGFuIGNsYXNzPSdlZGl0LXZhbHVlJz4i
Lnllc25vUmFkaW8oJGssICR2Wyd2YWx1ZSddLCAnJywgJGspLiI8L3NwYW4+IjsKCQkJCQli
cmVhazsKCgkJCQljYXNlICdhcmNfdHdpdHRlcl90YWJfc2VsZWN0JzoKCgkJCQkJJGZvcm0g
Lj0gIjxzcGFuIGNsYXNzPSdlZGl0LXZhbHVlJz4iLmFyY190d2l0dGVyX3RhYl9zZWxlY3Qo
JGssICR2Wyd2YWx1ZSddKS4iPC9zcGFuPiI7CgkJCQkJYnJlYWs7CgoJCQkJY2FzZSAnYXJj
X3R3aXR0ZXJfdXJsX21ldGhvZF9zZWxlY3QnOgoKCQkJCQkkZm9ybSAuPSAiPHNwYW4gY2xh
c3M9J2VkaXQtdmFsdWUnPiIuYXJjX3R3aXR0ZXJfdXJsX21ldGhvZF9zZWxlY3QoJGssICR2
Wyd2YWx1ZSddKS4iPC9zcGFuPiI7CgkJCQkJYnJlYWs7CgoJCQkJZGVmYXVsdDoKCgkJCQkJ
JGZvcm0gLj0gIjxzcGFuIGNsYXNzPSdlZGl0LXZhbHVlJz4iLmZJbnB1dCgndGV4dCcsJGss
JHZbJ3ZhbHVlJ10sJycsJycsJycsJycsJycsJGspLiI8L3NwYW4+IjsKCQkJCQlicmVhazsK
CgkJCX0KCgkJCSRmb3JtIC49ICI8L3A+IjsKCQl9CgoJfQoKCXJldHVybiAkZm9ybTsKfQoK
Ly8gQWRkIFR3aXR0ZXIgdGFiIHRvIFRleHRwYXR0ZXJuCmZ1bmN0aW9uIGFyY19hZG1pbl90
d2l0dGVyKCRldmVudCwkc3RlcCkKewogICAgZ2xvYmFsICRwcmVmcywgJGFyY190d2l0dGVy
X2NvbnN1bWVyS2V5LCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQ7CgogICAgJHR3aXQg
PSBuZXcgYXJjX3R3aXR0ZXIoJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5CiAgICAgICAgICAg
ICwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0LCAkcHJlZnNbJ2FyY190d2l0dGVyX2Fj
Y2Vzc1Rva2VuJ10KICAgICAgICAgICAgLCAkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rv
a2VuU2VjcmV0J10pOwoKICAgICR0d2l0LT5jYWNoZURpcigkcHJlZnNbJ2FyY190d2l0dGVy
X2NhY2hlX2RpciddKTsKCiAgICAkeG1sID0gJHR3aXQtPmdldCgndXNlcnMvc2hvdycKICAg
ICAgICAsIGFycmF5KCdzY3JlZW5fbmFtZSc9PiRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlcidd
KSk7CiAgICAkdHdpdHRlclVzZXIgPSBAJHhtbC0+eHBhdGgoJy91c2VyJyk7CiAgICAkdHdp
dHRlclVzZXIgPSAkdHdpdHRlclVzZXJbMF07CiAgICAkdHdpdHRlclVzZXJVUkwgPSAnaHR0
cDovL3d3dy50d2l0dGVyLmNvbS8nLiR0d2l0dGVyVXNlci0+c2NyZWVuX25hbWU7CgogICAg
aWYgKCRzdGVwPT0idHdlZXQiKSB7IC8vIHBvc3QgYW4gdXBkYXRlIHRvIFR3aXR0ZXIKCiAg
ICAgICAgLy8gZmV0Y2ggYW5kIGNsZWFuIG1lc3NhZ2UKICAgICAgICAkbWVzc2FnZSA9IHN0
cmlwX3RhZ3MoZ3BzKCdtZXNzYWdlJykpOwogICAgICAgICRjb3VudCA9IHN0cmxlbigkbWVz
c2FnZSk7CgogICAgICAgIGlmICgkY291bnQ8PTE0MCAmJiAkY291bnQ+MCkgeyAvLyBwb3N0
IHVwZGF0ZQogICAgICAgICAgICAkcmVzdWx0ID0gJHR3aXQtPnBvc3QoJ3N0YXR1c2VzL3Vw
ZGF0ZScsIGFycmF5KCdzdGF0dXMnID0+ICRtZXNzYWdlKSk7CiAgICAgICAgfSBlbHNlIHsg
Ly8gbWVzc2FnZSB0b28gbG9uZywgSmF2YVNjcmlwdCBpbnRlcmZhY2Ugc2hvdWxkIHByZXZl
bnQgdGhpcwogICAgICAgICAgICAkcmVzdWx0ID0gZmFsc2U7CiAgICAgICAgfQoKICAgICAg
ICBwYWdldG9wKCdUd2l0dGVyJywKICAgICAgICAgICAgKCgkcmVzdWx0IT1mYWxzZSk/J1R3
aXR0ZXIgdXBkYXRlZCc6J0Vycm9yIHVwZGF0aW5nIFR3aXR0ZXInKSk7CgogICAgfSBlbHNl
aWYgKCRzdGVwPT0iZGVsZXRlIikgeyAvLyBkZWxldGUgYW4gdXBkYXRlIGZyb20gVHdpdHRl
cgoKICAgICAgICAkaWQgPSBzdHJpcF90YWdzKGdwcygnaWQnKSk7CiAgICAgICAgaWYgKCRp
ZCkgewogICAgICAgICAgICAkdHdpdC0+ZGVsZXRlKCdzdGF0dXNlcy9kZXN0cm95Jy4kaWQp
OwogICAgICAgICAgICBzYWZlX2RlbGV0ZSgnYXJjX3R3aXR0ZXInLCJ0d2VldF9pZCA9ICRp
ZCIpOwogICAgICAgIH0KCiAgICAgICAgcGFnZXRvcCgnVHdpdHRlcicsJ1R3aXR0ZXIgdXBk
YXRlZCcpOwoKICAgIH0gZWxzZSB7CgogICAgICAgIHBhZ2V0b3AoJ1R3aXR0ZXInKTsKCiAg
ICB9CgogICAgLy8gUHJlcGFyZSBKYXZhU2NyaXB0IHRvIGNyZWF0ZSBUd2l0dGVyIHVwZGF0
ZSBpbnRlcmZhY2UKCiAgICAkanMgPSAnPHNjcmlwdCBsYW5ndWFnZT0iamF2YXNjcmlwdCIg
dHlwZT0idGV4dC9qYXZhc2NyaXB0Ij4nOwogICAgJGpzLj0gPDw8SlMKICAgICQoZG9jdW1l
bnQpLnJlYWR5KGZ1bmN0aW9uKCl7CgkJdmFyIGNvdW50ZXIgPSAkKCc8c3Bhbj4nLCB7CgkJ
CQkndGV4dCcgOiAnMTQwJywKCQkJCSdpZCcgOiAndHdlZXRjb3VudCcKCQkJfSk7CgkJJCgn
Lm1lc3NhZ2UnKS5hcHBlbmQoY291bnRlcik7CiAgICAgICAgICAgIHZhciBjb3VudGVyU3R5
bGUgPSAnZm9udC13ZWlnaHQ6Ym9sZDtwYWRkaW5nLWxlZnQ6LjVlbTtmb250LXNpemU6MmVt
O2xpbmUtaGVpZ2h0OjEuMmVtOyc7CiAgICAgICAgICAgICQoJyN0d2VldGNvdW50JykuYXR0
cignc3R5bGUnLCBjb3VudGVyU3R5bGUrJ2NvbG9yOiNjY2M7Jyk7CiAgICAgICAgICAgICQo
JyNtZXNzYWdlJykua2V5dXAoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICB2YXIgY291
bnQgPSAxNDAtJCgnI21lc3NhZ2UnKS52YWwoKS5sZW5ndGg7CiAgICAgICAgICAgICAgICAk
KCcjdHdlZXRjb3VudCcpLmh0bWwoY291bnQrJycpOyAvLyBoYWNrIHRvIGZvcmNlIG91dHB1
dCBvZiAwCiAgICAgICAgICAgICAgICBpZiAoY291bnQ8MCkgewogICAgICAgICAgICAgICAg
ICAgICQoJ2lucHV0LnB1Ymxpc2gnKS5wcm9wKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcpOwog
ICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAkKCdpbnB1dC5w
dWJsaXNoJykucHJvcCgnZGlzYWJsZWQnLCAnJyk7CiAgICAgICAgICAgICAgICB9CiAgICAg
ICAgICAgICAgICBpZiAoY291bnQ8MCkgewogICAgICAgICAgICAgICAgICAgICQoJyN0d2Vl
dGNvdW50JykuYXR0cignc3R5bGUnLCBjb3VudGVyU3R5bGUrJ2NvbG9yOiNmMDA7Jyk7CiAg
ICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNvdW50PDEwKSB7CiAgICAgICAgICAgICAgICAg
ICAgJCgnI3R3ZWV0Y291bnQnKS5hdHRyKCdzdHlsZScsIGNvdW50ZXJTdHlsZSsnY29sb3I6
IzAwMDsnKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAg
JCgnI3R3ZWV0Y291bnQnKS5hdHRyKCdzdHlsZScsIGNvdW50ZXJTdHlsZSsnY29sb3I6I2Nj
YzsnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkKICAgICAgICB9KTsKSlM7
CiAgICAkanMuPSAiPC9zY3JpcHQ+IjsKCiAgICAkb3V0ID0gJyc7CiAgICAkeG1sID0gJHR3
aXQtPmdldCgnc3RhdHVzZXMvdXNlcl90aW1lbGluZScKICAgICAgICAsIGFycmF5KCdzY3Jl
ZW5fbmFtZSc9PiRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddLCdjb3VudCc9PjI1KSk7CiAg
ICAkdHdlZXRzID0gQCR4bWwtPnhwYXRoKCcvc3RhdHVzZXMvc3RhdHVzJyk7CiAgICBpZiAo
JHR3ZWV0cykgZm9yZWFjaCAoJHR3ZWV0cyBhcyAkdHdlZXQpIHsKICAgICAgICAkdGltZSA9
IHN0cnRvdGltZShodG1sZW50aXRpZXMoJHR3ZWV0LT5jcmVhdGVkX2F0KSk7CiAgICAgICAg
JGRhdGUgPSBzYWZlX3N0cmZ0aW1lKCRwcmVmc1snYXJjaGl2ZV9kYXRlZm9ybWF0J10sJHRp
bWUpOwogICAgICAgICRvdXQuPSB0cih0ZCgkZGF0ZSwnc3BhbicpCiAgICAgICAgICAgIC50
ZChhcmNfVHdpdHRlcjo6bWFrZUxpbmtzKGh0bWxlbnRpdGllcygkdHdlZXQtPnRleHQKICAg
ICAgICAgICAgICAgICwgRU5UX1FVT1RFUywnVVRGLTgnKSkpCiAgICAgICAgICAgIC50ZChk
TGluaygnYXJjX2FkbWluX3R3aXR0ZXInLCdkZWxldGUnLCdpZCcsJHR3ZWV0LT5pZCwnJykp
CiAgICAgICAgICAgICk7CiAgICB9CgogICAgJGZpZWxkcyA9IGFycmF5KAoJCScnID0+IGFy
cmF5KAoJCQknbWVzc2FnZScgPT4gYXJyYXkoCgkJCQknbGFiZWwnID0+ICdVcGRhdGUgVHdp
dHRlcicsCgkJCQkndHlwZScgPT4gJ3RleHRhcmVhJywKCQkJCSd2YWx1ZScgPT4gJycKCQkJ
KQoJCSkKICAgICk7CgogICAgJHByb2ZpbGUgPSAnPGltZyBzcmM9IicuJHR3aXR0ZXJVc2Vy
LT5wcm9maWxlX2ltYWdlX3VybC4nIiBhbHQ9IlR3aXR0ZXIgYXZhdGFyIiBzdHlsZT0iZmxv
YXQ6bGVmdDsgbWFyZ2luLXJpZ2h0OiAxZW0iIC8+JwoJCS5ncmFmKGhyZWYoJHR3aXR0ZXJV
c2VyLT5uYW1lLCR0d2l0dGVyVXNlclVSTCksJyBzdHlsZT0iZm9udC1zaXplOjEuMmVtO2Zv
bnQtd2VpZ2h0OmJvbGQ7IicpCgkJLmdyYWYoaHJlZigkdHdpdHRlclVzZXItPmZyaWVuZHNf
Y291bnQuJyBmb2xsb3dpbmcnLCR0d2l0dGVyVXNlclVSTC4nL2ZvbGxvd2luZycpCgkJLics
ICcuaHJlZigkdHdpdHRlclVzZXItPmZvbGxvd2Vyc19jb3VudC4nIGZvbGxvd2VycycsJHR3
aXR0ZXJVc2VyVVJMLicvZm9sbG93ZXJzJykKCQkuJywgJy5ocmVmKCR0d2l0dGVyVXNlci0+
c3RhdHVzZXNfY291bnQuJyB1cGRhdGVzJywkdHdpdHRlclVzZXJVUkwpKTsKCiAgICAkZm9y
bSA9IF9hcmNfdHdpdHRlcl9mb3JtX2J1aWxkZXIoJGZpZWxkcykKCQkuZUlucHV0KCdhcmNf
YWRtaW5fdHdpdHRlcicpCgkJLnNJbnB1dCgndHdlZXQnKTsKCSRmb3JtIC49ICc8cD4nLmZJ
bnB1dCgnc3VibWl0JywgJ1N1Ym1pdCcsIGdUeHQoJ1VwZGF0ZScpLCAncHVibGlzaCcpLic8
L3A+JzsKCgkkaHRtbCA9ICI8aDEgY2xhc3M9J3R4cC1oZWFkaW5nJz5UWFAgVHdlZXQ8L2gx
PiIKCQkuIjxwIGNsYXNzPSduYXYtdGVydGlhcnknPiIKCQkuIjxhIGhyZWY9Jy4vP2V2ZW50
PWFyY19hZG1pbl90d2l0dGVyJyBjbGFzcz0nbmF2bGluay1hY3RpdmUnPlR3aXR0ZXI8L2E+
PGEgaHJlZj0nLi8/ZXZlbnQ9cGx1Z2luX3ByZWZzLmFyY190d2l0dGVyJyBjbGFzcz0nbmF2
bGluayc+T3B0aW9uczwvYT4iCgkJLiI8L3A+IjsKCiAgICAkaHRtbCAuPSAiPGRpdiBjbGFz
cz0ndGV4dC1jb2x1bW4nPiIuJHByb2ZpbGUuIjwvZGl2PiIKCQkuIjxiciBzdHlsZT0nY2xl
YXI6Ym90aCcgLz4iCgkJLmZvcm0oIjxkaXYgY2xhc3M9J3BsdWdpbi1jb2x1bW4nPiIuJGZv
cm0uIjwvZGl2PiIuYnIpOwoKICAgIC8vIEF0dGFjaCByZWNlbnQgVHdpdHRlciB1cGRhdGVz
CgogICAgJGh0bWwuPSAiPGRpdiBjbGFzcz0ndHhwLWxpc3R0YWJsZXMnPiIKCQkuc3RhcnRU
YWJsZSgnYXJjX3R3aXR0ZXJfdGltZWxpbmUnLCcnLCd0eHAtbGlzdCcpLiRvdXQuZW5kVGFi
bGUoKQoJCS4iPC9kaXY+IjsKCiAgICAvLyBPdXRwdXQgSmF2YVNjcmlwdCBhbmQgSFRNTAoK
ICAgIGVjaG8gJGpzLiRodG1sOwp9CgovLyBBZGQgVHdpdHRlciBvcHRpb25zIHRvIGFydGlj
bGUgYXJ0aWNsZSBzY3JlZW4KZnVuY3Rpb24gYXJjX2FwcGVuZF90d2l0dGVyKCRldmVudCwg
JHN0ZXAsICRkYXRhLCAkcnMxKQp7CiAgICBnbG9iYWwgJHByZWZzLCAkYXJjX3R3aXR0ZXIs
ICRhcHBfbW9kZTsKCiAgICAkcHJlZml4ID0gdHJpbShncHMoJ2FyY190d2l0dGVyX3ByZWZp
eCcpKTsKICAgICRwcmVmaXggPSAoJHByZWZpeCkgPyAkcHJlZml4IDogJHByZWZzWydhcmNf
dHdpdHRlcl9wcmVmaXgnXTsKICAgICRzdWZmaXggPSB0cmltKGdwcygnYXJjX3R3aXR0ZXJf
c3VmZml4JykpOwogICAgJHN1ZmZpeCA9ICgkc3VmZml4KSA/ICRzdWZmaXggOiAkcHJlZnNb
J2FyY190d2l0dGVyX3N1ZmZpeCddOwoKICAgIGlmICgkcnMxWydJRCddKSB7CiAgICAgICAg
JHNxbCA9ICJTRUxFQ1QgdHdlZXRfaWQsdHdlZXQgRlJPTSAiLlBGWC4iYXJjX3R3aXR0ZXIg
V0hFUkUgYXJ0aWNsZV9pZD0iLiRyczFbJ0lEJ10uIjsiOwogICAgICAgICRyczIgPSBzYWZl
X3F1ZXJ5KCRzcWwpOyAkcnMyID0gbmV4dFJvdygkcnMyKTsKICAgIH0gZWxzZSB7IC8vIG5l
dyBhcnRpY2xlCiAgICAgICAgJHJzMiA9ICcnOwogICAgfQoKICAgIGlmICgkYXBwX21vZGUg
PT0gJ2FzeW5jJykKICAgIHsKCQkgc2VuZF9zY3JpcHRfcmVzcG9uc2UoJyQoIiNhcmNfdHdp
dHRlciIpLnJlbW92ZSgpOycpOwoJCX0KCiAgICBpZiAoJHJzMVsnSUQnXSAmJiAkcnMyWyd0
d2VldF9pZCddKSB7CiAgICAgICAgJGNvbnRlbnQgPSB0YWcoYXJjX1R3aXR0ZXI6Om1ha2VM
aW5rcygkcnMyWyd0d2VldCddKSwncCcpOwogICAgICAgIHJldHVybiAkZGF0YS5maWVsZHNl
dCgkY29udGVudCwgJ1R3aXR0ZXIgdXBkYXRlJywgJ2FyY190d2l0dGVyJyk7CiAgICB9IGVs
c2UgewogICAgICAgICR2YXIgPSBncHMoJ2FyY190d2VldF90aGlzJyk7CiAgICAgICAgJHZh
ciA9ICgkcnMxWydJRCddJiYhJHZhcikgPyAwIDogJHByZWZzWydhcmNfdHdpdHRlcl90d2Vl
dF9kZWZhdWx0J107CiAgICAgICAgJGNvbnRlbnQgID0gdGFnKHllc25vUmFkaW8oJ2FyY190
d2VldF90aGlzJywgJHZhciwgJycsICdhcmNfdHdlZXRfdGhpcycpLCdwJyk7CiAgICAgICAg
JGNvbnRlbnQgLj0gdGFnKGhyZWYoJ09wdGlvbnMnLCcjYXJjX3R3aXR0ZXJfb3B0aW9ucycs
ICcgb25jbGljaz0iJChcJyNhcmNfdHdpdHRlcl9vcHRpb25zXCcpLnRvZ2dsZSgpOyByZXR1
cm4gZmFsc2U7IicpLCdwJywnIHN0eWxlPSJtYXJnaW4tdG9wOjVweDsiJyk7CiAgICAgICAg
JGNvbnRlbnQgLj0gdGFnKHRhZyh0YWcoJ1R3ZWV0IHByZWZpeCcsJ2xhYmVsJywgJyBmb3I9
ImFyY190d2l0dGVyX3ByZWZpeCInKQogICAgICAgICAgICAuZklucHV0KCd0ZXh0JywnYXJj
X3R3aXR0ZXJfcHJlZml4JywkcHJlZml4LCdlZGl0JywnJywnJywnMjInLCcnLCdhcmNfdHdp
dHRlcl9wcmVmaXgnKSwncCcpCiAgICAgICAgICAgIC50YWcodGFnKCdUd2VldCBzdWZmaXgg
KGVnICNoYXNodGFncyknLCdsYWJlbCcsICcgZm9yPSJhcmNfdHdpdHRlcl9zdWZmaXgiJykK
ICAgICAgICAgICAgLmZJbnB1dCgndGV4dCcsJ2FyY190d2l0dGVyX3N1ZmZpeCcsJHN1ZmZp
eCwnZWRpdCcsJycsJycsJzIyJywnJywnYXJjX3R3aXR0ZXJfc3VmZml4JyksJ3AnKQogICAg
ICAgICAgICAsJ2RpdicsJyBpZD0iYXJjX3R3aXR0ZXJfb3B0aW9ucyIgY2xhc3M9InRvZ2ds
ZSIgc3R5bGU9ImRpc3BsYXk6bm9uZSInKTsKICAgICAgICBpZiAoaXNzZXQoJGFyY190d2l0
dGVyWydlcnJvciddKSkgewogICAgICAgICAgICAkY29udGVudCAuPSAnPHA+Jy4kYXJjX3R3
aXR0ZXJbJ2Vycm9yJ10uJzwvcD4nOwogICAgICAgIH0KICAgICAgICByZXR1cm4gJGRhdGEu
ZmllbGRzZXQoJGNvbnRlbnQsICdVcGRhdGUgVHdpdHRlcicsICdhcmNfdHdpdHRlcicpOwog
ICAgfQoKfQoKLy8gVXBkYXRlIFR3aXR0ZXIgd2l0aCBwb3N0ZWQgYXJ0aWNsZQpmdW5jdGlv
biBhcmNfYXJ0aWNsZV90d2VldCgkZXZlbnQsJHN0ZXApCnsKICAgIGdsb2JhbCAkcHJlZnMs
ICRhcmNfdHdpdHRlciwgJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5CiAgICAgICAgLCAkYXJj
X3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQ7CgogICAgJGFydGljbGVfaWQgPSBlbXB0eSgkR0xP
QkFMU1snSUQnXSkgPyBncHMoJ0lEJykgOiAkR0xPQkFMU1snSUQnXTsKICAgIGlmICghZW1w
dHkoJGFydGljbGVfaWQpKSB7CgogICAgICAgIGluY2x1ZGVfb25jZSB0eHBhdGguJy9wdWJs
aXNoL3RhZ2hhbmRsZXJzLnBocCc7CgogICAgICAgICRhcnRpY2xlID0gc2FmZV9yb3coIklE
LCBUaXRsZSwgU2VjdGlvbiwgUG9zdGVkIiwgJ3RleHRwYXR0ZXJuJywKICAgICAgICAgICAg
IklEPXskYXJ0aWNsZV9pZH0gQU5EIFN0YXR1cz00IEFORCBub3coKT49UG9zdGVkIik7Cgog
ICAgICAgIGlmICgkYXJ0aWNsZSAmJiBncHMoJ2FyY190d2VldF90aGlzJykpIHsgLy8gdHdl
ZXQgYXJ0aWNsZQoKICAgICAgICAgICAgLy8gTmVlZCB0byBtYW51YWxseSB1cGRhdGUgdGhl
ICdVUkwgb25seSB0aXRsZScgYmVmb3JlIGJ1aWxkaW5nIHRoZQogICAgICAgICAgICAvLyBV
UkwKICAgICAgICAgICAgJGFydGljbGVbJ3VybF90aXRsZSddID0gZ3BzKCd1cmxfdGl0bGUn
KTsKICAgICAgICAgICAgLy8gTWFrZSBzaG9ydCBVUkwKICAgICAgICAgICAgJHVybCA9IHBl
cm1saW5rdXJsKCRhcnRpY2xlKTsKICAgICAgICAgICAgJHNob3J0X3VybCA9IGFyY19zaG9y
dGVuX3VybCgkdXJsLCRwcmVmc1snYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCddLAogICAgICAg
ICAgICAgICAgYXJyYXkoJ2lkJz0+JGFydGljbGVfaWQpKTsKCiAgICAgICAgICAgIGlmICgh
JHNob3J0X3VybCkgeyAvLyBGYWlsZWQgdG8gb2J0YWluIGEgc2hvcnRlbmVkIFVSTCwgZG8g
bm90IHR3ZWV0IQogICAgICAgICAgICAgICAgJGFyY190d2l0dGVyWydlcnJvciddID0gJ1Vu
YWJsZSB0byBvYnRhaW4gYSBzaG9ydCBVUkwgZm9yIHRoaXMgYXJ0aWNsZS4nOwoKICAgICAg
ICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8g
Q29uc3RydWN0IFR3aXR0ZXIgdXBkYXRlCiAgICAgICAgICAgICRwcmVmaXggID0gdHJpbShn
cHMoJ2FyY190d2l0dGVyX3ByZWZpeCcpKTsKICAgICAgICAgICAgJHByZV9sZW4gPSBzdHJs
ZW4oJHByZWZpeCk7CiAgICAgICAgICAgICRwcmVmaXggID0gKCRwcmVmaXggJiYgJHByZV9s
ZW48PTIwKSA/ICRwcmVmaXguJyAnIDogJyc7CiAgICAgICAgICAgICRzdWZmaXggID0gdHJp
bShncHMoJ2FyY190d2l0dGVyX3N1ZmZpeCcpKTsKICAgICAgICAgICAgJHN1Zl9sZW4gPSBz
dHJsZW4oJHN1ZmZpeCk7CiAgICAgICAgICAgICRzdWZmaXggID0gKCRzdWZmaXggJiYgJHN1
Zl9sZW48PTQwKSA/ICcgJy4kc3VmZml4IDogJyc7CiAgICAgICAgICAgICR1cmxfbGVuID0g
c3RybGVuKCRzaG9ydF91cmwpKzE7IC8vIGNvdW50IFVSTCBsZW5ndGggKyAxIGZvciBwcmVm
aXhlZCBzcGFjZQogICAgICAgICAgICBpZiAoJHByZWZpeCkgJHByZV9sZW4gKz0gMTsKICAg
ICAgICAgICAgaWYgKCRzdWZmaXgpICRzdWZfbGVuICs9IDE7CiAgICAgICAgICAgIGlmICgo
c3RybGVuKCRhcnRpY2xlWydUaXRsZSddKSskdXJsX2xlbiskcHJlX2xlbiskc3VmX2xlbik+
MTQwKSB7CiAgICAgICAgICAgICAgICAkYXJ0aWNsZVsnVGl0bGUnXSA9IHN1YnN0cigkYXJ0
aWNsZVsnVGl0bGUnXSwwLDEzNS0kdXJsX2xlbi0kcHJlX2xlbi0kc3VmX2xlbikuJy4uLic7
CiAgICAgICAgICAgIH0KICAgICAgICAgICAgJHR3ZWV0ID0gJHByZWZpeC4kYXJ0aWNsZVsn
VGl0bGUnXS4iICIuJHNob3J0X3VybC4kc3VmZml4OwoKICAgICAgICAgICAgLy8gVXBkYXRl
IFR3aXR0ZXIKICAgICAgICAgICAgJHR3aXQgPSBuZXcgYXJjX3R3aXR0ZXIoJGFyY190d2l0
dGVyX2NvbnN1bWVyS2V5CiAgICAgICAgICAgICAgICAsICRhcmNfdHdpdHRlcl9jb25zdW1l
clNlY3JldCwgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlbiddCiAgICAgICAgICAg
ICAgICAsICRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW5TZWNyZXQnXSk7CiAgICAg
ICAgICAgICRyZXN1bHQgPSAkdHdpdC0+cG9zdCgnc3RhdHVzZXMvdXBkYXRlJywgYXJyYXko
J3N0YXR1cycgPT4gJHR3ZWV0KSk7CgogICAgICAgICAgICAkdHdlZXRfaWQgPSAoaXNfb2Jq
ZWN0KCRyZXN1bHQpKSA/ICRyZXN1bHRbMF0tPmlkIDogMDsKCiAgICAgICAgICAgIGlmICgk
dHdlZXRfaWQpIHsKCiAgICAgICAgICAgICAgICAkdHdlZXQgPSBhZGRzbGFzaGVzKCR0d2Vl
dCk7CgogICAgICAgICAgICAgICAgLy8gdXBkYXRlIGFyY190d2l0dGVyIHRhYmxlIHdpdGgg
dHdlZXQKICAgICAgICAgICAgICAgICRzcWwgPSAiSU5TRVJUIElOVE8gIi5QRlguImFyY190
d2l0dGVyIChhcnRpY2xlX2lkLHR3ZWV0X2lkLHR3ZWV0LHRpbnl1cmwpICI7CiAgICAgICAg
ICAgICAgICAkc3FsLj0gIlZBTFVFUygkYXJ0aWNsZV9pZCwkdHdlZXRfaWQsXCIkdHdlZXRc
IiwnJHNob3J0X3VybCcpOyI7CiAgICAgICAgICAgICAgICBzYWZlX3F1ZXJ5KCRzcWwpOwoK
ICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwoKICAgICAgICAgICAgfSBlbHNlIHsKCiAg
ICAgICAgICAgICAgICAkYXJjX3R3aXR0ZXJbJ2Vycm9yJ10gPSAnVHdpdHRlciByZXNwb25z
ZTogJwogICAgICAgICAgICAgICAgICAgIC4kdHdpdC0+aHR0cF9jb2RlOwogICAgICAgICAg
ICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICAgICAgfQoKICAgICAgICB9CgogICAgfQoK
ICAgIHJldHVybiBmYWxzZTsKCn0KCi8qCiAqIFNob3J0ZW4gVVJMcyB1c2luZyB2YXJpb3Vz
IG1ldGhvZHMKICovCgpmdW5jdGlvbiBhcmNfc2hvcnRlbl91cmwoJHVybCwgJG1ldGhvZD0n
JywgJGF0dHM9YXJyYXkoKSkKewogIGdsb2JhbCAkcHJlZnM7CgogICRjaCA9IGN1cmxfaW5p
dCgpOwogIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9IRUFERVIsIDApOwogIGN1cmxfc2V0
b3B0KCRjaCwgQ1VSTE9QVF9SRVRVUk5UUkFOU0ZFUiwgdHJ1ZSk7CiAgY3VybF9zZXRvcHQo
JGNoLCBDVVJMT1BUX1RJTUVPVVQsIDEwKTsKCiAgc3dpdGNoICgkbWV0aG9kKSB7CiAgICBj
YXNlICdzbWQnOiAvLyBjcmVhdGUgYSBzaG9ydGVuZWQgVVJMIHVzaW5nIFNNRCBTaG9ydCBV
UkwKICAgICAgcmV0dXJuICgkYXR0c1snaWQnXSkgPyBodS4kYXR0c1snaWQnXSA6IGZhbHNl
OyBicmVhazsKICAgIGNhc2UgJ2FyY190d2l0dGVyJzogLy8gbmF0aXZlIFVSTCBzaG9ydGVu
aW5nCgogICAgICByZXR1cm4gKCRhdHRzWydpZCddKSA/IFBST1RPQ09MLiRwcmVmc1snYXJj
X3Nob3J0X3NpdGVfdXJsJ10uJy8nLiRhdHRzWydpZCddIDogZmFsc2U7CiAgICAgIGJyZWFr
OwoKICAgIGNhc2UgJ2lzZ2QnOgoKICAgICAgJHUgPSAnaHR0cDovL2lzLmdkL2FwaS5waHA/
bG9uZ3VybD0nLnVybGVuY29kZSgkdXJsKTsKICAgICAgY3VybF9zZXRvcHQoJGNoLCBDVVJM
T1BUX1VSTCwgJHUpOwoKICAgICAgJHRpbnl1cmwgPSBjdXJsX2V4ZWMoJGNoKTsKICAgICAg
aWYgKCR0aW55dXJsIT0nRXJyb3InICYmICR0aW55dXJsIT0nJykgewogICAgICAgIHJldHVy
biAkdGlueXVybDsKICAgICAgfSBlbHNlIHsKICAgICAgICB0cmlnZ2VyX2Vycm9yKCdhcmNf
dHdpdHRlciBmYWlsZWQgdG8gZ2V0IGEgaXMuZ2QgVVJMIGZvciAnCiAgICAgICAgICAgIC4k
dXJsLEVfVVNFUl9XQVJOSU5HKTsKICAgICAgfQogICAgICBicmVhazsKCiAgICBjYXNlICd0
aW55dXJsJzogZGVmYXVsdDogLy8gY3JlYXRlIGEgc2hvcnRlbmVkIFVSTCB1c2luZyBUaW55
VVJMCgogICAgICAkdSA9ICdodHRwOi8vdGlueXVybC5jb20vYXBpLWNyZWF0ZS5waHA/dXJs
PScudXJsZW5jb2RlKCR1cmwpOwogICAgICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfVVJM
LCAkdSk7CiAgICAgICR0aW55dXJsID0gY3VybF9leGVjKCRjaCk7CiAgICAgIGlmICgkdGlu
eXVybCE9J0Vycm9yJyAmJiAkdGlueXVybCE9JycpIHsKICAgICAgICByZXR1cm4gJHRpbnl1
cmw7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdHJpZ2dlcl9lcnJvcignYXJjX3R3aXR0ZXIg
ZmFpbGVkIHRvIGdldCBhIFRpbnlVUkwgZm9yICcuJHVybCxFX1VTRVJfV0FSTklORyk7CiAg
ICAgIH0KCiAgfQoKICByZXR1cm4gZmFsc2U7IC8vIGZhaWwKCn0KCi8qCiAqIFNob3J0ZW5l
ZCBVUkwgcmVkaXJlY3QgYmFzZWQgb24gc21kX3Nob3J0X3VybAogKi8KZnVuY3Rpb24gYXJj
X3Nob3J0X3VybF9yZWRpcmVjdCgkZXZlbnQsICRzdGVwKSB7CiAgZ2xvYmFsICRwcmVmczsK
CiAgJGhhdmVfaWQgPSAwOwoKICAvLyBDaGVjayBpZiB0aGVyZSBpcyBhbiBhdmFpbGFibGUg
c2hvcnQgc2l0ZSB1cmwgYW5kIGlmIGl0IGlzIGJlaW5nIHVzZWQgaW4KICAvLyB0aGlzIGlu
c3RhbmNlCiAgJHNob3J0X3NpdGVfdXJsID0gJHByZWZzWydhcmNfc2hvcnRfc2l0ZV91cmwn
XTsKICBpZiAoJHNob3J0X3NpdGVfdXJsKSB7CiAgICAkc2hvcnRfc2l0ZV91cmwgPSBQUk9U
T0NPTC4kc2hvcnRfc2l0ZV91cmwuJy8nOwogICAgJHVybF9wYXJ0cyA9IHBhcnNlX3VybCgk
c2hvcnRfc2l0ZV91cmwpOwogICAgJHJlID0gJyNeJy4kdXJsX3BhcnRzWydwYXRoJ10uJyhb
MC05XS4qKSMnOwogICAgJGhhdmVfaWQgPSBwcmVnX21hdGNoKCRyZSwgJF9TRVJWRVJbJ1JF
UVVFU1RfVVJJJ10sICRtKTsKICB9CgogIC8vIEZhbGwgYmFjayB0byBzdGFuZGFyZCBzaXRl
IHVybCAoc21kX3Nob3J0X3VybCBiZWhhdmlvdXIpCiAgaWYgKCRoYXZlX2lkKSB7CiAgICAk
dXJsX3BhcnRzID0gcGFyc2VfdXJsKGh1KTsKICAgICRyZSA9ICcjXicuJHVybF9wYXJ0c1sn
cGF0aCddLicoWzAtOV0uKikjJzsKICAgICRoYXZlX2lkID0gcHJlZ19tYXRjaCgkcmUsICRf
U0VSVkVSWydSRVFVRVNUX1VSSSddLCAkbSk7CiAgfQoKICAvLyBEbyB0aGUgcmVkaXJlY3Qg
aWYgd2UndmUgZ290IGFuIGFydGljbGUgaWQKICBpZiAoJGhhdmVfaWQpIHsKCSAgJGlkID0g
JG1bMV07CgkgICRwZXJtbGluayA9IHBlcm1saW5rdXJsX2lkKCRpZCk7CgoJICBpZiAoJHBl
cm1saW5rKSB7CgkJICBvYl9lbmRfY2xlYW4oKTsKCgkJICAvLyBTdHVwaWQsIG92ZXIgdGhl
IHRvcCBoZWFkZXIgc2V0dGluZyBmb3IgSUUKCQkgIGhlYWRlcigiU3RhdHVzOiAzMDEiKTsK
CQkgIGhlYWRlcigiSFRUUC8xLjAgMzAxIE1vdmVkIFBlcm1hbmVudGx5Iik7CgkJICBoZWFk
ZXIoIkxvY2F0aW9uOiAiLiRwZXJtbGluaywgVFJVRSwgMzAxKTsKCgkJICAvLyBJbiBjYXNl
IHRoZSBoZWFkZXIoKSBtZXRob2QgZmFpbHMsIGZhbGwgYmFjayBvbiBhIGNsYXNzaWMgcmVk
aXJlY3QKCQkgIGVjaG8gJzxodG1sPjxoZWFkPjxNRVRBIEhUVFAtRVFVSVY9IlJlZnJlc2gi
IENPTlRFTlQ9IjA7VVJMPScKCQkgICAgLiRwZXJtbGluay4nIj48L2hlYWQ+PGJvZHk+PC9i
b2R5PjwvaHRtbD4nOwoJCSAgZGllKCk7CgkgIH0KICB9Cgp9CgovLyBBdXRvIGVuYWJsZSBw
bHVnaW4gb24gaW5zdGFsbCAob3JpZ2luYWwgaWRlYSBieSBNaWNoYWVsIE1hbmZyZSkKZnVu
Y3Rpb24gX2FyY190d2l0dGVyX2F1dG9fZW5hYmxlKCRldmVudCwgJHN0ZXAsICRwcmVmaXg9
J2FyY190d2l0dGVyJykKewogICRwbHVnaW4gPSBzdWJzdHIoJGV2ZW50LCBzdHJsZW4oJ3Bs
dWdpbl9saWZlY3ljbGUuJykpOwogIGlmIChzdHJuY21wKCRwbHVnaW4sICRwcmVmaXgsIHN0
cmxlbigkcHJlZml4KSkgPT0gMCkKICB7CiAgICBzYWZlX3VwZGF0ZSgndHhwX3BsdWdpbics
ICJzdGF0dXMgPSAxIiwgIm5hbWUgPSAnIiAuIGRvU2xhc2goJHBsdWdpbikgLiAiJyIpOwog
IH0KfQoKLyoKICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKKi8KCmNsYXNzIGFyY190d2l0
dGVyIGV4dGVuZHMgVHdpdHRlck9BdXRoIHsKICAgIC8vIENhY2hpbmcgdmFyaWFibGVzCiAg
ICBwcml2YXRlICRfY2FjaGUgPSB0cnVlOwogICAgcHJpdmF0ZSAkX2NhY2hlX2RpciA9ICcu
L3RtcCc7CiAgICBwcml2YXRlICRfY2FjaGVfdGltZSA9IDE4MDA7IC8vIDMwIG1pbnV0ZSBj
YWNoZQoKICAgIGZ1bmN0aW9uIF9fY29uc3RydWN0KCRjb25zdW1lcl9rZXksICRjb25zdW1l
cl9zZWNyZXQsICRvYXV0aF90b2tlbiA9IE5VTEwKICAgICAgICAsICRvYXV0aF90b2tlbl9z
ZWNyZXQgPSBOVUxMKQogICAgewogICAgICAgIHBhcmVudDo6X19jb25zdHJ1Y3QoJGNvbnN1
bWVyX2tleSwgJGNvbnN1bWVyX3NlY3JldCwgJG9hdXRoX3Rva2VuCiAgICAgICAgICAgICwg
JG9hdXRoX3Rva2VuX3NlY3JldCk7CiAgICAgICAgJHRoaXMtPmZvcm1hdCA9ICd4bWwnOwog
ICAgICAgICR0aGlzLT50aW1lb3V0ID0gMTU7CiAgICAgICAgJHRoaXMtPmNvbm5lY3R0aW1l
b3V0ID0gMTU7CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIGNhbGxiYWNrVVJMKCRldmVu
dCwkc3RlcCkKICAgIHsKICAgICAgICByZXR1cm4gcHJlZ19yZXBsYWNlKCcvXD8uKi8nLCAn
JyxQUk9UT0NPTC4kX1NFUlZFUlsnU0VSVkVSX05BTUUnXS4kX1NFUlZFUlsnUkVRVUVTVF9V
UkknXSkKICAgICAgICAgIC4nP2V2ZW50PScuJGV2ZW50LicmYW1wO3N0ZXA9Jy4kc3RlcDsK
ICAgIH0KCiAgICAvLyBjcmVhdGUgVHdpdHRlciBhbmQgZXh0ZXJuYWwgbGlua3MgaW4gdGV4
dAogICAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiBtYWtlTGlua3MoJHRleHQpCiAgICB7CiAg
ICAgICAgJHVybCA9ICcvXGIoaHR0cHxodHRwc3xmdHApOlwvXC8oW0EtWjAtOV1bQS1aMC05
Xy1dKig/OlwuW0EtWjAtOV1bQS1aMC05Xy1dKikrKTo/KFxkKyk/XC8/KFtcL1x3K1wuXSsp
XGIvaSc7CiAgICAgICAgJHRleHQgPSBwcmVnX3JlcGxhY2UoJHVybCwgIjxhIGhyZWY9JyQw
JyByZWw9J2V4dGVybmFsJz4kMDwvYT4iLCAkdGV4dCk7CiAgICAgICAgJHVybCA9ICcvXGIo
Xnxccyl3d3cuKFthLXpfQS1aMC05XSspKChcLlthLXpdKykrKVxiL2knOwogICAgICAgICR0
ZXh0ID0gcHJlZ19yZXBsYWNlKCR1cmwsICI8YSBocmVmPSdodHRwOi8vd3d3LiQyJDMnIHJl
bD0nZXh0ZXJuYWwnPnd3dy4kMiQzPC9hPiIsICR0ZXh0KTsKICAgICAgICAkdGV4dCA9IHBy
ZWdfcmVwbGFjZSgiLyhefFxzKS4/QChbYS16X0EtWjAtOV0rKS8iLAogICAgICAgICAgICAi
JDFAPGEgaHJlZj0naHR0cDovL3R3aXR0ZXIuY29tLyQyJyByZWw9J2V4dGVybmFsJz4kMjwv
YT4iLCR0ZXh0KTsKICAgICAgICAkdGV4dCA9IHByZWdfcmVwbGFjZSgiLyhefFxzKShcIyhb
YS16X0EtWjAtOTpfLV0rKSkvIiwKICAgICAgICAgICAgIiQxPGEgaHJlZj0naHR0cDovL3R3
aXR0ZXIuY29tL3NlYXJjaD9xPSUyMyQzJyByZWw9J2V4dGVybmFsJz4kMjwvYT4iLCR0ZXh0
KTsKICAgICAgICByZXR1cm4gJHRleHQ7CiAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBnZXQo
JHVybCwgJHBhcmFtcyA9IGFycmF5KCkpCiAgICB7CiAgICAgICAgJGFwaV91cmwgPSBtZDUo
JHVybC51cmxlbmNvZGUoc2VyaWFsaXplKCRwYXJhbXMpKSk7CiAgICAgICAgJGRhdGEgPSAn
JzsKCiAgICAgICAgaWYgKCR0aGlzLT5fY2FjaGUpIHsgLy8gY2hlY2sgZm9yIGNhY2hlZCB4
bWwKCiAgICAgICAgICAgICRkYXRhID0gJHRoaXMtPl9yZXRyaWV2ZUNhY2hlKCRhcGlfdXJs
KTsKCiAgICAgICAgfQogICAgICAgIGlmIChlbXB0eSgkZGF0YSkpIHsKICAgICAgICAgICAg
JGRhdGEgPSBwYXJlbnQ6OmdldCgkdXJsLCAkcGFyYW1zKTsKICAgICAgICAgICAgaWYgKCR0
aGlzLT5odHRwX2NvZGU9PT0yMDAgJiYgJHhtbD1zaW1wbGV4bWxfbG9hZF9zdHJpbmcoJGRh
dGEpKSB7IC8vIHNhdmUgY2FjaGUKICAgICAgICAgICAgICAgICRmaWxlID0gJHRoaXMtPl9j
YWNoZV9kaXIuJy8nLiRhcGlfdXJsOwogICAgICAgICAgICAgICAgZmlsZV9wdXRfY29udGVu
dHMoJGZpbGUsJGRhdGEsTE9DS19FWCk7CiAgICAgICAgICAgICAgICByZXR1cm4gJHhtbDsK
ICAgICAgICAgICAgfSBlbHNlIHsgLy8gZmFpbGVkIHRvIHJldHJpZXZlIGRhdGEgZnJvbSBU
d2l0dGVyCgogICAgICAgICAgICAgICAgaWYgKCR0aGlzLT5fY2FjaGUpIHsgLy8gYXR0ZW1w
dCB0byBmb3JjZSBjYWNoZWQgeG1sIHJldHVybgoKICAgICAgICAgICAgICAgICAgICAkZGF0
YSA9ICR0aGlzLT5fcmV0cmlldmVDYWNoZSgkYXBpX3VybCx0cnVlKTsKICAgICAgICAgICAg
ICAgICAgICBpZiAoJGRhdGEpIHJldHVybiBAc2ltcGxleG1sX2xvYWRfc3RyaW5nKCRkYXRh
KTsKCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoK
ICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7IC8vIHJldHVybiBjYWNoZWQgeG1sCiAg
ICAgICAgICAgIHJldHVybiBAc2ltcGxleG1sX2xvYWRfc3RyaW5nKCRkYXRhKTsKICAgICAg
ICB9CiAgICB9IC8vZW5kIGdldCgpCgogICAgZnVuY3Rpb24gcG9zdCgkdXJsLCAkcGFyYW1z
ID0gYXJyYXkoKSkKICAgIHsKICAgICAgICAkZGF0YSA9IHBhcmVudDo6cG9zdCgkdXJsLCRw
YXJhbXMpOwogICAgICAgIHJldHVybiBzaW1wbGV4bWxfbG9hZF9zdHJpbmcoJGRhdGEpOwog
ICAgfQoKICAgIGZ1bmN0aW9uIGRlbGV0ZSgkdXJsLCAkcGFyYW1zID0gYXJyYXkoKSkKICAg
IHsKICAgICAgICAkZGF0YSA9IHBhcmVudDo6ZGVsZXRlKCR1cmwsJHBhcmFtcyk7CiAgICAg
ICAgcmV0dXJuIHNpbXBsZXhtbF9sb2FkX3N0cmluZygkZGF0YSk7CiAgICB9CgogICAgLy8g
Q2FjaGUgbWV0aG9kcwoKICAgIHB1YmxpYyBmdW5jdGlvbiBzZXRDYWNoaW5nKCRjYWNoZT10
cnVlKQogICAgewogICAgICAgICR0aGlzLT5fY2FjaGUgPSAoJGNhY2hlKSA/IHRydWUgOiBm
YWxzZTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24g
Y2FjaGVEaXIoJGxvYykKICAgIHsKICAgICAgICAkdGhpcy0+X2NhY2hlX2RpciA9ICRsb2M7
CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIGNhY2hl
VGltZSgkbWlucykKICAgIHsKICAgICAgICAkdGhpcy0+X2NhY2hlX3RpbWUgPSAkbWlucyo2
MDsgLy8gY29udmVydCBtaW51dGVzIGludG8gc2Vjb25kcwogICAgICAgIHJldHVybiB0cnVl
OwogICAgfQoKICAgIHByaXZhdGUgZnVuY3Rpb24gX3JldHJpZXZlQ2FjaGUoJHVybCwkb3Zl
cmlkZV90aW1lb3V0PWZhbHNlKQogICAgewogICAgICAgICRmaWxlID0gJHRoaXMtPl9jYWNo
ZV9kaXIuJy8nLiR1cmw7CiAgICAgICAgaWYgKGZpbGVfZXhpc3RzKCRmaWxlKSkgewoKICAg
ICAgICAgICAgJGRpZmYgPSB0aW1lKCkgLSBmaWxlbXRpbWUoJGZpbGUpOwogICAgICAgICAg
ICBpZiAoJG92ZXJpZGVfdGltZW91dCB8fCAkZGlmZiA8ICR0aGlzLT5fY2FjaGVfdGltZSkg
ewogICAgICAgICAgICAgICAgcmV0dXJuIGZpbGVfZ2V0X2NvbnRlbnRzKCRmaWxlKTsKICAg
ICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAg
ICAgICAgfQoKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAg
ICAgICAgfQogICAgfQp9CgovKgogKiBBYnJhaGFtIFdpbGxpYW1zIChhYnJhaGFtQGFicmFo
LmFtKSBodHRwOi8vYWJyYWguYW0KICoKICogVGhlIGZpcnN0IFBIUCBMaWJyYXJ5IHRvIHN1
cHBvcnQgT0F1dGggZm9yIFR3aXR0ZXIncyBSRVNUIEFQSS4KICovCgovKioKICogVHdpdHRl
ciBPQXV0aCBjbGFzcwogKi8KY2xhc3MgVHdpdHRlck9BdXRoIHsKICAvKiBDb250YWlucyB0
aGUgbGFzdCBIVFRQIHN0YXR1cyBjb2RlIHJldHVybmVkLiAqLwogIHB1YmxpYyAkaHR0cF9j
b2RlOwogIC8qIENvbnRhaW5zIHRoZSBsYXN0IEFQSSBjYWxsLiAqLwogIHB1YmxpYyAkdXJs
OwogIC8qIFNldCB1cCB0aGUgQVBJIHJvb3QgVVJMLiAqLwogIHB1YmxpYyAkaG9zdCA9ICJo
dHRwczovL2FwaS50d2l0dGVyLmNvbS8xLyI7CiAgLyogU2V0IHRpbWVvdXQgZGVmYXVsdC4g
Ki8KICBwdWJsaWMgJHRpbWVvdXQgPSAzMDsKICAvKiBTZXQgY29ubmVjdCB0aW1lb3V0LiAq
LwogIHB1YmxpYyAkY29ubmVjdHRpbWVvdXQgPSAzMDsKICAvKiBWZXJpZnkgU1NMIENlcnQu
ICovCiAgcHVibGljICRzc2xfdmVyaWZ5cGVlciA9IEZBTFNFOwogIC8qIFJlc3BvbnMgZm9y
bWF0LiAqLwogIHB1YmxpYyAkZm9ybWF0ID0gJ2pzb24nOwogIC8qIERlY29kZSByZXR1cm5l
ZCBqc29uIGRhdGEuICovCiAgcHVibGljICRkZWNvZGVfanNvbiA9IFRSVUU7CiAgLyogQ29u
dGFpbnMgdGhlIGxhc3QgSFRUUCBoZWFkZXJzIHJldHVybmVkLiAqLwogIHB1YmxpYyAkaHR0
cF9pbmZvOwogIC8qIFNldCB0aGUgdXNlcmFnbmV0LiAqLwogIHB1YmxpYyAkdXNlcmFnZW50
ID0gJ1R3aXR0ZXJPQXV0aCB2MC4yLjAtYmV0YTInOwogIC8qIEltbWVkaWF0ZWx5IHJldHJ5
IHRoZSBBUEkgY2FsbCBpZiB0aGUgcmVzcG9uc2Ugd2FzIG5vdCBzdWNjZXNzZnVsLiAqLwog
IC8vcHVibGljICRyZXRyeSA9IFRSVUU7CgoKCgogIC8qKgogICAqIFNldCBBUEkgVVJMUwog
ICAqLwogIGZ1bmN0aW9uIGFjY2Vzc1Rva2VuVVJMKCkgIHsgcmV0dXJuICdodHRwczovL2Fw
aS50d2l0dGVyLmNvbS9vYXV0aC9hY2Nlc3NfdG9rZW4nOyB9CiAgZnVuY3Rpb24gYXV0aGVu
dGljYXRlVVJMKCkgeyByZXR1cm4gJ2h0dHBzOi8vdHdpdHRlci5jb20vb2F1dGgvYXV0aGVu
dGljYXRlJzsgfQogIGZ1bmN0aW9uIGF1dGhvcml6ZVVSTCgpICAgIHsgcmV0dXJuICdodHRw
czovL3R3aXR0ZXIuY29tL29hdXRoL2F1dGhvcml6ZSc7IH0KICBmdW5jdGlvbiByZXF1ZXN0
VG9rZW5VUkwoKSB7IHJldHVybiAnaHR0cHM6Ly9hcGkudHdpdHRlci5jb20vb2F1dGgvcmVx
dWVzdF90b2tlbic7IH0KCiAgLyoqCiAgICogRGVidWcgaGVscGVycwogICAqLwogIGZ1bmN0
aW9uIGxhc3RTdGF0dXNDb2RlKCkgeyByZXR1cm4gJHRoaXMtPmh0dHBfc3RhdHVzOyB9CiAg
ZnVuY3Rpb24gbGFzdEFQSUNhbGwoKSB7IHJldHVybiAkdGhpcy0+bGFzdF9hcGlfY2FsbDsg
fQoKICAvKioKICAgKiBjb25zdHJ1Y3QgVHdpdHRlck9BdXRoIG9iamVjdAogICAqLwogIGZ1
bmN0aW9uIF9fY29uc3RydWN0KCRjb25zdW1lcl9rZXksICRjb25zdW1lcl9zZWNyZXQsICRv
YXV0aF90b2tlbiA9IE5VTEwsICRvYXV0aF90b2tlbl9zZWNyZXQgPSBOVUxMKSB7CiAgICAk
dGhpcy0+c2hhMV9tZXRob2QgPSBuZXcgT0F1dGhTaWduYXR1cmVNZXRob2RfSE1BQ19TSEEx
KCk7CiAgICAkdGhpcy0+Y29uc3VtZXIgPSBuZXcgT0F1dGhDb25zdW1lcigkY29uc3VtZXJf
a2V5LCAkY29uc3VtZXJfc2VjcmV0KTsKICAgIGlmICghZW1wdHkoJG9hdXRoX3Rva2VuKSAm
JiAhZW1wdHkoJG9hdXRoX3Rva2VuX3NlY3JldCkpIHsKICAgICAgJHRoaXMtPnRva2VuID0g
bmV3IE9BdXRoQ29uc3VtZXIoJG9hdXRoX3Rva2VuLCAkb2F1dGhfdG9rZW5fc2VjcmV0KTsK
ICAgIH0gZWxzZSB7CiAgICAgICR0aGlzLT50b2tlbiA9IE5VTEw7CiAgICB9CiAgfQoKCiAg
LyoqCiAgICogR2V0IGEgcmVxdWVzdF90b2tlbiBmcm9tIFR3aXR0ZXIKICAgKgogICAqIEBy
ZXR1cm5zIGEga2V5L3ZhbHVlIGFycmF5IGNvbnRhaW5pbmcgb2F1dGhfdG9rZW4gYW5kIG9h
dXRoX3Rva2VuX3NlY3JldAogICAqLwogIGZ1bmN0aW9uIGdldFJlcXVlc3RUb2tlbigkb2F1
dGhfY2FsbGJhY2sgPSBOVUxMKSB7CiAgICAkcGFyYW1ldGVycyA9IGFycmF5KCk7CiAgICBp
ZiAoIWVtcHR5KCRvYXV0aF9jYWxsYmFjaykpIHsKICAgICAgJHBhcmFtZXRlcnNbJ29hdXRo
X2NhbGxiYWNrJ10gPSAkb2F1dGhfY2FsbGJhY2s7CiAgICB9CiAgICAkcmVxdWVzdCA9ICR0
aGlzLT5vQXV0aFJlcXVlc3QoJHRoaXMtPnJlcXVlc3RUb2tlblVSTCgpLCAnR0VUJywgJHBh
cmFtZXRlcnMpOwogICAgJHRva2VuID0gT0F1dGhVdGlsOjpwYXJzZV9wYXJhbWV0ZXJzKCRy
ZXF1ZXN0KTsKICAgICR0aGlzLT50b2tlbiA9IG5ldyBPQXV0aENvbnN1bWVyKCR0b2tlblsn
b2F1dGhfdG9rZW4nXSwgJHRva2VuWydvYXV0aF90b2tlbl9zZWNyZXQnXSk7CiAgICByZXR1
cm4gJHRva2VuOwogIH0KCiAgLyoqCiAgICogR2V0IHRoZSBhdXRob3JpemUgVVJMCiAgICoK
ICAgKiBAcmV0dXJucyBhIHN0cmluZwogICAqLwogIGZ1bmN0aW9uIGdldEF1dGhvcml6ZVVS
TCgkdG9rZW4sICRzaWduX2luX3dpdGhfdHdpdHRlciA9IFRSVUUpIHsKICAgIGlmIChpc19h
cnJheSgkdG9rZW4pKSB7CiAgICAgICR0b2tlbiA9ICR0b2tlblsnb2F1dGhfdG9rZW4nXTsK
ICAgIH0KICAgIGlmIChlbXB0eSgkc2lnbl9pbl93aXRoX3R3aXR0ZXIpKSB7CiAgICAgIHJl
dHVybiAkdGhpcy0+YXV0aG9yaXplVVJMKCkgLiAiP29hdXRoX3Rva2VuPXskdG9rZW59IjsK
ICAgIH0gZWxzZSB7CiAgICAgICByZXR1cm4gJHRoaXMtPmF1dGhlbnRpY2F0ZVVSTCgpIC4g
Ij9vYXV0aF90b2tlbj17JHRva2VufSI7CiAgICB9CiAgfQoKICAvKioKICAgKiBFeGNoYW5n
ZSByZXF1ZXN0IHRva2VuIGFuZCBzZWNyZXQgZm9yIGFuIGFjY2VzcyB0b2tlbiBhbmQKICAg
KiBzZWNyZXQsIHRvIHNpZ24gQVBJIGNhbGxzLgogICAqCiAgICogQHJldHVybnMgYXJyYXko
Im9hdXRoX3Rva2VuIiA9PiAidGhlLWFjY2Vzcy10b2tlbiIsCiAgICogICAgICAgICAgICAg
ICAgIm9hdXRoX3Rva2VuX3NlY3JldCIgPT4gInRoZS1hY2Nlc3Mtc2VjcmV0IiwKICAgKiAg
ICAgICAgICAgICAgICAidXNlcl9pZCIgPT4gIjk0MzY5OTIiLAogICAqICAgICAgICAgICAg
ICAgICJzY3JlZW5fbmFtZSIgPT4gImFicmFoYW0iKQogICAqLwogIGZ1bmN0aW9uIGdldEFj
Y2Vzc1Rva2VuKCRvYXV0aF92ZXJpZmllciA9IEZBTFNFKSB7CiAgICAkcGFyYW1ldGVycyA9
IGFycmF5KCk7CiAgICBpZiAoIWVtcHR5KCRvYXV0aF92ZXJpZmllcikpIHsKICAgICAgJHBh
cmFtZXRlcnNbJ29hdXRoX3ZlcmlmaWVyJ10gPSAkb2F1dGhfdmVyaWZpZXI7CiAgICB9CiAg
ICAkcmVxdWVzdCA9ICR0aGlzLT5vQXV0aFJlcXVlc3QoJHRoaXMtPmFjY2Vzc1Rva2VuVVJM
KCksICdHRVQnLCAkcGFyYW1ldGVycyk7CiAgICAkdG9rZW4gPSBPQXV0aFV0aWw6OnBhcnNl
X3BhcmFtZXRlcnMoJHJlcXVlc3QpOwogICAgJHRoaXMtPnRva2VuID0gbmV3IE9BdXRoQ29u
c3VtZXIoJHRva2VuWydvYXV0aF90b2tlbiddLCAkdG9rZW5bJ29hdXRoX3Rva2VuX3NlY3Jl
dCddKTsKICAgIHJldHVybiAkdG9rZW47CiAgfQoKICAvKioKICAgKiBPbmUgdGltZSBleGNo
YW5nZSBvZiB1c2VybmFtZSBhbmQgcGFzc3dvcmQgZm9yIGFjY2VzcyB0b2tlbiBhbmQgc2Vj
cmV0LgogICAqCiAgICogQHJldHVybnMgYXJyYXkoIm9hdXRoX3Rva2VuIiA9PiAidGhlLWFj
Y2Vzcy10b2tlbiIsCiAgICogICAgICAgICAgICAgICAgIm9hdXRoX3Rva2VuX3NlY3JldCIg
PT4gInRoZS1hY2Nlc3Mtc2VjcmV0IiwKICAgKiAgICAgICAgICAgICAgICAidXNlcl9pZCIg
PT4gIjk0MzY5OTIiLAogICAqICAgICAgICAgICAgICAgICJzY3JlZW5fbmFtZSIgPT4gImFi
cmFoYW0iLAogICAqICAgICAgICAgICAgICAgICJ4X2F1dGhfZXhwaXJlcyIgPT4gIjAiKQog
ICAqLwogIGZ1bmN0aW9uIGdldFhBdXRoVG9rZW4oJHVzZXJuYW1lLCAkcGFzc3dvcmQpIHsK
ICAgICRwYXJhbWV0ZXJzID0gYXJyYXkoKTsKICAgICRwYXJhbWV0ZXJzWyd4X2F1dGhfdXNl
cm5hbWUnXSA9ICR1c2VybmFtZTsKICAgICRwYXJhbWV0ZXJzWyd4X2F1dGhfcGFzc3dvcmQn
XSA9ICRwYXNzd29yZDsKICAgICRwYXJhbWV0ZXJzWyd4X2F1dGhfbW9kZSddID0gJ2NsaWVu
dF9hdXRoJzsKICAgICRyZXF1ZXN0ID0gJHRoaXMtPm9BdXRoUmVxdWVzdCgkdGhpcy0+YWNj
ZXNzVG9rZW5VUkwoKSwgJ1BPU1QnLCAkcGFyYW1ldGVycyk7CiAgICAkdG9rZW4gPSBPQXV0
aFV0aWw6OnBhcnNlX3BhcmFtZXRlcnMoJHJlcXVlc3QpOwogICAgJHRoaXMtPnRva2VuID0g
bmV3IE9BdXRoQ29uc3VtZXIoJHRva2VuWydvYXV0aF90b2tlbiddLCAkdG9rZW5bJ29hdXRo
X3Rva2VuX3NlY3JldCddKTsKICAgIHJldHVybiAkdG9rZW47CiAgfQoKICAvKioKICAgKiBH
RVQgd3JhcHBlciBmb3Igb0F1dGhSZXF1ZXN0LgogICAqLwogIGZ1bmN0aW9uIGdldCgkdXJs
LCAkcGFyYW1ldGVycyA9IGFycmF5KCkpIHsKICAgICRyZXNwb25zZSA9ICR0aGlzLT5vQXV0
aFJlcXVlc3QoJHVybCwgJ0dFVCcsICRwYXJhbWV0ZXJzKTsKICAgIGlmICgkdGhpcy0+Zm9y
bWF0ID09PSAnanNvbicgJiYgJHRoaXMtPmRlY29kZV9qc29uKSB7CiAgICAgIHJldHVybiBq
c29uX2RlY29kZSgkcmVzcG9uc2UpOwogICAgfQogICAgcmV0dXJuICRyZXNwb25zZTsKICB9
CgogIC8qKgogICAqIFBPU1Qgd3JhcHBlciBmb3Igb0F1dGhSZXF1ZXN0LgogICAqLwogIGZ1
bmN0aW9uIHBvc3QoJHVybCwgJHBhcmFtZXRlcnMgPSBhcnJheSgpKSB7CiAgICAkcmVzcG9u
c2UgPSAkdGhpcy0+b0F1dGhSZXF1ZXN0KCR1cmwsICdQT1NUJywgJHBhcmFtZXRlcnMpOwog
ICAgaWYgKCR0aGlzLT5mb3JtYXQgPT09ICdqc29uJyAmJiAkdGhpcy0+ZGVjb2RlX2pzb24p
IHsKICAgICAgcmV0dXJuIGpzb25fZGVjb2RlKCRyZXNwb25zZSk7CiAgICB9CiAgICByZXR1
cm4gJHJlc3BvbnNlOwogIH0KCiAgLyoqCiAgICogREVMRVRFIHdyYXBwZXIgZm9yIG9BdXRo
UmVxZXVzdC4KICAgKi8KICBmdW5jdGlvbiBkZWxldGUoJHVybCwgJHBhcmFtZXRlcnMgPSBh
cnJheSgpKSB7CiAgICAkcmVzcG9uc2UgPSAkdGhpcy0+b0F1dGhSZXF1ZXN0KCR1cmwsICdE
RUxFVEUnLCAkcGFyYW1ldGVycyk7CiAgICBpZiAoJHRoaXMtPmZvcm1hdCA9PT0gJ2pzb24n
ICYmICR0aGlzLT5kZWNvZGVfanNvbikgewogICAgICByZXR1cm4ganNvbl9kZWNvZGUoJHJl
c3BvbnNlKTsKICAgIH0KICAgIHJldHVybiAkcmVzcG9uc2U7CiAgfQoKICAvKioKICAgKiBG
b3JtYXQgYW5kIHNpZ24gYW4gT0F1dGggLyBBUEkgcmVxdWVzdAogICAqLwogIGZ1bmN0aW9u
IG9BdXRoUmVxdWVzdCgkdXJsLCAkbWV0aG9kLCAkcGFyYW1ldGVycykgewogICAgaWYgKHN0
cnJwb3MoJHVybCwgJ2h0dHBzOi8vJykgIT09IDAgJiYgc3RycnBvcygkdXJsLCAnaHR0cDov
LycpICE9PSAwKSB7CiAgICAgICR1cmwgPSAieyR0aGlzLT5ob3N0fXskdXJsfS57JHRoaXMt
PmZvcm1hdH0iOwogICAgfQogICAgJHJlcXVlc3QgPSBPQXV0aFJlcXVlc3Q6OmZyb21fY29u
c3VtZXJfYW5kX3Rva2VuKCR0aGlzLT5jb25zdW1lciwgJHRoaXMtPnRva2VuLCAkbWV0aG9k
LCAkdXJsLCAkcGFyYW1ldGVycyk7CiAgICAkcmVxdWVzdC0+c2lnbl9yZXF1ZXN0KCR0aGlz
LT5zaGExX21ldGhvZCwgJHRoaXMtPmNvbnN1bWVyLCAkdGhpcy0+dG9rZW4pOwogICAgc3dp
dGNoICgkbWV0aG9kKSB7CiAgICBjYXNlICdHRVQnOgogICAgICByZXR1cm4gJHRoaXMtPmh0
dHAoJHJlcXVlc3QtPnRvX3VybCgpLCAnR0VUJyk7CiAgICBkZWZhdWx0OgogICAgICByZXR1
cm4gJHRoaXMtPmh0dHAoJHJlcXVlc3QtPmdldF9ub3JtYWxpemVkX2h0dHBfdXJsKCksICRt
ZXRob2QsICRyZXF1ZXN0LT50b19wb3N0ZGF0YSgpKTsKICAgIH0KICB9CgogIC8qKgogICAq
IE1ha2UgYW4gSFRUUCByZXF1ZXN0CiAgICoKICAgKiBAcmV0dXJuIEFQSSByZXN1bHRzCiAg
ICovCiAgZnVuY3Rpb24gaHR0cCgkdXJsLCAkbWV0aG9kLCAkcG9zdGZpZWxkcyA9IE5VTEwp
IHsKICAgICR0aGlzLT5odHRwX2luZm8gPSBhcnJheSgpOwogICAgJGNpID0gY3VybF9pbml0
KCk7CiAgICAvKiBDdXJsIHNldHRpbmdzICovCiAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxP
UFRfVVNFUkFHRU5ULCAkdGhpcy0+dXNlcmFnZW50KTsKICAgIGN1cmxfc2V0b3B0KCRjaSwg
Q1VSTE9QVF9DT05ORUNUVElNRU9VVCwgJHRoaXMtPmNvbm5lY3R0aW1lb3V0KTsKICAgIGN1
cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9USU1FT1VULCAkdGhpcy0+dGltZW91dCk7CiAgICBj
dXJsX3NldG9wdCgkY2ksIENVUkxPUFRfUkVUVVJOVFJBTlNGRVIsIFRSVUUpOwogICAgY3Vy
bF9zZXRvcHQoJGNpLCBDVVJMT1BUX0hUVFBIRUFERVIsIGFycmF5KCdFeHBlY3Q6JykpOwog
ICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX1NTTF9WRVJJRllQRUVSLCAkdGhpcy0+c3Ns
X3ZlcmlmeXBlZXIpOwogICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX0hFQURFUkZVTkNU
SU9OLCBhcnJheSgkdGhpcywgJ2dldEhlYWRlcicpKTsKICAgIGN1cmxfc2V0b3B0KCRjaSwg
Q1VSTE9QVF9IRUFERVIsIEZBTFNFKTsKCiAgICBzd2l0Y2ggKCRtZXRob2QpIHsKICAgICAg
Y2FzZSAnUE9TVCc6CiAgICAgICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX1BPU1QsIFRS
VUUpOwogICAgICAgIGlmICghZW1wdHkoJHBvc3RmaWVsZHMpKSB7CiAgICAgICAgICBjdXJs
X3NldG9wdCgkY2ksIENVUkxPUFRfUE9TVEZJRUxEUywgJHBvc3RmaWVsZHMpOwogICAgICAg
IH0KICAgICAgICBicmVhazsKICAgICAgY2FzZSAnREVMRVRFJzoKICAgICAgICBjdXJsX3Nl
dG9wdCgkY2ksIENVUkxPUFRfQ1VTVE9NUkVRVUVTVCwgJ0RFTEVURScpOwogICAgICAgIGlm
ICghZW1wdHkoJHBvc3RmaWVsZHMpKSB7CiAgICAgICAgICAkdXJsID0gInskdXJsfT97JHBv
c3RmaWVsZHN9IjsKICAgICAgICB9CiAgICB9CgogICAgY3VybF9zZXRvcHQoJGNpLCBDVVJM
T1BUX1VSTCwgJHVybCk7CiAgICAkcmVzcG9uc2UgPSBjdXJsX2V4ZWMoJGNpKTsKICAgICR0
aGlzLT5odHRwX2NvZGUgPSBjdXJsX2dldGluZm8oJGNpLCBDVVJMSU5GT19IVFRQX0NPREUp
OwogICAgJHRoaXMtPmh0dHBfaW5mbyA9IGFycmF5X21lcmdlKCR0aGlzLT5odHRwX2luZm8s
IGN1cmxfZ2V0aW5mbygkY2kpKTsKICAgICR0aGlzLT51cmwgPSAkdXJsOwogICAgY3VybF9j
bG9zZSAoJGNpKTsKICAgIHJldHVybiAkcmVzcG9uc2U7CiAgfQoKICAvKioKICAgKiBHZXQg
dGhlIGhlYWRlciBpbmZvIHRvIHN0b3JlLgogICAqLwogIGZ1bmN0aW9uIGdldEhlYWRlcigk
Y2gsICRoZWFkZXIpIHsKICAgICRpID0gc3RycG9zKCRoZWFkZXIsICc6Jyk7CiAgICBpZiAo
IWVtcHR5KCRpKSkgewogICAgICAka2V5ID0gc3RyX3JlcGxhY2UoJy0nLCAnXycsIHN0cnRv
bG93ZXIoc3Vic3RyKCRoZWFkZXIsIDAsICRpKSkpOwogICAgICAkdmFsdWUgPSB0cmltKHN1
YnN0cigkaGVhZGVyLCAkaSArIDIpKTsKICAgICAgJHRoaXMtPmh0dHBfaGVhZGVyWyRrZXld
ID0gJHZhbHVlOwogICAgfQogICAgcmV0dXJuIHN0cmxlbigkaGVhZGVyKTsKICB9Cn0KCmNs
YXNzIE9BdXRoRXhjZXB0aW9uIGV4dGVuZHMgRXhjZXB0aW9uIHsKICAvLyBwYXNzCn0KCmNs
YXNzIE9BdXRoQ29uc3VtZXIgewogIHB1YmxpYyAka2V5OwogIHB1YmxpYyAkc2VjcmV0OwoK
ICBmdW5jdGlvbiBfX2NvbnN0cnVjdCgka2V5LCAkc2VjcmV0LCAkY2FsbGJhY2tfdXJsPU5V
TEwpIHsKICAgICR0aGlzLT5rZXkgPSAka2V5OwogICAgJHRoaXMtPnNlY3JldCA9ICRzZWNy
ZXQ7CiAgICAkdGhpcy0+Y2FsbGJhY2tfdXJsID0gJGNhbGxiYWNrX3VybDsKICB9CgogIGZ1
bmN0aW9uIF9fdG9TdHJpbmcoKSB7CiAgICByZXR1cm4gIk9BdXRoQ29uc3VtZXJba2V5PSR0
aGlzLT5rZXksc2VjcmV0PSR0aGlzLT5zZWNyZXRdIjsKICB9Cn0KCmNsYXNzIE9BdXRoVG9r
ZW4gewogIC8vIGFjY2VzcyB0b2tlbnMgYW5kIHJlcXVlc3QgdG9rZW5zCiAgcHVibGljICRr
ZXk7CiAgcHVibGljICRzZWNyZXQ7CgogIC8qKgogICAqIGtleSA9IHRoZSB0b2tlbgogICAq
IHNlY3JldCA9IHRoZSB0b2tlbiBzZWNyZXQKICAgKi8KICBmdW5jdGlvbiBfX2NvbnN0cnVj
dCgka2V5LCAkc2VjcmV0KSB7CiAgICAkdGhpcy0+a2V5ID0gJGtleTsKICAgICR0aGlzLT5z
ZWNyZXQgPSAkc2VjcmV0OwogIH0KCiAgLyoqCiAgICogZ2VuZXJhdGVzIHRoZSBiYXNpYyBz
dHJpbmcgc2VyaWFsaXphdGlvbiBvZiBhIHRva2VuIHRoYXQgYSBzZXJ2ZXIKICAgKiB3b3Vs
ZCByZXNwb25kIHRvIHJlcXVlc3RfdG9rZW4gYW5kIGFjY2Vzc190b2tlbiBjYWxscyB3aXRo
CiAgICovCiAgZnVuY3Rpb24gdG9fc3RyaW5nKCkgewogICAgcmV0dXJuICJvYXV0aF90b2tl
bj0iIC4KICAgICAgICAgICBPQXV0aFV0aWw6OnVybGVuY29kZV9yZmMzOTg2KCR0aGlzLT5r
ZXkpIC4KICAgICAgICAgICAiJm9hdXRoX3Rva2VuX3NlY3JldD0iIC4KICAgICAgICAgICBP
QXV0aFV0aWw6OnVybGVuY29kZV9yZmMzOTg2KCR0aGlzLT5zZWNyZXQpOwogIH0KCiAgZnVu
Y3Rpb24gX190b1N0cmluZygpIHsKICAgIHJldHVybiAkdGhpcy0+dG9fc3RyaW5nKCk7CiAg
fQp9CgovKioKICogQSBjbGFzcyBmb3IgaW1wbGVtZW50aW5nIGEgU2lnbmF0dXJlIE1ldGhv
ZAogKiBTZWUgc2VjdGlvbiA5ICgiU2lnbmluZyBSZXF1ZXN0cyIpIGluIHRoZSBzcGVjCiAq
LwphYnN0cmFjdCBjbGFzcyBPQXV0aFNpZ25hdHVyZU1ldGhvZCB7CiAgLyoqCiAgICogTmVl
ZHMgdG8gcmV0dXJuIHRoZSBuYW1lIG9mIHRoZSBTaWduYXR1cmUgTWV0aG9kIChpZSBITUFD
LVNIQTEpCiAgICogQHJldHVybiBzdHJpbmcKICAgKi8KICBhYnN0cmFjdCBwdWJsaWMgZnVu
Y3Rpb24gZ2V0X25hbWUoKTsKCiAgLyoqCiAgICogQnVpbGQgdXAgdGhlIHNpZ25hdHVyZQog
ICAqIE5PVEU6IFRoZSBvdXRwdXQgb2YgdGhpcyBmdW5jdGlvbiBNVVNUIE5PVCBiZSB1cmxl
bmNvZGVkLgogICAqIHRoZSBlbmNvZGluZyBpcyBoYW5kbGVkIGluIE9BdXRoUmVxdWVzdCB3
aGVuIHRoZSBmaW5hbAogICAqIHJlcXVlc3QgaXMgc2VyaWFsaXplZAogICAqIEBwYXJhbSBP
QXV0aFJlcXVlc3QgJHJlcXVlc3QKICAgKiBAcGFyYW0gT0F1dGhDb25zdW1lciAkY29uc3Vt
ZXIKICAgKiBAcGFyYW0gT0F1dGhUb2tlbiAkdG9rZW4KICAgKiBAcmV0dXJuIHN0cmluZwog
ICAqLwogIGFic3RyYWN0IHB1YmxpYyBmdW5jdGlvbiBidWlsZF9zaWduYXR1cmUoJHJlcXVl
c3QsICRjb25zdW1lciwgJHRva2VuKTsKCiAgLyoqCiAgICogVmVyaWZpZXMgdGhhdCBhIGdp
dmVuIHNpZ25hdHVyZSBpcyBjb3JyZWN0CiAgICogQHBhcmFtIE9BdXRoUmVxdWVzdCAkcmVx
dWVzdAogICAqIEBwYXJhbSBPQXV0aENvbnN1bWVyICRjb25zdW1lcgogICAqIEBwYXJhbSBP
QXV0aFRva2VuICR0b2tlbgogICAqIEBwYXJhbSBzdHJpbmcgJHNpZ25hdHVyZQogICAqIEBy
ZXR1cm4gYm9vbAogICAqLwogIHB1YmxpYyBmdW5jdGlvbiBjaGVja19zaWduYXR1cmUoJHJl
cXVlc3QsICRjb25zdW1lciwgJHRva2VuLCAkc2lnbmF0dXJlKSB7CiAgICAkYnVpbHQgPSAk
dGhpcy0+YnVpbGRfc2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbik7CiAg
ICByZXR1cm4gJGJ1aWx0ID09ICRzaWduYXR1cmU7CiAgfQp9CgovKioKICogVGhlIEhNQUMt
U0hBMSBzaWduYXR1cmUgbWV0aG9kIHVzZXMgdGhlIEhNQUMtU0hBMSBzaWduYXR1cmUgYWxn
b3JpdGhtIGFzIGRlZmluZWQgaW4gW1JGQzIxMDRdCiAqIHdoZXJlIHRoZSBTaWduYXR1cmUg
QmFzZSBTdHJpbmcgaXMgdGhlIHRleHQgYW5kIHRoZSBrZXkgaXMgdGhlIGNvbmNhdGVuYXRl
ZCB2YWx1ZXMgKGVhY2ggZmlyc3QKICogZW5jb2RlZCBwZXIgUGFyYW1ldGVyIEVuY29kaW5n
KSBvZiB0aGUgQ29uc3VtZXIgU2VjcmV0IGFuZCBUb2tlbiBTZWNyZXQsIHNlcGFyYXRlZCBi
eSBhbiAnJicKICogY2hhcmFjdGVyIChBU0NJSSBjb2RlIDM4KSBldmVuIGlmIGVtcHR5Lgog
KiAgIC0gQ2hhcHRlciA5LjIgKCJITUFDLVNIQTEiKQogKi8KY2xhc3MgT0F1dGhTaWduYXR1
cmVNZXRob2RfSE1BQ19TSEExIGV4dGVuZHMgT0F1dGhTaWduYXR1cmVNZXRob2QgewogIGZ1
bmN0aW9uIGdldF9uYW1lKCkgewogICAgcmV0dXJuICJITUFDLVNIQTEiOwogIH0KCiAgcHVi
bGljIGZ1bmN0aW9uIGJ1aWxkX3NpZ25hdHVyZSgkcmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9r
ZW4pIHsKICAgICRiYXNlX3N0cmluZyA9ICRyZXF1ZXN0LT5nZXRfc2lnbmF0dXJlX2Jhc2Vf
c3RyaW5nKCk7CiAgICAkcmVxdWVzdC0+YmFzZV9zdHJpbmcgPSAkYmFzZV9zdHJpbmc7Cgog
ICAgJGtleV9wYXJ0cyA9IGFycmF5KAogICAgICAkY29uc3VtZXItPnNlY3JldCwKICAgICAg
KCR0b2tlbikgPyAkdG9rZW4tPnNlY3JldCA6ICIiCiAgICApOwoKICAgICRrZXlfcGFydHMg
PSBPQXV0aFV0aWw6OnVybGVuY29kZV9yZmMzOTg2KCRrZXlfcGFydHMpOwogICAgJGtleSA9
IGltcGxvZGUoJyYnLCAka2V5X3BhcnRzKTsKCiAgICByZXR1cm4gYmFzZTY0X2VuY29kZSho
YXNoX2htYWMoJ3NoYTEnLCAkYmFzZV9zdHJpbmcsICRrZXksIHRydWUpKTsKICB9Cn0KCi8q
KgogKiBUaGUgUExBSU5URVhUIG1ldGhvZCBkb2VzIG5vdCBwcm92aWRlIGFueSBzZWN1cml0
eSBwcm90ZWN0aW9uIGFuZCBTSE9VTEQgb25seSBiZSB1c2VkCiAqIG92ZXIgYSBzZWN1cmUg
Y2hhbm5lbCBzdWNoIGFzIEhUVFBTLiBJdCBkb2VzIG5vdCB1c2UgdGhlIFNpZ25hdHVyZSBC
YXNlIFN0cmluZy4KICogICAtIENoYXB0ZXIgOS40ICgiUExBSU5URVhUIikKICovCmNsYXNz
IE9BdXRoU2lnbmF0dXJlTWV0aG9kX1BMQUlOVEVYVCBleHRlbmRzIE9BdXRoU2lnbmF0dXJl
TWV0aG9kIHsKICBwdWJsaWMgZnVuY3Rpb24gZ2V0X25hbWUoKSB7CiAgICByZXR1cm4gIlBM
QUlOVEVYVCI7CiAgfQoKICAvKioKICAgKiBvYXV0aF9zaWduYXR1cmUgaXMgc2V0IHRvIHRo
ZSBjb25jYXRlbmF0ZWQgZW5jb2RlZCB2YWx1ZXMgb2YgdGhlIENvbnN1bWVyIFNlY3JldCBh
bmQKICAgKiBUb2tlbiBTZWNyZXQsIHNlcGFyYXRlZCBieSBhICcmJyBjaGFyYWN0ZXIgKEFT
Q0lJIGNvZGUgMzgpLCBldmVuIGlmIGVpdGhlciBzZWNyZXQgaXMKICAgKiBlbXB0eS4gVGhl
IHJlc3VsdCBNVVNUIGJlIGVuY29kZWQgYWdhaW4uCiAgICogICAtIENoYXB0ZXIgOS40LjEg
KCJHZW5lcmF0aW5nIFNpZ25hdHVyZXMiKQogICAqCiAgICogUGxlYXNlIG5vdGUgdGhhdCB0
aGUgc2Vjb25kIGVuY29kaW5nIE1VU1QgTk9UIGhhcHBlbiBpbiB0aGUgU2lnbmF0dXJlTWV0
aG9kLCBhcwogICAqIE9BdXRoUmVxdWVzdCBoYW5kbGVzIHRoaXMhCiAgICovCiAgcHVibGlj
IGZ1bmN0aW9uIGJ1aWxkX3NpZ25hdHVyZSgkcmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW4p
IHsKICAgICRrZXlfcGFydHMgPSBhcnJheSgKICAgICAgJGNvbnN1bWVyLT5zZWNyZXQsCiAg
ICAgICgkdG9rZW4pID8gJHRva2VuLT5zZWNyZXQgOiAiIgogICAgKTsKCiAgICAka2V5X3Bh
cnRzID0gT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4Nigka2V5X3BhcnRzKTsKICAgICRr
ZXkgPSBpbXBsb2RlKCcmJywgJGtleV9wYXJ0cyk7CiAgICAkcmVxdWVzdC0+YmFzZV9zdHJp
bmcgPSAka2V5OwoKICAgIHJldHVybiAka2V5OwogIH0KfQoKLyoqCiAqIFRoZSBSU0EtU0hB
MSBzaWduYXR1cmUgbWV0aG9kIHVzZXMgdGhlIFJTQVNTQS1QS0NTMS12MV81IHNpZ25hdHVy
ZSBhbGdvcml0aG0gYXMgZGVmaW5lZCBpbgogKiBbUkZDMzQ0N10gc2VjdGlvbiA4LjIgKG1v
cmUgc2ltcGx5IGtub3duIGFzIFBLQ1MjMSksIHVzaW5nIFNIQS0xIGFzIHRoZSBoYXNoIGZ1
bmN0aW9uIGZvcgogKiBFTVNBLVBLQ1MxLXYxXzUuIEl0IGlzIGFzc3VtZWQgdGhhdCB0aGUg
Q29uc3VtZXIgaGFzIHByb3ZpZGVkIGl0cyBSU0EgcHVibGljIGtleSBpbiBhCiAqIHZlcmlm
aWVkIHdheSB0byB0aGUgU2VydmljZSBQcm92aWRlciwgaW4gYSBtYW5uZXIgd2hpY2ggaXMg
YmV5b25kIHRoZSBzY29wZSBvZiB0aGlzCiAqIHNwZWNpZmljYXRpb24uCiAqICAgLSBDaGFw
dGVyIDkuMyAoIlJTQS1TSEExIikKICovCmFic3RyYWN0IGNsYXNzIE9BdXRoU2lnbmF0dXJl
TWV0aG9kX1JTQV9TSEExIGV4dGVuZHMgT0F1dGhTaWduYXR1cmVNZXRob2QgewogIHB1Ymxp
YyBmdW5jdGlvbiBnZXRfbmFtZSgpIHsKICAgIHJldHVybiAiUlNBLVNIQTEiOwogIH0KCiAg
Ly8gVXAgdG8gdGhlIFNQIHRvIGltcGxlbWVudCB0aGlzIGxvb2t1cCBvZiBrZXlzLiBQb3Nz
aWJsZSBpZGVhcyBhcmU6CiAgLy8gKDEpIGRvIGEgbG9va3VwIGluIGEgdGFibGUgb2YgdHJ1
c3RlZCBjZXJ0cyBrZXllZCBvZmYgb2YgY29uc3VtZXIKICAvLyAoMikgZmV0Y2ggdmlhIGh0
dHAgdXNpbmcgYSB1cmwgcHJvdmlkZWQgYnkgdGhlIHJlcXVlc3RlcgogIC8vICgzKSBzb21l
IHNvcnQgb2Ygc3BlY2lmaWMgZGlzY292ZXJ5IGNvZGUgYmFzZWQgb24gcmVxdWVzdAogIC8v
CiAgLy8gRWl0aGVyIHdheSBzaG91bGQgcmV0dXJuIGEgc3RyaW5nIHJlcHJlc2VudGF0aW9u
IG9mIHRoZSBjZXJ0aWZpY2F0ZQogIHByb3RlY3RlZCBhYnN0cmFjdCBmdW5jdGlvbiBmZXRj
aF9wdWJsaWNfY2VydCgmJHJlcXVlc3QpOwoKICAvLyBVcCB0byB0aGUgU1AgdG8gaW1wbGVt
ZW50IHRoaXMgbG9va3VwIG9mIGtleXMuIFBvc3NpYmxlIGlkZWFzIGFyZToKICAvLyAoMSkg
ZG8gYSBsb29rdXAgaW4gYSB0YWJsZSBvZiB0cnVzdGVkIGNlcnRzIGtleWVkIG9mZiBvZiBj
b25zdW1lcgogIC8vCiAgLy8gRWl0aGVyIHdheSBzaG91bGQgcmV0dXJuIGEgc3RyaW5nIHJl
cHJlc2VudGF0aW9uIG9mIHRoZSBjZXJ0aWZpY2F0ZQogIHByb3RlY3RlZCBhYnN0cmFjdCBm
dW5jdGlvbiBmZXRjaF9wcml2YXRlX2NlcnQoJiRyZXF1ZXN0KTsKCiAgcHVibGljIGZ1bmN0
aW9uIGJ1aWxkX3NpZ25hdHVyZSgkcmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW4pIHsKICAg
ICRiYXNlX3N0cmluZyA9ICRyZXF1ZXN0LT5nZXRfc2lnbmF0dXJlX2Jhc2Vfc3RyaW5nKCk7
CiAgICAkcmVxdWVzdC0+YmFzZV9zdHJpbmcgPSAkYmFzZV9zdHJpbmc7CgogICAgLy8gRmV0
Y2ggdGhlIHByaXZhdGUga2V5IGNlcnQgYmFzZWQgb24gdGhlIHJlcXVlc3QKICAgICRjZXJ0
ID0gJHRoaXMtPmZldGNoX3ByaXZhdGVfY2VydCgkcmVxdWVzdCk7CgogICAgLy8gUHVsbCB0
aGUgcHJpdmF0ZSBrZXkgSUQgZnJvbSB0aGUgY2VydGlmaWNhdGUKICAgICRwcml2YXRla2V5
aWQgPSBvcGVuc3NsX2dldF9wcml2YXRla2V5KCRjZXJ0KTsKCiAgICAvLyBTaWduIHVzaW5n
IHRoZSBrZXkKICAgICRvayA9IG9wZW5zc2xfc2lnbigkYmFzZV9zdHJpbmcsICRzaWduYXR1
cmUsICRwcml2YXRla2V5aWQpOwoKICAgIC8vIFJlbGVhc2UgdGhlIGtleSByZXNvdXJjZQog
ICAgb3BlbnNzbF9mcmVlX2tleSgkcHJpdmF0ZWtleWlkKTsKCiAgICByZXR1cm4gYmFzZTY0
X2VuY29kZSgkc2lnbmF0dXJlKTsKICB9CgogIHB1YmxpYyBmdW5jdGlvbiBjaGVja19zaWdu
YXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2VuLCAkc2lnbmF0dXJlKSB7CiAgICAk
ZGVjb2RlZF9zaWcgPSBiYXNlNjRfZGVjb2RlKCRzaWduYXR1cmUpOwoKICAgICRiYXNlX3N0
cmluZyA9ICRyZXF1ZXN0LT5nZXRfc2lnbmF0dXJlX2Jhc2Vfc3RyaW5nKCk7CgogICAgLy8g
RmV0Y2ggdGhlIHB1YmxpYyBrZXkgY2VydCBiYXNlZCBvbiB0aGUgcmVxdWVzdAogICAgJGNl
cnQgPSAkdGhpcy0+ZmV0Y2hfcHVibGljX2NlcnQoJHJlcXVlc3QpOwoKICAgIC8vIFB1bGwg
dGhlIHB1YmxpYyBrZXkgSUQgZnJvbSB0aGUgY2VydGlmaWNhdGUKICAgICRwdWJsaWNrZXlp
ZCA9IG9wZW5zc2xfZ2V0X3B1YmxpY2tleSgkY2VydCk7CgogICAgLy8gQ2hlY2sgdGhlIGNv
bXB1dGVkIHNpZ25hdHVyZSBhZ2FpbnN0IHRoZSBvbmUgcGFzc2VkIGluIHRoZSBxdWVyeQog
ICAgJG9rID0gb3BlbnNzbF92ZXJpZnkoJGJhc2Vfc3RyaW5nLCAkZGVjb2RlZF9zaWcsICRw
dWJsaWNrZXlpZCk7CgogICAgLy8gUmVsZWFzZSB0aGUga2V5IHJlc291cmNlCiAgICBvcGVu
c3NsX2ZyZWVfa2V5KCRwdWJsaWNrZXlpZCk7CgogICAgcmV0dXJuICRvayA9PSAxOwogIH0K
fQoKY2xhc3MgT0F1dGhSZXF1ZXN0IHsKICBwcml2YXRlICRwYXJhbWV0ZXJzOwogIHByaXZh
dGUgJGh0dHBfbWV0aG9kOwogIHByaXZhdGUgJGh0dHBfdXJsOwogIC8vIGZvciBkZWJ1ZyBw
dXJwb3NlcwogIHB1YmxpYyAkYmFzZV9zdHJpbmc7CiAgcHVibGljIHN0YXRpYyAkdmVyc2lv
biA9ICcxLjAnOwogIHB1YmxpYyBzdGF0aWMgJFBPU1RfSU5QVVQgPSAncGhwOi8vaW5wdXQn
OwoKICBmdW5jdGlvbiBfX2NvbnN0cnVjdCgkaHR0cF9tZXRob2QsICRodHRwX3VybCwgJHBh
cmFtZXRlcnM9TlVMTCkgewogICAgQCRwYXJhbWV0ZXJzIG9yICRwYXJhbWV0ZXJzID0gYXJy
YXkoKTsKICAgICRwYXJhbWV0ZXJzID0gYXJyYXlfbWVyZ2UoIE9BdXRoVXRpbDo6cGFyc2Vf
cGFyYW1ldGVycyhwYXJzZV91cmwoJGh0dHBfdXJsLCBQSFBfVVJMX1FVRVJZKSksICRwYXJh
bWV0ZXJzKTsKICAgICR0aGlzLT5wYXJhbWV0ZXJzID0gJHBhcmFtZXRlcnM7CiAgICAkdGhp
cy0+aHR0cF9tZXRob2QgPSAkaHR0cF9tZXRob2Q7CiAgICAkdGhpcy0+aHR0cF91cmwgPSAk
aHR0cF91cmw7CiAgfQoKCiAgLyoqCiAgICogYXR0ZW1wdCB0byBidWlsZCB1cCBhIHJlcXVl
c3QgZnJvbSB3aGF0IHdhcyBwYXNzZWQgdG8gdGhlIHNlcnZlcgogICAqLwogIHB1YmxpYyBz
dGF0aWMgZnVuY3Rpb24gZnJvbV9yZXF1ZXN0KCRodHRwX21ldGhvZD1OVUxMLCAkaHR0cF91
cmw9TlVMTCwgJHBhcmFtZXRlcnM9TlVMTCkgewogICAgJHNjaGVtZSA9ICghaXNzZXQoJF9T
RVJWRVJbJ0hUVFBTJ10pIHx8ICRfU0VSVkVSWydIVFRQUyddICE9ICJvbiIpCiAgICAgICAg
ICAgICAgPyAnaHR0cCcKICAgICAgICAgICAgICA6ICdodHRwcyc7CiAgICBAJGh0dHBfdXJs
IG9yICRodHRwX3VybCA9ICRzY2hlbWUgLgogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAnOi8vJyAuICRfU0VSVkVSWydIVFRQX0hPU1QnXSAuCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICc6JyAuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRfU0VSVkVS
WydTRVJWRVJfUE9SVCddIC4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJF9TRVJW
RVJbJ1JFUVVFU1RfVVJJJ107CiAgICBAJGh0dHBfbWV0aG9kIG9yICRodHRwX21ldGhvZCA9
ICRfU0VSVkVSWydSRVFVRVNUX01FVEhPRCddOwoKICAgIC8vIFdlIHdlcmVuJ3QgaGFuZGVk
IGFueSBwYXJhbWV0ZXJzLCBzbyBsZXQncyBmaW5kIHRoZSBvbmVzIHJlbGV2YW50IHRvCiAg
ICAvLyB0aGlzIHJlcXVlc3QuCiAgICAvLyBJZiB5b3UgcnVuIFhNTC1SUEMgb3Igc2ltaWxh
ciB5b3Ugc2hvdWxkIHVzZSB0aGlzIHRvIHByb3ZpZGUgeW91ciBvd24KICAgIC8vIHBhcnNl
ZCBwYXJhbWV0ZXItbGlzdAogICAgaWYgKCEkcGFyYW1ldGVycykgewogICAgICAvLyBGaW5k
IHJlcXVlc3QgaGVhZGVycwogICAgICAkcmVxdWVzdF9oZWFkZXJzID0gT0F1dGhVdGlsOjpn
ZXRfaGVhZGVycygpOwoKICAgICAgLy8gUGFyc2UgdGhlIHF1ZXJ5LXN0cmluZyB0byBmaW5k
IEdFVCBwYXJhbWV0ZXJzCiAgICAgICRwYXJhbWV0ZXJzID0gT0F1dGhVdGlsOjpwYXJzZV9w
YXJhbWV0ZXJzKCRfU0VSVkVSWydRVUVSWV9TVFJJTkcnXSk7CgogICAgICAvLyBJdCdzIGEg
UE9TVCByZXF1ZXN0IG9mIHRoZSBwcm9wZXIgY29udGVudC10eXBlLCBzbyBwYXJzZSBQT1NU
CiAgICAgIC8vIHBhcmFtZXRlcnMgYW5kIGFkZCB0aG9zZSBvdmVycmlkaW5nIGFueSBkdXBs
aWNhdGVzIGZyb20gR0VUCiAgICAgIGlmICgkaHR0cF9tZXRob2QgPT0gIlBPU1QiCiAgICAg
ICAgICAmJiBAc3Ryc3RyKCRyZXF1ZXN0X2hlYWRlcnNbIkNvbnRlbnQtVHlwZSJdLAogICAg
ICAgICAgICAgICAgICAgICAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIikK
ICAgICAgICAgICkgewogICAgICAgICRwb3N0X2RhdGEgPSBPQXV0aFV0aWw6OnBhcnNlX3Bh
cmFtZXRlcnMoCiAgICAgICAgICBmaWxlX2dldF9jb250ZW50cyhzZWxmOjokUE9TVF9JTlBV
VCkKICAgICAgICApOwogICAgICAgICRwYXJhbWV0ZXJzID0gYXJyYXlfbWVyZ2UoJHBhcmFt
ZXRlcnMsICRwb3N0X2RhdGEpOwogICAgICB9CgogICAgICAvLyBXZSBoYXZlIGEgQXV0aG9y
aXphdGlvbi1oZWFkZXIgd2l0aCBPQXV0aCBkYXRhLiBQYXJzZSB0aGUgaGVhZGVyCiAgICAg
IC8vIGFuZCBhZGQgdGhvc2Ugb3ZlcnJpZGluZyBhbnkgZHVwbGljYXRlcyBmcm9tIEdFVCBv
ciBQT1NUCiAgICAgIGlmIChAc3Vic3RyKCRyZXF1ZXN0X2hlYWRlcnNbJ0F1dGhvcml6YXRp
b24nXSwgMCwgNikgPT0gIk9BdXRoICIpIHsKICAgICAgICAkaGVhZGVyX3BhcmFtZXRlcnMg
PSBPQXV0aFV0aWw6OnNwbGl0X2hlYWRlcigKICAgICAgICAgICRyZXF1ZXN0X2hlYWRlcnNb
J0F1dGhvcml6YXRpb24nXQogICAgICAgICk7CiAgICAgICAgJHBhcmFtZXRlcnMgPSBhcnJh
eV9tZXJnZSgkcGFyYW1ldGVycywgJGhlYWRlcl9wYXJhbWV0ZXJzKTsKICAgICAgfQoKICAg
IH0KCiAgICByZXR1cm4gbmV3IE9BdXRoUmVxdWVzdCgkaHR0cF9tZXRob2QsICRodHRwX3Vy
bCwgJHBhcmFtZXRlcnMpOwogIH0KCiAgLyoqCiAgICogcHJldHR5IG11Y2ggYSBoZWxwZXIg
ZnVuY3Rpb24gdG8gc2V0IHVwIHRoZSByZXF1ZXN0CiAgICovCiAgcHVibGljIHN0YXRpYyBm
dW5jdGlvbiBmcm9tX2NvbnN1bWVyX2FuZF90b2tlbigkY29uc3VtZXIsICR0b2tlbiwgJGh0
dHBfbWV0aG9kLCAkaHR0cF91cmwsICRwYXJhbWV0ZXJzPU5VTEwpIHsKICAgIEAkcGFyYW1l
dGVycyBvciAkcGFyYW1ldGVycyA9IGFycmF5KCk7CiAgICAkZGVmYXVsdHMgPSBhcnJheSgi
b2F1dGhfdmVyc2lvbiIgPT4gT0F1dGhSZXF1ZXN0OjokdmVyc2lvbiwKICAgICAgICAgICAg
ICAgICAgICAgICJvYXV0aF9ub25jZSIgPT4gT0F1dGhSZXF1ZXN0OjpnZW5lcmF0ZV9ub25j
ZSgpLAogICAgICAgICAgICAgICAgICAgICAgIm9hdXRoX3RpbWVzdGFtcCIgPT4gT0F1dGhS
ZXF1ZXN0OjpnZW5lcmF0ZV90aW1lc3RhbXAoKSwKICAgICAgICAgICAgICAgICAgICAgICJv
YXV0aF9jb25zdW1lcl9rZXkiID0+ICRjb25zdW1lci0+a2V5KTsKICAgIGlmICgkdG9rZW4p
CiAgICAgICRkZWZhdWx0c1snb2F1dGhfdG9rZW4nXSA9ICR0b2tlbi0+a2V5OwoKICAgICRw
YXJhbWV0ZXJzID0gYXJyYXlfbWVyZ2UoJGRlZmF1bHRzLCAkcGFyYW1ldGVycyk7CgogICAg
cmV0dXJuIG5ldyBPQXV0aFJlcXVlc3QoJGh0dHBfbWV0aG9kLCAkaHR0cF91cmwsICRwYXJh
bWV0ZXJzKTsKICB9CgogIHB1YmxpYyBmdW5jdGlvbiBzZXRfcGFyYW1ldGVyKCRuYW1lLCAk
dmFsdWUsICRhbGxvd19kdXBsaWNhdGVzID0gdHJ1ZSkgewogICAgaWYgKCRhbGxvd19kdXBs
aWNhdGVzICYmIGlzc2V0KCR0aGlzLT5wYXJhbWV0ZXJzWyRuYW1lXSkpIHsKICAgICAgLy8g
V2UgaGF2ZSBhbHJlYWR5IGFkZGVkIHBhcmFtZXRlcihzKSB3aXRoIHRoaXMgbmFtZSwgc28g
YWRkIHRvIHRoZSBsaXN0CiAgICAgIGlmIChpc19zY2FsYXIoJHRoaXMtPnBhcmFtZXRlcnNb
JG5hbWVdKSkgewogICAgICAgIC8vIFRoaXMgaXMgdGhlIGZpcnN0IGR1cGxpY2F0ZSwgc28g
dHJhbnNmb3JtIHNjYWxhciAoc3RyaW5nKQogICAgICAgIC8vIGludG8gYW4gYXJyYXkgc28g
d2UgY2FuIGFkZCB0aGUgZHVwbGljYXRlcwogICAgICAgICR0aGlzLT5wYXJhbWV0ZXJzWyRu
YW1lXSA9IGFycmF5KCR0aGlzLT5wYXJhbWV0ZXJzWyRuYW1lXSk7CiAgICAgIH0KCiAgICAg
ICR0aGlzLT5wYXJhbWV0ZXJzWyRuYW1lXVtdID0gJHZhbHVlOwogICAgfSBlbHNlIHsKICAg
ICAgJHRoaXMtPnBhcmFtZXRlcnNbJG5hbWVdID0gJHZhbHVlOwogICAgfQogIH0KCiAgcHVi
bGljIGZ1bmN0aW9uIGdldF9wYXJhbWV0ZXIoJG5hbWUpIHsKICAgIHJldHVybiBpc3NldCgk
dGhpcy0+cGFyYW1ldGVyc1skbmFtZV0pID8gJHRoaXMtPnBhcmFtZXRlcnNbJG5hbWVdIDog
bnVsbDsKICB9CgogIHB1YmxpYyBmdW5jdGlvbiBnZXRfcGFyYW1ldGVycygpIHsKICAgIHJl
dHVybiAkdGhpcy0+cGFyYW1ldGVyczsKICB9CgogIHB1YmxpYyBmdW5jdGlvbiB1bnNldF9w
YXJhbWV0ZXIoJG5hbWUpIHsKICAgIHVuc2V0KCR0aGlzLT5wYXJhbWV0ZXJzWyRuYW1lXSk7
CiAgfQoKICAvKioKICAgKiBUaGUgcmVxdWVzdCBwYXJhbWV0ZXJzLCBzb3J0ZWQgYW5kIGNv
bmNhdGVuYXRlZCBpbnRvIGEgbm9ybWFsaXplZCBzdHJpbmcuCiAgICogQHJldHVybiBzdHJp
bmcKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gZ2V0X3NpZ25hYmxlX3BhcmFtZXRlcnMoKSB7
CiAgICAvLyBHcmFiIGFsbCBwYXJhbWV0ZXJzCiAgICAkcGFyYW1zID0gJHRoaXMtPnBhcmFt
ZXRlcnM7CgogICAgLy8gUmVtb3ZlIG9hdXRoX3NpZ25hdHVyZSBpZiBwcmVzZW50CiAgICAv
LyBSZWY6IFNwZWM6IDkuMS4xICgiVGhlIG9hdXRoX3NpZ25hdHVyZSBwYXJhbWV0ZXIgTVVT
VCBiZSBleGNsdWRlZC4iKQogICAgaWYgKGlzc2V0KCRwYXJhbXNbJ29hdXRoX3NpZ25hdHVy
ZSddKSkgewogICAgICB1bnNldCgkcGFyYW1zWydvYXV0aF9zaWduYXR1cmUnXSk7CiAgICB9
CgogICAgcmV0dXJuIE9BdXRoVXRpbDo6YnVpbGRfaHR0cF9xdWVyeSgkcGFyYW1zKTsKICB9
CgogIC8qKgogICAqIFJldHVybnMgdGhlIGJhc2Ugc3RyaW5nIG9mIHRoaXMgcmVxdWVzdAog
ICAqCiAgICogVGhlIGJhc2Ugc3RyaW5nIGRlZmluZWQgYXMgdGhlIG1ldGhvZCwgdGhlIHVy
bAogICAqIGFuZCB0aGUgcGFyYW1ldGVycyAobm9ybWFsaXplZCksIGVhY2ggdXJsZW5jb2Rl
ZAogICAqIGFuZCB0aGUgY29uY2F0ZWQgd2l0aCAmLgogICAqLwogIHB1YmxpYyBmdW5jdGlv
biBnZXRfc2lnbmF0dXJlX2Jhc2Vfc3RyaW5nKCkgewogICAgJHBhcnRzID0gYXJyYXkoCiAg
ICAgICR0aGlzLT5nZXRfbm9ybWFsaXplZF9odHRwX21ldGhvZCgpLAogICAgICAkdGhpcy0+
Z2V0X25vcm1hbGl6ZWRfaHR0cF91cmwoKSwKICAgICAgJHRoaXMtPmdldF9zaWduYWJsZV9w
YXJhbWV0ZXJzKCkKICAgICk7CgogICAgJHBhcnRzID0gT0F1dGhVdGlsOjp1cmxlbmNvZGVf
cmZjMzk4NigkcGFydHMpOwoKICAgIHJldHVybiBpbXBsb2RlKCcmJywgJHBhcnRzKTsKICB9
CgogIC8qKgogICAqIGp1c3QgdXBwZXJjYXNlcyB0aGUgaHR0cCBtZXRob2QKICAgKi8KICBw
dWJsaWMgZnVuY3Rpb24gZ2V0X25vcm1hbGl6ZWRfaHR0cF9tZXRob2QoKSB7CiAgICByZXR1
cm4gc3RydG91cHBlcigkdGhpcy0+aHR0cF9tZXRob2QpOwogIH0KCiAgLyoqCiAgICogcGFy
c2VzIHRoZSB1cmwgYW5kIHJlYnVpbGRzIGl0IHRvIGJlCiAgICogc2NoZW1lOi8vaG9zdC9w
YXRoCiAgICovCiAgcHVibGljIGZ1bmN0aW9uIGdldF9ub3JtYWxpemVkX2h0dHBfdXJsKCkg
ewogICAgJHBhcnRzID0gcGFyc2VfdXJsKCR0aGlzLT5odHRwX3VybCk7CgogICAgJHBvcnQg
PSBAJHBhcnRzWydwb3J0J107CiAgICAkc2NoZW1lID0gJHBhcnRzWydzY2hlbWUnXTsKICAg
ICRob3N0ID0gJHBhcnRzWydob3N0J107CiAgICAkcGF0aCA9IEAkcGFydHNbJ3BhdGgnXTsK
CiAgICAkcG9ydCBvciAkcG9ydCA9ICgkc2NoZW1lID09ICdodHRwcycpID8gJzQ0MycgOiAn
ODAnOwoKICAgIGlmICgoJHNjaGVtZSA9PSAnaHR0cHMnICYmICRwb3J0ICE9ICc0NDMnKQog
ICAgICAgIHx8ICgkc2NoZW1lID09ICdodHRwJyAmJiAkcG9ydCAhPSAnODAnKSkgewogICAg
ICAkaG9zdCA9ICIkaG9zdDokcG9ydCI7CiAgICB9CiAgICByZXR1cm4gIiRzY2hlbWU6Ly8k
aG9zdCRwYXRoIjsKICB9CgogIC8qKgogICAqIGJ1aWxkcyBhIHVybCB1c2FibGUgZm9yIGEg
R0VUIHJlcXVlc3QKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gdG9fdXJsKCkgewogICAgJHBv
c3RfZGF0YSA9ICR0aGlzLT50b19wb3N0ZGF0YSgpOwogICAgJG91dCA9ICR0aGlzLT5nZXRf
bm9ybWFsaXplZF9odHRwX3VybCgpOwogICAgaWYgKCRwb3N0X2RhdGEpIHsKICAgICAgJG91
dCAuPSAnPycuJHBvc3RfZGF0YTsKICAgIH0KICAgIHJldHVybiAkb3V0OwogIH0KCiAgLyoq
CiAgICogYnVpbGRzIHRoZSBkYXRhIG9uZSB3b3VsZCBzZW5kIGluIGEgUE9TVCByZXF1ZXN0
CiAgICovCiAgcHVibGljIGZ1bmN0aW9uIHRvX3Bvc3RkYXRhKCkgewogICAgcmV0dXJuIE9B
dXRoVXRpbDo6YnVpbGRfaHR0cF9xdWVyeSgkdGhpcy0+cGFyYW1ldGVycyk7CiAgfQoKICAv
KioKICAgKiBidWlsZHMgdGhlIEF1dGhvcml6YXRpb246IGhlYWRlcgogICAqLwogIHB1Ymxp
YyBmdW5jdGlvbiB0b19oZWFkZXIoJHJlYWxtPW51bGwpIHsKICAgICRmaXJzdCA9IHRydWU7
CiAgaWYoJHJlYWxtKSB7CiAgICAgICRvdXQgPSAnQXV0aG9yaXphdGlvbjogT0F1dGggcmVh
bG09IicgLiBPQXV0aFV0aWw6OnVybGVuY29kZV9yZmMzOTg2KCRyZWFsbSkgLiAnIic7CiAg
ICAgICRmaXJzdCA9IGZhbHNlOwogICAgfSBlbHNlCiAgICAgICRvdXQgPSAnQXV0aG9yaXph
dGlvbjogT0F1dGgnOwoKICAgICR0b3RhbCA9IGFycmF5KCk7CiAgICBmb3JlYWNoICgkdGhp
cy0+cGFyYW1ldGVycyBhcyAkayA9PiAkdikgewogICAgICBpZiAoc3Vic3RyKCRrLCAwLCA1
KSAhPSAib2F1dGgiKSBjb250aW51ZTsKICAgICAgaWYgKGlzX2FycmF5KCR2KSkgewogICAg
ICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbignQXJyYXlzIG5vdCBzdXBwb3J0ZWQgaW4g
aGVhZGVycycpOwogICAgICB9CiAgICAgICRvdXQgLj0gKCRmaXJzdCkgPyAnICcgOiAnLCc7
CiAgICAgICRvdXQgLj0gT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4NigkaykgLgogICAg
ICAgICAgICAgICc9IicgLgogICAgICAgICAgICAgIE9BdXRoVXRpbDo6dXJsZW5jb2RlX3Jm
YzM5ODYoJHYpIC4KICAgICAgICAgICAgICAnIic7CiAgICAgICRmaXJzdCA9IGZhbHNlOwog
ICAgfQogICAgcmV0dXJuICRvdXQ7CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gX190b1N0cmlu
ZygpIHsKICAgIHJldHVybiAkdGhpcy0+dG9fdXJsKCk7CiAgfQoKCiAgcHVibGljIGZ1bmN0
aW9uIHNpZ25fcmVxdWVzdCgkc2lnbmF0dXJlX21ldGhvZCwgJGNvbnN1bWVyLCAkdG9rZW4p
IHsKICAgICR0aGlzLT5zZXRfcGFyYW1ldGVyKAogICAgICAib2F1dGhfc2lnbmF0dXJlX21l
dGhvZCIsCiAgICAgICRzaWduYXR1cmVfbWV0aG9kLT5nZXRfbmFtZSgpLAogICAgICBmYWxz
ZQogICAgKTsKICAgICRzaWduYXR1cmUgPSAkdGhpcy0+YnVpbGRfc2lnbmF0dXJlKCRzaWdu
YXR1cmVfbWV0aG9kLCAkY29uc3VtZXIsICR0b2tlbik7CiAgICAkdGhpcy0+c2V0X3BhcmFt
ZXRlcigib2F1dGhfc2lnbmF0dXJlIiwgJHNpZ25hdHVyZSwgZmFsc2UpOwogIH0KCiAgcHVi
bGljIGZ1bmN0aW9uIGJ1aWxkX3NpZ25hdHVyZSgkc2lnbmF0dXJlX21ldGhvZCwgJGNvbnN1
bWVyLCAkdG9rZW4pIHsKICAgICRzaWduYXR1cmUgPSAkc2lnbmF0dXJlX21ldGhvZC0+YnVp
bGRfc2lnbmF0dXJlKCR0aGlzLCAkY29uc3VtZXIsICR0b2tlbik7CiAgICByZXR1cm4gJHNp
Z25hdHVyZTsKICB9CgogIC8qKgogICAqIHV0aWwgZnVuY3Rpb246IGN1cnJlbnQgdGltZXN0
YW1wCiAgICovCiAgcHJpdmF0ZSBzdGF0aWMgZnVuY3Rpb24gZ2VuZXJhdGVfdGltZXN0YW1w
KCkgewogICAgcmV0dXJuIHRpbWUoKTsKICB9CgogIC8qKgogICAqIHV0aWwgZnVuY3Rpb246
IGN1cnJlbnQgbm9uY2UKICAgKi8KICBwcml2YXRlIHN0YXRpYyBmdW5jdGlvbiBnZW5lcmF0
ZV9ub25jZSgpIHsKICAgICRtdCA9IG1pY3JvdGltZSgpOwogICAgJHJhbmQgPSBtdF9yYW5k
KCk7CgogICAgcmV0dXJuIG1kNSgkbXQgLiAkcmFuZCk7IC8vIG1kNXMgbG9vayBuaWNlciB0
aGFuIG51bWJlcnMKICB9Cn0KCmNsYXNzIE9BdXRoU2VydmVyIHsKICBwcm90ZWN0ZWQgJHRp
bWVzdGFtcF90aHJlc2hvbGQgPSAzMDA7IC8vIGluIHNlY29uZHMsIGZpdmUgbWludXRlcwog
IHByb3RlY3RlZCAkdmVyc2lvbiA9ICcxLjAnOyAgICAgICAgICAgICAvLyBoaSBibGFpbmUK
ICBwcm90ZWN0ZWQgJHNpZ25hdHVyZV9tZXRob2RzID0gYXJyYXkoKTsKCiAgcHJvdGVjdGVk
ICRkYXRhX3N0b3JlOwoKICBmdW5jdGlvbiBfX2NvbnN0cnVjdCgkZGF0YV9zdG9yZSkgewog
ICAgJHRoaXMtPmRhdGFfc3RvcmUgPSAkZGF0YV9zdG9yZTsKICB9CgogIHB1YmxpYyBmdW5j
dGlvbiBhZGRfc2lnbmF0dXJlX21ldGhvZCgkc2lnbmF0dXJlX21ldGhvZCkgewogICAgJHRo
aXMtPnNpZ25hdHVyZV9tZXRob2RzWyRzaWduYXR1cmVfbWV0aG9kLT5nZXRfbmFtZSgpXSA9
CiAgICAgICRzaWduYXR1cmVfbWV0aG9kOwogIH0KCiAgLy8gaGlnaCBsZXZlbCBmdW5jdGlv
bnMKCiAgLyoqCiAgICogcHJvY2VzcyBhIHJlcXVlc3RfdG9rZW4gcmVxdWVzdAogICAqIHJl
dHVybnMgdGhlIHJlcXVlc3QgdG9rZW4gb24gc3VjY2VzcwogICAqLwogIHB1YmxpYyBmdW5j
dGlvbiBmZXRjaF9yZXF1ZXN0X3Rva2VuKCYkcmVxdWVzdCkgewogICAgJHRoaXMtPmdldF92
ZXJzaW9uKCRyZXF1ZXN0KTsKCiAgICAkY29uc3VtZXIgPSAkdGhpcy0+Z2V0X2NvbnN1bWVy
KCRyZXF1ZXN0KTsKCiAgICAvLyBubyB0b2tlbiByZXF1aXJlZCBmb3IgdGhlIGluaXRpYWwg
dG9rZW4gcmVxdWVzdAogICAgJHRva2VuID0gTlVMTDsKCiAgICAkdGhpcy0+Y2hlY2tfc2ln
bmF0dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbik7CgogICAgLy8gUmV2IEEgY2hh
bmdlCiAgICAkY2FsbGJhY2sgPSAkcmVxdWVzdC0+Z2V0X3BhcmFtZXRlcignb2F1dGhfY2Fs
bGJhY2snKTsKICAgICRuZXdfdG9rZW4gPSAkdGhpcy0+ZGF0YV9zdG9yZS0+bmV3X3JlcXVl
c3RfdG9rZW4oJGNvbnN1bWVyLCAkY2FsbGJhY2spOwoKICAgIHJldHVybiAkbmV3X3Rva2Vu
OwogIH0KCiAgLyoqCiAgICogcHJvY2VzcyBhbiBhY2Nlc3NfdG9rZW4gcmVxdWVzdAogICAq
IHJldHVybnMgdGhlIGFjY2VzcyB0b2tlbiBvbiBzdWNjZXNzCiAgICovCiAgcHVibGljIGZ1
bmN0aW9uIGZldGNoX2FjY2Vzc190b2tlbigmJHJlcXVlc3QpIHsKICAgICR0aGlzLT5nZXRf
dmVyc2lvbigkcmVxdWVzdCk7CgogICAgJGNvbnN1bWVyID0gJHRoaXMtPmdldF9jb25zdW1l
cigkcmVxdWVzdCk7CgogICAgLy8gcmVxdWlyZXMgYXV0aG9yaXplZCByZXF1ZXN0IHRva2Vu
CiAgICAkdG9rZW4gPSAkdGhpcy0+Z2V0X3Rva2VuKCRyZXF1ZXN0LCAkY29uc3VtZXIsICJy
ZXF1ZXN0Iik7CgogICAgJHRoaXMtPmNoZWNrX3NpZ25hdHVyZSgkcmVxdWVzdCwgJGNvbnN1
bWVyLCAkdG9rZW4pOwoKICAgIC8vIFJldiBBIGNoYW5nZQogICAgJHZlcmlmaWVyID0gJHJl
cXVlc3QtPmdldF9wYXJhbWV0ZXIoJ29hdXRoX3ZlcmlmaWVyJyk7CiAgICAkbmV3X3Rva2Vu
ID0gJHRoaXMtPmRhdGFfc3RvcmUtPm5ld19hY2Nlc3NfdG9rZW4oJHRva2VuLCAkY29uc3Vt
ZXIsICR2ZXJpZmllcik7CgogICAgcmV0dXJuICRuZXdfdG9rZW47CiAgfQoKICAvKioKICAg
KiB2ZXJpZnkgYW4gYXBpIGNhbGwsIGNoZWNrcyBhbGwgdGhlIHBhcmFtZXRlcnMKICAgKi8K
ICBwdWJsaWMgZnVuY3Rpb24gdmVyaWZ5X3JlcXVlc3QoJiRyZXF1ZXN0KSB7CiAgICAkdGhp
cy0+Z2V0X3ZlcnNpb24oJHJlcXVlc3QpOwogICAgJGNvbnN1bWVyID0gJHRoaXMtPmdldF9j
b25zdW1lcigkcmVxdWVzdCk7CiAgICAkdG9rZW4gPSAkdGhpcy0+Z2V0X3Rva2VuKCRyZXF1
ZXN0LCAkY29uc3VtZXIsICJhY2Nlc3MiKTsKICAgICR0aGlzLT5jaGVja19zaWduYXR1cmUo
JHJlcXVlc3QsICRjb25zdW1lciwgJHRva2VuKTsKICAgIHJldHVybiBhcnJheSgkY29uc3Vt
ZXIsICR0b2tlbik7CiAgfQoKICAvLyBJbnRlcm5hbHMgZnJvbSBoZXJlCiAgLyoqCiAgICog
dmVyc2lvbiAxCiAgICovCiAgcHJpdmF0ZSBmdW5jdGlvbiBnZXRfdmVyc2lvbigmJHJlcXVl
c3QpIHsKICAgICR2ZXJzaW9uID0gJHJlcXVlc3QtPmdldF9wYXJhbWV0ZXIoIm9hdXRoX3Zl
cnNpb24iKTsKICAgIGlmICghJHZlcnNpb24pIHsKICAgICAgLy8gU2VydmljZSBQcm92aWRl
cnMgTVVTVCBhc3N1bWUgdGhlIHByb3RvY29sIHZlcnNpb24gdG8gYmUgMS4wIGlmIHRoaXMg
cGFyYW1ldGVyIGlzIG5vdCBwcmVzZW50LgogICAgICAvLyBDaGFwdGVyIDcuMCAoIkFjY2Vz
c2luZyBQcm90ZWN0ZWQgUmVzc291cmNlcyIpCiAgICAgICR2ZXJzaW9uID0gJzEuMCc7CiAg
ICB9CiAgICBpZiAoJHZlcnNpb24gIT09ICR0aGlzLT52ZXJzaW9uKSB7CiAgICAgIHRocm93
IG5ldyBPQXV0aEV4Y2VwdGlvbigiT0F1dGggdmVyc2lvbiAnJHZlcnNpb24nIG5vdCBzdXBw
b3J0ZWQiKTsKICAgIH0KICAgIHJldHVybiAkdmVyc2lvbjsKICB9CgogIC8qKgogICAqIGZp
Z3VyZSBvdXQgdGhlIHNpZ25hdHVyZSB3aXRoIHNvbWUgZGVmYXVsdHMKICAgKi8KICBwcml2
YXRlIGZ1bmN0aW9uIGdldF9zaWduYXR1cmVfbWV0aG9kKCYkcmVxdWVzdCkgewogICAgJHNp
Z25hdHVyZV9tZXRob2QgPQogICAgICAgIEAkcmVxdWVzdC0+Z2V0X3BhcmFtZXRlcigib2F1
dGhfc2lnbmF0dXJlX21ldGhvZCIpOwoKICAgIGlmICghJHNpZ25hdHVyZV9tZXRob2QpIHsK
ICAgICAgLy8gQWNjb3JkaW5nIHRvIGNoYXB0ZXIgNyAoIkFjY2Vzc2luZyBQcm90ZWN0ZWQg
UmVzc291cmNlcyIpIHRoZSBzaWduYXR1cmUtbWV0aG9kCiAgICAgIC8vIHBhcmFtZXRlciBp
cyByZXF1aXJlZCwgYW5kIHdlIGNhbid0IGp1c3QgZmFsbGJhY2sgdG8gUExBSU5URVhUCiAg
ICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbignTm8gc2lnbmF0dXJlIG1ldGhvZCBwYXJh
bWV0ZXIuIFRoaXMgcGFyYW1ldGVyIGlzIHJlcXVpcmVkJyk7CiAgICB9CgogICAgaWYgKCFp
bl9hcnJheSgkc2lnbmF0dXJlX21ldGhvZCwKICAgICAgICAgICAgICAgICAgYXJyYXlfa2V5
cygkdGhpcy0+c2lnbmF0dXJlX21ldGhvZHMpKSkgewogICAgICB0aHJvdyBuZXcgT0F1dGhF
eGNlcHRpb24oCiAgICAgICAgIlNpZ25hdHVyZSBtZXRob2QgJyRzaWduYXR1cmVfbWV0aG9k
JyBub3Qgc3VwcG9ydGVkICIgLgogICAgICAgICJ0cnkgb25lIG9mIHRoZSBmb2xsb3dpbmc6
ICIgLgogICAgICAgIGltcGxvZGUoIiwgIiwgYXJyYXlfa2V5cygkdGhpcy0+c2lnbmF0dXJl
X21ldGhvZHMpKQogICAgICApOwogICAgfQogICAgcmV0dXJuICR0aGlzLT5zaWduYXR1cmVf
bWV0aG9kc1skc2lnbmF0dXJlX21ldGhvZF07CiAgfQoKICAvKioKICAgKiB0cnkgdG8gZmlu
ZCB0aGUgY29uc3VtZXIgZm9yIHRoZSBwcm92aWRlZCByZXF1ZXN0J3MgY29uc3VtZXIga2V5
CiAgICovCiAgcHJpdmF0ZSBmdW5jdGlvbiBnZXRfY29uc3VtZXIoJiRyZXF1ZXN0KSB7CiAg
ICAkY29uc3VtZXJfa2V5ID0gQCRyZXF1ZXN0LT5nZXRfcGFyYW1ldGVyKCJvYXV0aF9jb25z
dW1lcl9rZXkiKTsKICAgIGlmICghJGNvbnN1bWVyX2tleSkgewogICAgICB0aHJvdyBuZXcg
T0F1dGhFeGNlcHRpb24oIkludmFsaWQgY29uc3VtZXIga2V5Iik7CiAgICB9CgogICAgJGNv
bnN1bWVyID0gJHRoaXMtPmRhdGFfc3RvcmUtPmxvb2t1cF9jb25zdW1lcigkY29uc3VtZXJf
a2V5KTsKICAgIGlmICghJGNvbnN1bWVyKSB7CiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2Vw
dGlvbigiSW52YWxpZCBjb25zdW1lciIpOwogICAgfQoKICAgIHJldHVybiAkY29uc3VtZXI7
CiAgfQoKICAvKioKICAgKiB0cnkgdG8gZmluZCB0aGUgdG9rZW4gZm9yIHRoZSBwcm92aWRl
ZCByZXF1ZXN0J3MgdG9rZW4ga2V5CiAgICovCiAgcHJpdmF0ZSBmdW5jdGlvbiBnZXRfdG9r
ZW4oJiRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbl90eXBlPSJhY2Nlc3MiKSB7CiAgICAk
dG9rZW5fZmllbGQgPSBAJHJlcXVlc3QtPmdldF9wYXJhbWV0ZXIoJ29hdXRoX3Rva2VuJyk7
CiAgICAkdG9rZW4gPSAkdGhpcy0+ZGF0YV9zdG9yZS0+bG9va3VwX3Rva2VuKAogICAgICAk
Y29uc3VtZXIsICR0b2tlbl90eXBlLCAkdG9rZW5fZmllbGQKICAgICk7CiAgICBpZiAoISR0
b2tlbikgewogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oIkludmFsaWQgJHRva2Vu
X3R5cGUgdG9rZW46ICR0b2tlbl9maWVsZCIpOwogICAgfQogICAgcmV0dXJuICR0b2tlbjsK
ICB9CgogIC8qKgogICAqIGFsbC1pbi1vbmUgZnVuY3Rpb24gdG8gY2hlY2sgdGhlIHNpZ25h
dHVyZSBvbiBhIHJlcXVlc3QKICAgKiBzaG91bGQgZ3Vlc3MgdGhlIHNpZ25hdHVyZSBtZXRo
b2QgYXBwcm9wcmlhdGVseQogICAqLwogIHByaXZhdGUgZnVuY3Rpb24gY2hlY2tfc2lnbmF0
dXJlKCYkcmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW4pIHsKICAgIC8vIHRoaXMgc2hvdWxk
IHByb2JhYmx5IGJlIGluIGEgZGlmZmVyZW50IG1ldGhvZAogICAgJHRpbWVzdGFtcCA9IEAk
cmVxdWVzdC0+Z2V0X3BhcmFtZXRlcignb2F1dGhfdGltZXN0YW1wJyk7CiAgICAkbm9uY2Ug
PSBAJHJlcXVlc3QtPmdldF9wYXJhbWV0ZXIoJ29hdXRoX25vbmNlJyk7CgogICAgJHRoaXMt
PmNoZWNrX3RpbWVzdGFtcCgkdGltZXN0YW1wKTsKICAgICR0aGlzLT5jaGVja19ub25jZSgk
Y29uc3VtZXIsICR0b2tlbiwgJG5vbmNlLCAkdGltZXN0YW1wKTsKCiAgICAkc2lnbmF0dXJl
X21ldGhvZCA9ICR0aGlzLT5nZXRfc2lnbmF0dXJlX21ldGhvZCgkcmVxdWVzdCk7CgogICAg
JHNpZ25hdHVyZSA9ICRyZXF1ZXN0LT5nZXRfcGFyYW1ldGVyKCdvYXV0aF9zaWduYXR1cmUn
KTsKICAgICR2YWxpZF9zaWcgPSAkc2lnbmF0dXJlX21ldGhvZC0+Y2hlY2tfc2lnbmF0dXJl
KAogICAgICAkcmVxdWVzdCwKICAgICAgJGNvbnN1bWVyLAogICAgICAkdG9rZW4sCiAgICAg
ICRzaWduYXR1cmUKICAgICk7CgogICAgaWYgKCEkdmFsaWRfc2lnKSB7CiAgICAgIHRocm93
IG5ldyBPQXV0aEV4Y2VwdGlvbigiSW52YWxpZCBzaWduYXR1cmUiKTsKICAgIH0KICB9Cgog
IC8qKgogICAqIGNoZWNrIHRoYXQgdGhlIHRpbWVzdGFtcCBpcyBuZXcgZW5vdWdoCiAgICov
CiAgcHJpdmF0ZSBmdW5jdGlvbiBjaGVja190aW1lc3RhbXAoJHRpbWVzdGFtcCkgewogICAg
aWYoICEgJHRpbWVzdGFtcCApCiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbigKICAg
ICAgICAnTWlzc2luZyB0aW1lc3RhbXAgcGFyYW1ldGVyLiBUaGUgcGFyYW1ldGVyIGlzIHJl
cXVpcmVkJwogICAgICApOwoKICAgIC8vIHZlcmlmeSB0aGF0IHRpbWVzdGFtcCBpcyByZWNl
bnRpc2gKICAgICRub3cgPSB0aW1lKCk7CiAgICBpZiAoYWJzKCRub3cgLSAkdGltZXN0YW1w
KSA+ICR0aGlzLT50aW1lc3RhbXBfdGhyZXNob2xkKSB7CiAgICAgIHRocm93IG5ldyBPQXV0
aEV4Y2VwdGlvbigKICAgICAgICAiRXhwaXJlZCB0aW1lc3RhbXAsIHlvdXJzICR0aW1lc3Rh
bXAsIG91cnMgJG5vdyIKICAgICAgKTsKICAgIH0KICB9CgogIC8qKgogICAqIGNoZWNrIHRo
YXQgdGhlIG5vbmNlIGlzIG5vdCByZXBlYXRlZAogICAqLwogIHByaXZhdGUgZnVuY3Rpb24g
Y2hlY2tfbm9uY2UoJGNvbnN1bWVyLCAkdG9rZW4sICRub25jZSwgJHRpbWVzdGFtcCkgewog
ICAgaWYoICEgJG5vbmNlICkKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKAogICAg
ICAgICdNaXNzaW5nIG5vbmNlIHBhcmFtZXRlci4gVGhlIHBhcmFtZXRlciBpcyByZXF1aXJl
ZCcKICAgICAgKTsKCiAgICAvLyB2ZXJpZnkgdGhhdCB0aGUgbm9uY2UgaXMgdW5pcXVlaXNo
CiAgICAkZm91bmQgPSAkdGhpcy0+ZGF0YV9zdG9yZS0+bG9va3VwX25vbmNlKAogICAgICAk
Y29uc3VtZXIsCiAgICAgICR0b2tlbiwKICAgICAgJG5vbmNlLAogICAgICAkdGltZXN0YW1w
CiAgICApOwogICAgaWYgKCRmb3VuZCkgewogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRp
b24oIk5vbmNlIGFscmVhZHkgdXNlZDogJG5vbmNlIik7CiAgICB9CiAgfQoKfQoKY2xhc3Mg
T0F1dGhEYXRhU3RvcmUgewogIGZ1bmN0aW9uIGxvb2t1cF9jb25zdW1lcigkY29uc3VtZXJf
a2V5KSB7CiAgICAvLyBpbXBsZW1lbnQgbWUKICB9CgogIGZ1bmN0aW9uIGxvb2t1cF90b2tl
bigkY29uc3VtZXIsICR0b2tlbl90eXBlLCAkdG9rZW4pIHsKICAgIC8vIGltcGxlbWVudCBt
ZQogIH0KCiAgZnVuY3Rpb24gbG9va3VwX25vbmNlKCRjb25zdW1lciwgJHRva2VuLCAkbm9u
Y2UsICR0aW1lc3RhbXApIHsKICAgIC8vIGltcGxlbWVudCBtZQogIH0KCiAgZnVuY3Rpb24g
bmV3X3JlcXVlc3RfdG9rZW4oJGNvbnN1bWVyLCAkY2FsbGJhY2sgPSBudWxsKSB7CiAgICAv
LyByZXR1cm4gYSBuZXcgdG9rZW4gYXR0YWNoZWQgdG8gdGhpcyBjb25zdW1lcgogIH0KCiAg
ZnVuY3Rpb24gbmV3X2FjY2Vzc190b2tlbigkdG9rZW4sICRjb25zdW1lciwgJHZlcmlmaWVy
ID0gbnVsbCkgewogICAgLy8gcmV0dXJuIGEgbmV3IGFjY2VzcyB0b2tlbiBhdHRhY2hlZCB0
byB0aGlzIGNvbnN1bWVyCiAgICAvLyBmb3IgdGhlIHVzZXIgYXNzb2NpYXRlZCB3aXRoIHRo
aXMgdG9rZW4gaWYgdGhlIHJlcXVlc3QgdG9rZW4KICAgIC8vIGlzIGF1dGhvcml6ZWQKICAg
IC8vIHNob3VsZCBhbHNvIGludmFsaWRhdGUgdGhlIHJlcXVlc3QgdG9rZW4KICB9Cgp9Cgpj
bGFzcyBPQXV0aFV0aWwgewogIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gdXJsZW5jb2RlX3Jm
YzM5ODYoJGlucHV0KSB7CiAgaWYgKGlzX2FycmF5KCRpbnB1dCkpIHsKICAgIHJldHVybiBh
cnJheV9tYXAoYXJyYXkoJ09BdXRoVXRpbCcsICd1cmxlbmNvZGVfcmZjMzk4NicpLCAkaW5w
dXQpOwogIH0gZWxzZSBpZiAoaXNfc2NhbGFyKCRpbnB1dCkpIHsKICAgIHJldHVybiBzdHJf
cmVwbGFjZSgKICAgICAgJysnLAogICAgICAnICcsCiAgICAgIHN0cl9yZXBsYWNlKCclN0Un
LCAnficsIHJhd3VybGVuY29kZSgkaW5wdXQpKQogICAgKTsKICB9IGVsc2UgewogICAgcmV0
dXJuICcnOwogIH0KfQoKCiAgLy8gVGhpcyBkZWNvZGUgZnVuY3Rpb24gaXNuJ3QgdGFraW5n
IGludG8gY29uc2lkZXJhdGlvbiB0aGUgYWJvdmUKICAvLyBtb2RpZmljYXRpb25zIHRvIHRo
ZSBlbmNvZGluZyBwcm9jZXNzLiBIb3dldmVyLCB0aGlzIG1ldGhvZCBkb2Vzbid0CiAgLy8g
c2VlbSB0byBiZSB1c2VkIGFueXdoZXJlIHNvIGxlYXZpbmcgaXQgYXMgaXMuCiAgcHVibGlj
IHN0YXRpYyBmdW5jdGlvbiB1cmxkZWNvZGVfcmZjMzk4Nigkc3RyaW5nKSB7CiAgICByZXR1
cm4gdXJsZGVjb2RlKCRzdHJpbmcpOwogIH0KCiAgLy8gVXRpbGl0eSBmdW5jdGlvbiBmb3Ig
dHVybmluZyB0aGUgQXV0aG9yaXphdGlvbjogaGVhZGVyIGludG8KICAvLyBwYXJhbWV0ZXJz
LCBoYXMgdG8gZG8gc29tZSB1bmVzY2FwaW5nCiAgLy8gQ2FuIGZpbHRlciBvdXQgYW55IG5v
bi1vYXV0aCBwYXJhbWV0ZXJzIGlmIG5lZWRlZCAoZGVmYXVsdCBiZWhhdmlvdXIpCiAgcHVi
bGljIHN0YXRpYyBmdW5jdGlvbiBzcGxpdF9oZWFkZXIoJGhlYWRlciwgJG9ubHlfYWxsb3df
b2F1dGhfcGFyYW1ldGVycyA9IHRydWUpIHsKICAgICRwYXR0ZXJuID0gJy8oKFstX2Etel0q
KT0oIihbXiJdKikifChbXixdKikpLD8pLyc7CiAgICAkb2Zmc2V0ID0gMDsKICAgICRwYXJh
bXMgPSBhcnJheSgpOwogICAgd2hpbGUgKHByZWdfbWF0Y2goJHBhdHRlcm4sICRoZWFkZXIs
ICRtYXRjaGVzLCBQUkVHX09GRlNFVF9DQVBUVVJFLCAkb2Zmc2V0KSA+IDApIHsKICAgICAg
JG1hdGNoID0gJG1hdGNoZXNbMF07CiAgICAgICRoZWFkZXJfbmFtZSA9ICRtYXRjaGVzWzJd
WzBdOwogICAgICAkaGVhZGVyX2NvbnRlbnQgPSAoaXNzZXQoJG1hdGNoZXNbNV0pKSA/ICRt
YXRjaGVzWzVdWzBdIDogJG1hdGNoZXNbNF1bMF07CiAgICAgIGlmIChwcmVnX21hdGNoKCcv
Xm9hdXRoXy8nLCAkaGVhZGVyX25hbWUpIHx8ICEkb25seV9hbGxvd19vYXV0aF9wYXJhbWV0
ZXJzKSB7CiAgICAgICAgJHBhcmFtc1skaGVhZGVyX25hbWVdID0gT0F1dGhVdGlsOjp1cmxk
ZWNvZGVfcmZjMzk4NigkaGVhZGVyX2NvbnRlbnQpOwogICAgICB9CiAgICAgICRvZmZzZXQg
PSAkbWF0Y2hbMV0gKyBzdHJsZW4oJG1hdGNoWzBdKTsKICAgIH0KCiAgICBpZiAoaXNzZXQo
JHBhcmFtc1sncmVhbG0nXSkpIHsKICAgICAgdW5zZXQoJHBhcmFtc1sncmVhbG0nXSk7CiAg
ICB9CgogICAgcmV0dXJuICRwYXJhbXM7CiAgfQoKICAvLyBoZWxwZXIgdG8gdHJ5IHRvIHNv
cnQgb3V0IGhlYWRlcnMgZm9yIHBlb3BsZSB3aG8gYXJlbid0IHJ1bm5pbmcgYXBhY2hlCiAg
cHVibGljIHN0YXRpYyBmdW5jdGlvbiBnZXRfaGVhZGVycygpIHsKICAgIGlmIChmdW5jdGlv
bl9leGlzdHMoJ2FwYWNoZV9yZXF1ZXN0X2hlYWRlcnMnKSkgewogICAgICAvLyB3ZSBuZWVk
IHRoaXMgdG8gZ2V0IHRoZSBhY3R1YWwgQXV0aG9yaXphdGlvbjogaGVhZGVyCiAgICAgIC8v
IGJlY2F1c2UgYXBhY2hlIHRlbmRzIHRvIHRlbGwgdXMgaXQgZG9lc24ndCBleGlzdAogICAg
ICAkaGVhZGVycyA9IGFwYWNoZV9yZXF1ZXN0X2hlYWRlcnMoKTsKCiAgICAgIC8vIHNhbml0
aXplIHRoZSBvdXRwdXQgb2YgYXBhY2hlX3JlcXVlc3RfaGVhZGVycyBiZWNhdXNlCiAgICAg
IC8vIHdlIGFsd2F5cyB3YW50IHRoZSBrZXlzIHRvIGJlIENhc2VkLUxpa2UtVGhpcyBhbmQg
YXJoKCkKICAgICAgLy8gcmV0dXJucyB0aGUgaGVhZGVycyBpbiB0aGUgc2FtZSBjYXNlIGFz
IHRoZXkgYXJlIGluIHRoZQogICAgICAvLyByZXF1ZXN0CiAgICAgICRvdXQgPSBhcnJheSgp
OwogICAgICBmb3JlYWNoKCAkaGVhZGVycyBBUyAka2V5ID0+ICR2YWx1ZSApIHsKICAgICAg
ICAka2V5ID0gc3RyX3JlcGxhY2UoCiAgICAgICAgICAgICIgIiwKICAgICAgICAgICAgIi0i
LAogICAgICAgICAgICB1Y3dvcmRzKHN0cnRvbG93ZXIoc3RyX3JlcGxhY2UoIi0iLCAiICIs
ICRrZXkpKSkKICAgICAgICAgICk7CiAgICAgICAgJG91dFska2V5XSA9ICR2YWx1ZTsKICAg
ICAgfQogICAgfSBlbHNlIHsKICAgICAgLy8gb3RoZXJ3aXNlIHdlIGRvbid0IGhhdmUgYXBh
Y2hlIGFuZCBhcmUganVzdCBnb2luZyB0byBoYXZlIHRvIGhvcGUKICAgICAgLy8gdGhhdCAk
X1NFUlZFUiBhY3R1YWxseSBjb250YWlucyB3aGF0IHdlIG5lZWQKICAgICAgJG91dCA9IGFy
cmF5KCk7CiAgICAgIGlmKCBpc3NldCgkX1NFUlZFUlsnQ09OVEVOVF9UWVBFJ10pICkKICAg
ICAgICAkb3V0WydDb250ZW50LVR5cGUnXSA9ICRfU0VSVkVSWydDT05URU5UX1RZUEUnXTsK
ICAgICAgaWYoIGlzc2V0KCRfRU5WWydDT05URU5UX1RZUEUnXSkgKQogICAgICAgICRvdXRb
J0NvbnRlbnQtVHlwZSddID0gJF9FTlZbJ0NPTlRFTlRfVFlQRSddOwoKICAgICAgZm9yZWFj
aCAoJF9TRVJWRVIgYXMgJGtleSA9PiAkdmFsdWUpIHsKICAgICAgICBpZiAoc3Vic3RyKCRr
ZXksIDAsIDUpID09ICJIVFRQXyIpIHsKICAgICAgICAgIC8vIHRoaXMgaXMgY2hhb3MsIGJh
c2ljYWxseSBpdCBpcyBqdXN0IHRoZXJlIHRvIGNhcGl0YWxpemUgdGhlIGZpcnN0CiAgICAg
ICAgICAvLyBsZXR0ZXIgb2YgZXZlcnkgd29yZCB0aGF0IGlzIG5vdCBhbiBpbml0aWFsIEhU
VFAgYW5kIHN0cmlwIEhUVFAKICAgICAgICAgIC8vIGNvZGUgZnJvbSBwcnplbWVrCiAgICAg
ICAgICAka2V5ID0gc3RyX3JlcGxhY2UoCiAgICAgICAgICAgICIgIiwKICAgICAgICAgICAg
Ii0iLAogICAgICAgICAgICB1Y3dvcmRzKHN0cnRvbG93ZXIoc3RyX3JlcGxhY2UoIl8iLCAi
ICIsIHN1YnN0cigka2V5LCA1KSkpKQogICAgICAgICAgKTsKICAgICAgICAgICRvdXRbJGtl
eV0gPSAkdmFsdWU7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICByZXR1cm4gJG91dDsK
ICB9CgogIC8vIFRoaXMgZnVuY3Rpb24gdGFrZXMgYSBpbnB1dCBsaWtlIGE9YiZhPWMmZD1l
IGFuZCByZXR1cm5zIHRoZSBwYXJzZWQKICAvLyBwYXJhbWV0ZXJzIGxpa2UgdGhpcwogIC8v
IGFycmF5KCdhJyA9PiBhcnJheSgnYicsJ2MnKSwgJ2QnID0+ICdlJykKICBwdWJsaWMgc3Rh
dGljIGZ1bmN0aW9uIHBhcnNlX3BhcmFtZXRlcnMoICRpbnB1dCApIHsKICAgIGlmICghaXNz
ZXQoJGlucHV0KSB8fCAhJGlucHV0KSByZXR1cm4gYXJyYXkoKTsKCiAgICAkcGFpcnMgPSBl
eHBsb2RlKCcmJywgJGlucHV0KTsKCiAgICAkcGFyc2VkX3BhcmFtZXRlcnMgPSBhcnJheSgp
OwogICAgZm9yZWFjaCAoJHBhaXJzIGFzICRwYWlyKSB7CiAgICAgICRzcGxpdCA9IGV4cGxv
ZGUoJz0nLCAkcGFpciwgMik7CiAgICAgICRwYXJhbWV0ZXIgPSBPQXV0aFV0aWw6OnVybGRl
Y29kZV9yZmMzOTg2KCRzcGxpdFswXSk7CiAgICAgICR2YWx1ZSA9IGlzc2V0KCRzcGxpdFsx
XSkgPyBPQXV0aFV0aWw6OnVybGRlY29kZV9yZmMzOTg2KCRzcGxpdFsxXSkgOiAnJzsKCiAg
ICAgIGlmIChpc3NldCgkcGFyc2VkX3BhcmFtZXRlcnNbJHBhcmFtZXRlcl0pKSB7CiAgICAg
ICAgLy8gV2UgaGF2ZSBhbHJlYWR5IHJlY2lldmVkIHBhcmFtZXRlcihzKSB3aXRoIHRoaXMg
bmFtZSwgc28gYWRkIHRvIHRoZSBsaXN0CiAgICAgICAgLy8gb2YgcGFyYW1ldGVycyB3aXRo
IHRoaXMgbmFtZQoKICAgICAgICBpZiAoaXNfc2NhbGFyKCRwYXJzZWRfcGFyYW1ldGVyc1sk
cGFyYW1ldGVyXSkpIHsKICAgICAgICAgIC8vIFRoaXMgaXMgdGhlIGZpcnN0IGR1cGxpY2F0
ZSwgc28gdHJhbnNmb3JtIHNjYWxhciAoc3RyaW5nKSBpbnRvIGFuIGFycmF5CiAgICAgICAg
ICAvLyBzbyB3ZSBjYW4gYWRkIHRoZSBkdXBsaWNhdGVzCiAgICAgICAgICAkcGFyc2VkX3Bh
cmFtZXRlcnNbJHBhcmFtZXRlcl0gPSBhcnJheSgkcGFyc2VkX3BhcmFtZXRlcnNbJHBhcmFt
ZXRlcl0pOwogICAgICAgIH0KCiAgICAgICAgJHBhcnNlZF9wYXJhbWV0ZXJzWyRwYXJhbWV0
ZXJdW10gPSAkdmFsdWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgJHBhcnNlZF9wYXJhbWV0
ZXJzWyRwYXJhbWV0ZXJdID0gJHZhbHVlOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gJHBh
cnNlZF9wYXJhbWV0ZXJzOwogIH0KCiAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiBidWlsZF9o
dHRwX3F1ZXJ5KCRwYXJhbXMpIHsKICAgIGlmICghJHBhcmFtcykgcmV0dXJuICcnOwoKICAg
IC8vIFVybGVuY29kZSBib3RoIGtleXMgYW5kIHZhbHVlcwogICAgJGtleXMgPSBPQXV0aFV0
aWw6OnVybGVuY29kZV9yZmMzOTg2KGFycmF5X2tleXMoJHBhcmFtcykpOwogICAgJHZhbHVl
cyA9IE9BdXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5ODYoYXJyYXlfdmFsdWVzKCRwYXJhbXMp
KTsKICAgICRwYXJhbXMgPSBhcnJheV9jb21iaW5lKCRrZXlzLCAkdmFsdWVzKTsKCiAgICAv
LyBQYXJhbWV0ZXJzIGFyZSBzb3J0ZWQgYnkgbmFtZSwgdXNpbmcgbGV4aWNvZ3JhcGhpY2Fs
IGJ5dGUgdmFsdWUgb3JkZXJpbmcuCiAgICAvLyBSZWY6IFNwZWM6IDkuMS4xICgxKQogICAg
dWtzb3J0KCRwYXJhbXMsICdzdHJjbXAnKTsKCiAgICAkcGFpcnMgPSBhcnJheSgpOwogICAg
Zm9yZWFjaCAoJHBhcmFtcyBhcyAkcGFyYW1ldGVyID0+ICR2YWx1ZSkgewogICAgICBpZiAo
aXNfYXJyYXkoJHZhbHVlKSkgewogICAgICAgIC8vIElmIHR3byBvciBtb3JlIHBhcmFtZXRl
cnMgc2hhcmUgdGhlIHNhbWUgbmFtZSwgdGhleSBhcmUgc29ydGVkIGJ5IHRoZWlyIHZhbHVl
CiAgICAgICAgLy8gUmVmOiBTcGVjOiA5LjEuMSAoMSkKICAgICAgICBuYXRzb3J0KCR2YWx1
ZSk7CiAgICAgICAgZm9yZWFjaCAoJHZhbHVlIGFzICRkdXBsaWNhdGVfdmFsdWUpIHsKICAg
ICAgICAgICRwYWlyc1tdID0gJHBhcmFtZXRlciAuICc9JyAuICRkdXBsaWNhdGVfdmFsdWU7
CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgICRwYWlyc1tdID0gJHBhcmFtZXRl
ciAuICc9JyAuICR2YWx1ZTsKICAgICAgfQogICAgfQogICAgLy8gRm9yIGVhY2ggcGFyYW1l
dGVyLCB0aGUgbmFtZSBpcyBzZXBhcmF0ZWQgZnJvbSB0aGUgY29ycmVzcG9uZGluZyB2YWx1
ZSBieSBhbiAnPScgY2hhcmFjdGVyIChBU0NJSSBjb2RlIDYxKQogICAgLy8gRWFjaCBuYW1l
LXZhbHVlIHBhaXIgaXMgc2VwYXJhdGVkIGJ5IGFuICcmJyBjaGFyYWN0ZXIgKEFTQ0lJIGNv
ZGUgMzgpCiAgICByZXR1cm4gaW1wbG9kZSgnJicsICRwYWlycyk7CiAgfQp9IjtzOjM6Im1k
NSI7czozMjoiOWZkYmEzODU3ZTA3YzFjYmUwMmJhMTdjOTA0Y2ViMmMiO30=
